/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct TY54547 TY54547;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY54525 TY54525;
typedef struct TY104006 TY104006;
typedef struct TY104002 TY104002;
typedef struct TY92031 TY92031;
typedef struct TY74013 TY74013;
typedef struct TY91028 TY91028;
typedef struct TY80011 TY80011;
typedef struct TY76267 TY76267;
typedef struct TY76263 TY76263;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY54551 TY54551;
typedef struct TY46536 TY46536;
typedef struct TY53011 TY53011;
typedef struct TY54519 TY54519;
typedef struct TY53005 TY53005;
typedef struct TY54529 TY54529;
typedef struct TY54527 TY54527;
typedef struct TY54539 TY54539;
typedef struct TY51008 TY51008;
typedef struct TY54543 TY54543;
typedef struct TY54549 TY54549;
typedef struct TY38221 TY38221;
typedef struct TY92029 TY92029;
typedef struct TY59220 TY59220;
typedef struct TY59218 TY59218;
typedef struct TY59216 TY59216;
typedef struct TY54563 TY54563;
typedef struct TY54561 TY54561;
typedef struct TY54559 TY54559;
typedef struct TY75015 TY75015;
typedef struct TY76281 TY76281;
typedef struct TY42013 TY42013;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
typedef N_NIMCALL_PTR(TY54547*, TY104044) (NimStringDesc* Filename_104045);
typedef N_NIMCALL_PTR(TY54525*, TY104048) (NimStringDesc* Filename_104049);
typedef N_NIMCALL_PTR(TY104002*, TY104007) (TY54547* Module_104008, NimStringDesc* Filename_104009);
typedef N_NIMCALL_PTR(TY104002*, TY104012) (TY54547* Module_104013, NimStringDesc* Filename_104014, TY92031* Rd_104015);
typedef N_NIMCALL_PTR(TY54525*, TY104018) (TY104002* P_104019, TY54525* N_104020);
typedef N_NIMCALL_PTR(TY54525*, TY104023) (TY104002* P_104024, TY54525* Toplevelstmt_104025);
struct TY104006 {
TY104007 Open;
TY104012 Opencached;
TY104018 Close;
TY104023 Process;
};
typedef TY104006 TY104128[10];
struct TY80011 {
TY76267* Lex;
TY76263* Tok;
};
struct TY91028 {
NU8 Skin;
TY80011 Parser;
};
typedef TY104002* TY104126[10];
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY74013 {
  TNimObject Sup;
NU8 Kind;
FILE* F;
NimStringDesc* S;
NI Rd;
NI Wr;
};
struct TY46536 {
NI16 Line;
NI16 Col;
int Fileindex;
};
struct TY54525 {
TY54551* Typ;
NimStringDesc* Comment;
TY46536 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {TY54547* Sym;
} S4;
struct {TY53011* Ident;
} S5;
struct {TY54519* Sons;
} S6;
} KindU;
};
struct TY53005 {
  TNimObject Sup;
NI Id;
};
struct TY54529 {
TNimType* m_type;
NI Counter;
TY54527* Data;
};
struct TY54539 {
NU8 K;
NU8 S;
NU8 Flags;
TY54551* T;
TY51008* R;
NI A;
};
struct TY54547 {
  TY53005 Sup;
NU8 Kind;
NU8 Magic;
TY54551* Typ;
TY53011* Name;
TY46536 Info;
TY54547* Owner;
NU32 Flags;
TY54529 Tab;
TY54525* Ast;
NU32 Options;
NI Position;
NI Offset;
TY54539 Loc;
TY54543* Annex;
};
struct TY54551 {
  TY53005 Sup;
NU8 Kind;
TY54549* Sons;
TY54525* N;
NU8 Flags;
NU8 Callconv;
TY54547* Owner;
TY54547* Sym;
NI64 Size;
NI Align;
NI Containerid;
TY54539 Loc;
};
struct TY104002 {
  TNimObject Sup;
};
struct TY59216 {
NI Key;
NI Val;
};
struct TY59220 {
NI Counter;
TY59218* Data;
};
struct TY92029 {
NI Lastidxkey;
NI Lastidxval;
TY59220 Tab;
TY51008* R;
NI Offset;
};
struct TY54559 {
TY53005* Key;
TNimObject* Val;
};
struct TY54563 {
NI Counter;
TY54561* Data;
};
struct TY92031 {
  TNimObject Sup;
NI Pos;
NimStringDesc* S;
NU32 Options;
NU8 Reason;
TY38221* Moddeps;
TY38221* Files;
NI Dataidx;
NI Convertersidx;
NI Initidx;
NI Interfidx;
NI Compilerprocsidx;
NI Cgenidx;
NimStringDesc* Filename;
TY92029 Index;
TY92029 Imports;
NI Readerindex;
NI Line;
NI Moduleid;
TY54563 Syms;
};
struct TY75015 {
  TNimObject Sup;
NI Bufpos;
NCSTRING Buf;
NI Buflen;
TY74013* Stream;
NI Linenumber;
NI Sentinel;
NI Linestart;
};
struct TY76267 {
  TY75015 Sup;
NimStringDesc* Filename;
TY76281* Indentstack;
NI Dedent;
NI Indentahead;
};
struct TY76263 {
TNimType* m_type;
NU8 Toktype;
NI Indent;
TY53011* Ident;
NI64 Inumber;
NF64 Fnumber;
NU8 Base;
NimStringDesc* Literal;
TY76263* Next;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY53011 {
  TY53005 Sup;
NimStringDesc* S;
TY53011* Next;
NI H;
};
struct TY51008 {
  TNimObject Sup;
TY51008* Left;
TY51008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY42013 {
  TNimObject Sup;
TY42013* Prev;
TY42013* Next;
};
struct TY54543 {
  TY42013 Sup;
NU8 Kind;
NIM_BOOL Generated;
TY51008* Name;
TY54525* Path;
};
struct TY54519 {
  TGenericSeq Sup;
  TY54525* data[SEQ_DECL_SIZE];
};
struct TY54527 {
  TGenericSeq Sup;
  TY54547* data[SEQ_DECL_SIZE];
};
struct TY54549 {
  TGenericSeq Sup;
  TY54551* data[SEQ_DECL_SIZE];
};
struct TY38221 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
struct TY59218 {
  TGenericSeq Sup;
  TY59216 data[SEQ_DECL_SIZE];
};
struct TY54561 {
  TGenericSeq Sup;
  TY54559 data[SEQ_DECL_SIZE];
};
struct TY76281 {
  TGenericSeq Sup;
  NI data[SEQ_DECL_SIZE];
};
N_NIMCALL(void, Openpasses_104147)(TY104002** A_104150, TY54547* Module_104151, NimStringDesc* Filename_104152);
N_NIMCALL(TY74013*, Llstreamopen_74032)(NimStringDesc* Filename_74034, NU8 Mode_74035);
N_NIMCALL(void, Rawmessage_46557)(NU8 Msg_46559, NimStringDesc* Arg_46560);
N_NIMCALL(void, Openparsers_91034)(TY91028* P_91037, NimStringDesc* Filename_91038, TY74013* Inputstream_91039);
N_NIMCALL(TY54525*, Parsetoplevelstmt_91048)(TY91028* P_91051);
N_NIMCALL(void, Processtoplevelstmt_104213)(TY54525* N_104215, TY104002** A_104217);
N_NIMCALL(void, Closeparsers_91040)(TY91028* P_91043);
N_NIMCALL(void, Closepasses_104197)(TY104002** A_104200);
N_NIMCALL(void, Idsynchronizationpoint_54698)(NI Idrange_54700);
N_NIMCALL(void, Openpassescached_104179)(TY104002** A_104182, TY54547* Module_104183, NimStringDesc* Filename_104184, TY92031* Rd_104185);
N_NIMCALL(TY54525*, Loadinitsection_92067)(TY92031* R_92069);
static N_INLINE(NI, Sonslen_54803)(TY54525* N_54805);
N_NIMCALL(void, Processtoplevelstmtcached_104230)(TY54525* N_104232, TY104002** A_104234);
N_NIMCALL(void, Closepassescached_104247)(TY104002** A_104250);
TY104044 Gimportmodule_104047;
TY104048 Gincludefile_104051;
TY104128 Gpasses_104130;
NI Gpasseslen_104131;
N_NIMCALL(void, Openpasses_104147)(TY104002** A_104150, TY54547* Module_104151, NimStringDesc* Filename_104152) {
NI I_104175;
NI HEX3Atmp_104176;
NI Res_104178;
I_104175 = 0;
HEX3Atmp_104176 = 0;
HEX3Atmp_104176 = (NI64)(Gpasseslen_104131 - 1);
Res_104178 = 0;
Res_104178 = 0;
while (1) {
if (!(Res_104178 <= HEX3Atmp_104176)) goto LA1;
I_104175 = Res_104178;
if (!!(((void*) (Gpasses_104130[(I_104175)-0].Open)) == 0)) goto LA3;
A_104150[(I_104175)-0] = Gpasses_104130[(I_104175)-0].Open(Module_104151, Filename_104152);
goto LA2;
LA3: ;
A_104150[(I_104175)-0] = NIM_NIL;
LA2: ;
Res_104178 += 1;
} LA1: ;
}
N_NIMCALL(void, Processtoplevelstmt_104213)(TY54525* N_104215, TY104002** A_104217) {
TY54525* M_104218;
NI I_104226;
NI HEX3Atmp_104227;
NI Res_104229;
M_104218 = 0;
M_104218 = N_104215;
I_104226 = 0;
HEX3Atmp_104227 = 0;
HEX3Atmp_104227 = (NI64)(Gpasseslen_104131 - 1);
Res_104229 = 0;
Res_104229 = 0;
while (1) {
if (!(Res_104229 <= HEX3Atmp_104227)) goto LA1;
I_104226 = Res_104229;
if (!!(((void*) (Gpasses_104130[(I_104226)-0].Process)) == 0)) goto LA3;
M_104218 = Gpasses_104130[(I_104226)-0].Process(A_104217[(I_104226)-0], M_104218);
LA3: ;
Res_104229 += 1;
} LA1: ;
}
N_NIMCALL(void, Closepasses_104197)(TY104002** A_104200) {
TY54525* M_104201;
NI I_104209;
NI HEX3Atmp_104210;
NI Res_104212;
M_104201 = 0;
M_104201 = NIM_NIL;
I_104209 = 0;
HEX3Atmp_104210 = 0;
HEX3Atmp_104210 = (NI64)(Gpasseslen_104131 - 1);
Res_104212 = 0;
Res_104212 = 0;
while (1) {
if (!(Res_104212 <= HEX3Atmp_104210)) goto LA1;
I_104209 = Res_104212;
if (!!(((void*) (Gpasses_104130[(I_104209)-0].Close)) == 0)) goto LA3;
M_104201 = Gpasses_104130[(I_104209)-0].Close(A_104200[(I_104209)-0], M_104201);
LA3: ;
A_104200[(I_104209)-0] = NIM_NIL;
Res_104212 += 1;
} LA1: ;
}
N_NIMCALL(void, Openpassescached_104179)(TY104002** A_104182, TY54547* Module_104183, NimStringDesc* Filename_104184, TY92031* Rd_104185) {
NI I_104193;
NI HEX3Atmp_104194;
NI Res_104196;
I_104193 = 0;
HEX3Atmp_104194 = 0;
HEX3Atmp_104194 = (NI64)(Gpasseslen_104131 - 1);
Res_104196 = 0;
Res_104196 = 0;
while (1) {
if (!(Res_104196 <= HEX3Atmp_104194)) goto LA1;
I_104193 = Res_104196;
if (!!(((void*) (Gpasses_104130[(I_104193)-0].Opencached)) == 0)) goto LA3;
A_104182[(I_104193)-0] = Gpasses_104130[(I_104193)-0].Opencached(Module_104183, Filename_104184, Rd_104185);
goto LA2;
LA3: ;
A_104182[(I_104193)-0] = NIM_NIL;
LA2: ;
Res_104196 += 1;
} LA1: ;
}
static N_INLINE(NI, Sonslen_54803)(TY54525* N_54805) {
NI Result_55880;
Result_55880 = 0;
if (!(*N_54805).KindU.S6.Sons == 0) goto LA2;
Result_55880 = 0;
goto LA1;
LA2: ;
Result_55880 = (*N_54805).KindU.S6.Sons->Sup.len;
LA1: ;
return Result_55880;
}
N_NIMCALL(void, Processtoplevelstmtcached_104230)(TY54525* N_104232, TY104002** A_104234) {
TY54525* M_104235;
NI I_104243;
NI HEX3Atmp_104244;
NI Res_104246;
M_104235 = 0;
M_104235 = N_104232;
I_104243 = 0;
HEX3Atmp_104244 = 0;
HEX3Atmp_104244 = (NI64)(Gpasseslen_104131 - 1);
Res_104246 = 0;
Res_104246 = 0;
while (1) {
if (!(Res_104246 <= HEX3Atmp_104244)) goto LA1;
I_104243 = Res_104246;
if (!!(((void*) (Gpasses_104130[(I_104243)-0].Opencached)) == 0)) goto LA3;
M_104235 = Gpasses_104130[(I_104243)-0].Process(A_104234[(I_104243)-0], M_104235);
LA3: ;
Res_104246 += 1;
} LA1: ;
}
N_NIMCALL(void, Closepassescached_104247)(TY104002** A_104250) {
TY54525* M_104251;
NI I_104259;
NI HEX3Atmp_104260;
NI Res_104262;
NIM_BOOL LOC3;
M_104251 = 0;
M_104251 = NIM_NIL;
I_104259 = 0;
HEX3Atmp_104260 = 0;
HEX3Atmp_104260 = (NI64)(Gpasseslen_104131 - 1);
Res_104262 = 0;
Res_104262 = 0;
while (1) {
if (!(Res_104262 <= HEX3Atmp_104260)) goto LA1;
I_104259 = Res_104262;
LOC3 = !(((void*) (Gpasses_104130[(I_104259)-0].Opencached)) == 0);
if (!(LOC3)) goto LA4;
LOC3 = !(((void*) (Gpasses_104130[(I_104259)-0].Close)) == 0);
LA4: ;
if (!LOC3) goto LA5;
M_104251 = Gpasses_104130[(I_104259)-0].Close(A_104250[(I_104259)-0], M_104251);
LA5: ;
A_104250[(I_104259)-0] = NIM_NIL;
Res_104262 += 1;
} LA1: ;
}
N_NIMCALL(void, Processmodule_104035)(TY54547* Module_104037, NimStringDesc* Filename_104038, TY74013* Stream_104039, TY92031* Rd_104040) {
TY91028 P_104269;
TY54525* N_104270;
TY104126 A_104271;
TY74013* S_104272;
NI I_104340;
NI HEX3Atmp_104355;
NI LOC18;
NI Res_104357;
memset((void*)&P_104269, 0, sizeof(P_104269));
N_104270 = 0;
memset((void*)&A_104271, 0, sizeof(A_104271));
S_104272 = 0;
if (!(Rd_104040 == NIM_NIL)) goto LA2;
Openpasses_104147(A_104271, Module_104037, Filename_104038);
if (!(Stream_104039 == NIM_NIL)) goto LA5;
S_104272 = Llstreamopen_74032(Filename_104038, ((NU8) 0));
if (!(S_104272 == NIM_NIL)) goto LA8;
Rawmessage_46557(((NU8) 2), Filename_104038);
goto BeforeRet;
LA8: ;
goto LA4;
LA5: ;
S_104272 = Stream_104039;
LA4: ;
while (1) {
Openparsers_91034(&P_104269, Filename_104038, S_104272);
while (1) {
N_104270 = Parsetoplevelstmt_91048(&P_104269);
if (!(N_104270 == NIM_NIL)) goto LA13;
goto LA11;
LA13: ;
Processtoplevelstmt_104213(N_104270, A_104271);
} LA11: ;
Closeparsers_91040(&P_104269);
if (!!(((*S_104272).Kind == ((NU8) 3)))) goto LA16;
goto LA10;
LA16: ;
} LA10: ;
Closepasses_104197(A_104271);
Idsynchronizationpoint_54698(1000);
goto LA1;
LA2: ;
Openpassescached_104179(A_104271, Module_104037, Filename_104038, Rd_104040);
N_104270 = Loadinitsection_92067(Rd_104040);
I_104340 = 0;
HEX3Atmp_104355 = 0;
LOC18 = Sonslen_54803(N_104270);
HEX3Atmp_104355 = (NI64)(LOC18 - 1);
Res_104357 = 0;
Res_104357 = 0;
while (1) {
if (!(Res_104357 <= HEX3Atmp_104355)) goto LA19;
I_104340 = Res_104357;
Processtoplevelstmtcached_104230((*N_104270).KindU.S6.Sons->data[I_104340], A_104271);
Res_104357 += 1;
} LA19: ;
Closepassescached_104247(A_104271);
LA1: ;
BeforeRet: ;
}
N_NIMCALL(void, Registerpass_104028)(TY104006* P_104030) {
Gpasses_104130[(Gpasseslen_104131)-0] = (*P_104030);
Gpasseslen_104131 += 1;
}
N_NIMCALL(void, Initpass_104031)(TY104006* P_104034) {
(*P_104034).Open = NIM_NIL;
(*P_104034).Opencached = NIM_NIL;
(*P_104034).Close = NIM_NIL;
(*P_104034).Process = NIM_NIL;
}
N_NIMCALL(NIM_BOOL, Astneeded_104041)(TY54547* S_104043) {
NIM_BOOL Result_104055;
NIM_BOOL LOC2;
NIM_BOOL LOC3;
NIM_BOOL LOC4;
Result_104055 = 0;
LOC4 = ((3072 &(1<<(((*S_104043).Kind)&31)))!=0);
if (!(LOC4)) goto LA5;
LOC4 = ((34078720 & (*S_104043).Flags) == 0);
LA5: ;
LOC3 = LOC4;
if (!(LOC3)) goto LA6;
LOC3 = !(((*(*S_104043).Typ).Callconv == ((NU8) 5)));
LA6: ;
LOC2 = LOC3;
if (!(LOC2)) goto LA7;
LOC2 = ((*(*S_104043).Ast).KindU.S6.Sons->data[1] == NIM_NIL);
LA7: ;
if (!LOC2) goto LA8;
Result_104055 = NIM_FALSE;
goto LA1;
LA8: ;
Result_104055 = NIM_TRUE;
LA1: ;
return Result_104055;
}
N_NOINLINE(void, passesInit)(void) {
}

