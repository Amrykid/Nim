/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long int NI;
typedef unsigned long int NU;
#include "nimbase.h"

typedef struct TY48008 TY48008;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TNimObject TNimObject;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY10602 TY10602;
typedef struct TY10618 TY10618;
typedef struct TY10996 TY10996;
typedef struct TY10614 TY10614;
typedef struct TY10610 TY10610;
typedef struct TY10994 TY10994;
typedef struct TY48406 TY48406;
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TNimObject {
TNimType* m_type;
};
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY245[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY245 data;
};
struct TY48008 {
  TNimObject Sup;
TY48008* Left;
TY48008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY10602 {
NI Refcount;
TNimType* Typ;
};
struct TY10618 {
NI Len;
NI Cap;
TY10602** D;
};
struct TY10614 {
NI Counter;
NI Max;
TY10610* Head;
TY10610** Data;
};
struct TY10994 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10996 {
TY10618 Zct;
TY10618 Decstack;
TY10614 Cycleroots;
TY10618 Tempstack;
TY10994 Stat;
};
typedef TY48008* TY48407[1];
typedef NI TY46040[256];
typedef NI TY8614[16];
struct TY10610 {
TY10610* Next;
NI Key;
TY8614 Bits;
};
struct TY48406 {
  TGenericSeq Sup;
  TY48008* data[SEQ_DECL_SIZE];
};
N_NIMCALL(void*, newObj)(TNimType* Typ_13710, NI Size_13711);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13018, void* Src_13019);
static N_INLINE(TY10602*, Usrtocell_11412)(void* Usr_11414);
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225);
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230);
static N_INLINE(void, Rtladdzct_12401)(TY10602* C_12403);
N_NOINLINE(void, Addzct_11401)(TY10618* S_11404, TY10602* C_11405);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_18512);
N_NIMCALL(NimStringDesc*, mnewString)(NI Len_1353);
N_NIMCALL(void, Newrecropetostr_48388)(NimStringDesc** Result_48391, NI* Resultlen_48393, TY48008* R_48394);
N_NIMCALL(void*, newSeq)(TNimType* Typ_14204, NI Len_14205);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* Seq_18642, NI Elemsize_18643);
N_NIMCALL(TY48008*, Insertincache_48201)(NimStringDesc* S_48203, TY48008* Tree_48204);
N_NIMCALL(TY48008*, Newrope_48102)(NimStringDesc* Data_48104);
N_NIMCALL(TY48008*, Splay_48136)(NimStringDesc* S_48138, TY48008* Tree_48139, NI* Cmpres_48141);
N_NIMCALL(NI, Cmp_1325)(NimStringDesc* X_1327, NimStringDesc* Y_1328);
static N_INLINE(NI, cmpStrings)(NimStringDesc* A_18413, NimStringDesc* B_18414);
N_NIMCALL(void, App_48036)(TY48008** A_48039, NimStringDesc* B_48040);
N_NIMCALL(TY48008*, Con_48019)(TY48008* A_48021, NimStringDesc* B_48022);
N_NIMCALL(TY48008*, Con_48015)(TY48008* A_48017, TY48008* B_48018);
N_NIMCALL(TY48008*, Torope_48046)(NimStringDesc* S_48048);
N_NIMCALL(void, unsureAsgnRef)(void** Dest_13026, void* Src_13027);
N_NIMCALL(void, App_48031)(TY48008** A_48034, TY48008* B_48035);
N_NIMCALL(void, Internalerror_44212)(NimStringDesc* Errmsg_44214);
static N_INLINE(void, appendString)(NimStringDesc* Dest_18599, NimStringDesc* Src_18600);
N_NIMCALL(NimStringDesc*, nimIntToStr)(NI X_19203);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_18489);
static N_INLINE(void, appendChar)(NimStringDesc* Dest_18616, NIM_CHAR C_18617);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* S_2328, NI First_2329, NI Last_2330);
N_NIMCALL(NimStringDesc*, nimInt64ToStr)(NI64 X_19270);
N_NIMCALL(TY48008*, Ropef_48066)(NimStringDesc* Frmt_48068, TY48008** Args_48070, NI Args_48070Len0);
N_NIMCALL(NI32, Crcfromfile_46029)(NimStringDesc* Filename_46031);
N_NIMCALL(NI32, Crcfromrope_48981)(TY48008* R_48983);
N_NIMCALL(NI32, Newcrcfromropeaux_48896)(TY48008* R_48898, NI32 Startval_48899);
static N_INLINE(NI32, Updatecrc32_46018)(NIM_CHAR Val_46020, NI32 Crc_46021);
static N_INLINE(NI32, Updatecrc32_46014)(NI8 Val_46016, NI32 Crc_46017);
N_NIMCALL(void, Writerope_48055)(TY48008* Head_48057, NimStringDesc* Filename_48058);
N_NIMCALL(NIM_BOOL, Open_3817)(FILE** F_3820, NimStringDesc* Filename_3821, NU8 Mode_3822, NI Bufsize_3823);
N_NIMCALL(void, Writerope_48605)(FILE** F_48608, TY48008* C_48609);
N_NIMCALL(void, Write_3866)(FILE* F_3868, NimStringDesc* S_3869);
N_NIMCALL(void, Rawmessage_44094)(NU8 Msg_44096, NimStringDesc* Arg_44097);
static N_INLINE(TY48008*, Pop_48429)(TY48406** S_48434);
N_NIMCALL(TGenericSeq*, setLengthSeq)(TGenericSeq* Seq_18803, NI Elemsize_18804, NI Newlen_18805);
STRING_LITERAL(TMP193912, "", 0);
STRING_LITERAL(TMP194285, "$", 1);
STRING_LITERAL(TMP194286, "ropes: invalid format string $", 30);
extern NIM_CONST TY46040 Crc32table_46039;
TY48008* Cache_48123;
NI Misses_48124;
NI Hits_48125;
TY48008* N_48126;
extern TNimType* NTI48006; /* PRope */
extern TY10996 Gch_11014;
extern TNimType* NTI48008; /* TRope */
extern TNimType* NTI48406; /* seq[PRope] */
extern NimStringDesc* Tnl_47581;
static N_INLINE(TY10602*, Usrtocell_11412)(void* Usr_11414) {
TY10602* Result_11415;
Result_11415 = 0;
Result_11415 = ((TY10602*) ((NI32)((NU32)(((NI) (Usr_11414))) - (NU32)(((NI) (((NI)sizeof(TY10602))))))));
return Result_11415;
}
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225) {
NI Result_7807;
Result_7807 = 0;
(*Memloc_3224) += X_3225;
Result_7807 = (*Memloc_3224);
return Result_7807;
}
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230) {
NI Result_8006;
Result_8006 = 0;
(*Memloc_3229) -= X_3230;
Result_8006 = (*Memloc_3229);
return Result_8006;
}
static N_INLINE(void, Rtladdzct_12401)(TY10602* C_12403) {
Addzct_11401(&Gch_11014.Zct, C_12403);
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13018, void* Src_13019) {
TY10602* C_13020;
NI LOC4;
TY10602* C_13022;
NI LOC9;
if (!!((Src_13019 == NIM_NIL))) goto LA2;
C_13020 = 0;
C_13020 = Usrtocell_11412(Src_13019);
LOC4 = Atomicinc_3221(&(*C_13020).Refcount, 8);
LA2: ;
if (!!(((*Dest_13018) == NIM_NIL))) goto LA6;
C_13022 = 0;
C_13022 = Usrtocell_11412((*Dest_13018));
LOC9 = Atomicdec_3226(&(*C_13022).Refcount, 8);
if (!((NU32)(LOC9) < (NU32)(8))) goto LA10;
Rtladdzct_12401(C_13022);
LA10: ;
LA6: ;
(*Dest_13018) = Src_13019;
}
N_NIMCALL(void, Newrecropetostr_48388)(NimStringDesc** Result_48391, NI* Resultlen_48393, TY48008* R_48394) {
TY48406* Stack_48409;
TY48407 LOC1;
TY48008* It_48460;
Stack_48409 = 0;
It_48460 = 0;
Stack_48409 = NIM_NIL;
Stack_48409 = (TY48406*) newSeq(NTI48406, 1);
memset((void*)&LOC1, 0, sizeof(LOC1));
LOC1[0] = R_48394;
asgnRefNoCycle((void**) &Stack_48409->data[0], LOC1[0]);
while (1) {
if (!(0 < Stack_48409->Sup.len)) goto LA2;
It_48460 = NIM_NIL;
It_48460 = Pop_48429(&Stack_48409);
while (1) {
if (!((*It_48460).Data == NIM_NIL)) goto LA3;
Stack_48409 = (TY48406*) incrSeq(&(Stack_48409)->Sup, sizeof(TY48008*));
asgnRefNoCycle((void**) &Stack_48409->data[Stack_48409->Sup.len-1], (*It_48460).Right);
It_48460 = (*It_48460).Left;
} LA3: ;
memcpy(((void*) (&(*Result_48391)->data[(*Resultlen_48393)])), ((void*) (&(*It_48460).Data->data[0])), (*It_48460).Length);
(*Resultlen_48393) += (*It_48460).Length;
} LA2: ;
}
N_NIMCALL(NimStringDesc*, Ropetostr_48063)(TY48008* P_48065) {
NimStringDesc* Result_48500;
NI Resultlen_48512;
Result_48500 = 0;
Result_48500 = NIM_NIL;
if (!(P_48065 == NIM_NIL)) goto LA2;
Result_48500 = copyString(((NimStringDesc*) &TMP193912));
goto LA1;
LA2: ;
Result_48500 = mnewString((*P_48065).Length);
Resultlen_48512 = 0;
Resultlen_48512 = 0;
Newrecropetostr_48388(&Result_48500, &Resultlen_48512, P_48065);
LA1: ;
return Result_48500;
}
N_NIMCALL(TY48008*, Newrope_48102)(NimStringDesc* Data_48104) {
TY48008* Result_48105;
Result_48105 = 0;
Result_48105 = NIM_NIL;
Result_48105 = (TY48008*) newObj(NTI48006, sizeof(TY48008));
(*Result_48105).Sup.m_type = NTI48008;
if (!!((Data_48104 == NIM_NIL))) goto LA2;
(*Result_48105).Length = Data_48104->Sup.len;
asgnRefNoCycle((void**) &(*Result_48105).Data, copyString(Data_48104));
LA2: ;
return Result_48105;
}
static N_INLINE(NI, cmpStrings)(NimStringDesc* A_18413, NimStringDesc* B_18414) {
NI Result_18415;
NI32 LOC10;
Result_18415 = 0;
if (!(A_18413 == B_18414)) goto LA2;
Result_18415 = 0;
goto BeforeRet;
LA2: ;
if (!(A_18413 == NIM_NIL)) goto LA5;
Result_18415 = -1;
goto BeforeRet;
LA5: ;
if (!(B_18414 == NIM_NIL)) goto LA8;
Result_18415 = 1;
goto BeforeRet;
LA8: ;
LOC10 = strcmp(((NCSTRING) ((*A_18413).data)), ((NCSTRING) ((*B_18414).data)));
Result_18415 = ((NI) (LOC10));
goto BeforeRet;
BeforeRet: ;
return Result_18415;
}
N_NIMCALL(TY48008*, Splay_48136)(NimStringDesc* S_48138, TY48008* Tree_48139, NI* Cmpres_48141) {
TY48008* Result_48142;
NI C_48143;
TY48008* T_48144;
TY48008* Le_48145;
TY48008* R_48146;
NIM_BOOL LOC6;
TY48008* Y_48162;
NIM_BOOL LOC16;
TY48008* Y_48189;
Result_48142 = 0;
T_48144 = 0;
Le_48145 = 0;
R_48146 = 0;
Y_48162 = 0;
Y_48189 = 0;
Result_48142 = NIM_NIL;
C_48143 = 0;
T_48144 = NIM_NIL;
T_48144 = Tree_48139;
asgnRefNoCycle((void**) &(*N_48126).Left, NIM_NIL);
asgnRefNoCycle((void**) &(*N_48126).Right, NIM_NIL);
Le_48145 = NIM_NIL;
Le_48145 = N_48126;
R_48146 = NIM_NIL;
R_48146 = N_48126;
while (1) {
C_48143 = Cmp_1325(S_48138, (*T_48144).Data);
if (!(C_48143 < 0)) goto LA3;
LOC6 = !(((*T_48144).Left == NIM_NIL));
if (!(LOC6)) goto LA7;
LOC6 = (cmpStrings(S_48138, (*(*T_48144).Left).Data) < 0);
LA7: ;
if (!LOC6) goto LA8;
Y_48162 = NIM_NIL;
Y_48162 = (*T_48144).Left;
asgnRefNoCycle((void**) &(*T_48144).Left, (*Y_48162).Right);
asgnRefNoCycle((void**) &(*Y_48162).Right, T_48144);
T_48144 = Y_48162;
LA8: ;
if (!((*T_48144).Left == NIM_NIL)) goto LA11;
goto LA1;
LA11: ;
asgnRefNoCycle((void**) &(*R_48146).Left, T_48144);
R_48146 = T_48144;
T_48144 = (*T_48144).Left;
goto LA2;
LA3: ;
if (!(0 < C_48143)) goto LA13;
LOC16 = !(((*T_48144).Right == NIM_NIL));
if (!(LOC16)) goto LA17;
LOC16 = (cmpStrings((*(*T_48144).Right).Data, S_48138) < 0);
LA17: ;
if (!LOC16) goto LA18;
Y_48189 = NIM_NIL;
Y_48189 = (*T_48144).Right;
asgnRefNoCycle((void**) &(*T_48144).Right, (*Y_48189).Left);
asgnRefNoCycle((void**) &(*Y_48189).Left, T_48144);
T_48144 = Y_48189;
LA18: ;
if (!((*T_48144).Right == NIM_NIL)) goto LA21;
goto LA1;
LA21: ;
asgnRefNoCycle((void**) &(*Le_48145).Right, T_48144);
Le_48145 = T_48144;
T_48144 = (*T_48144).Right;
goto LA2;
LA13: ;
goto LA1;
LA2: ;
} LA1: ;
(*Cmpres_48141) = C_48143;
asgnRefNoCycle((void**) &(*Le_48145).Right, (*T_48144).Left);
asgnRefNoCycle((void**) &(*R_48146).Left, (*T_48144).Right);
asgnRefNoCycle((void**) &(*T_48144).Left, (*N_48126).Right);
asgnRefNoCycle((void**) &(*T_48144).Right, (*N_48126).Left);
Result_48142 = T_48144;
return Result_48142;
}
N_NIMCALL(TY48008*, Insertincache_48201)(NimStringDesc* S_48203, TY48008* Tree_48204) {
TY48008* Result_48205;
TY48008* T_48206;
NI Cmp_48230;
Result_48205 = 0;
T_48206 = 0;
Result_48205 = NIM_NIL;
T_48206 = NIM_NIL;
T_48206 = Tree_48204;
if (!(T_48206 == NIM_NIL)) goto LA2;
Result_48205 = Newrope_48102(S_48203);
if (!NIM_FALSE) goto LA5;
Misses_48124 += 1;
LA5: ;
goto BeforeRet;
LA2: ;
Cmp_48230 = 0;
T_48206 = Splay_48136(S_48203, T_48206, &Cmp_48230);
if (!(Cmp_48230 == 0)) goto LA8;
Result_48205 = T_48206;
if (!NIM_FALSE) goto LA11;
Hits_48125 += 1;
LA11: ;
goto LA7;
LA8: ;
if (!NIM_FALSE) goto LA14;
Misses_48124 += 1;
LA14: ;
Result_48205 = Newrope_48102(S_48203);
if (!(Cmp_48230 < 0)) goto LA17;
asgnRefNoCycle((void**) &(*Result_48205).Left, (*T_48206).Left);
asgnRefNoCycle((void**) &(*Result_48205).Right, T_48206);
asgnRefNoCycle((void**) &(*T_48206).Left, NIM_NIL);
goto LA16;
LA17: ;
asgnRefNoCycle((void**) &(*Result_48205).Right, (*T_48206).Right);
asgnRefNoCycle((void**) &(*Result_48205).Left, T_48206);
asgnRefNoCycle((void**) &(*T_48206).Right, NIM_NIL);
LA16: ;
LA7: ;
BeforeRet: ;
return Result_48205;
}
N_NIMCALL(TY48008*, Torope_48046)(NimStringDesc* S_48048) {
TY48008* Result_48280;
Result_48280 = 0;
Result_48280 = NIM_NIL;
if (!((S_48048) && (S_48048)->Sup.len == 0)) goto LA2;
Result_48280 = NIM_NIL;
goto LA1;
LA2: ;
if (!NIM_TRUE) goto LA4;
Result_48280 = Insertincache_48201(S_48048, Cache_48123);
asgnRefNoCycle((void**) &Cache_48123, Result_48280);
goto LA1;
LA4: ;
Result_48280 = Newrope_48102(S_48048);
LA1: ;
return Result_48280;
}
N_NIMCALL(TY48008*, Con_48015)(TY48008* A_48017, TY48008* B_48018) {
TY48008* Result_48519;
Result_48519 = 0;
Result_48519 = NIM_NIL;
if (!(A_48017 == NIM_NIL)) goto LA2;
Result_48519 = B_48018;
goto LA1;
LA2: ;
if (!(B_48018 == NIM_NIL)) goto LA4;
Result_48519 = A_48017;
goto LA1;
LA4: ;
Result_48519 = Newrope_48102(NIM_NIL);
(*Result_48519).Length = (NI32)((*A_48017).Length + (*B_48018).Length);
asgnRefNoCycle((void**) &(*Result_48519).Left, A_48017);
asgnRefNoCycle((void**) &(*Result_48519).Right, B_48018);
LA1: ;
return Result_48519;
}
N_NIMCALL(TY48008*, Con_48019)(TY48008* A_48021, NimStringDesc* B_48022) {
TY48008* Result_48546;
TY48008* LOC1;
Result_48546 = 0;
Result_48546 = NIM_NIL;
LOC1 = 0;
LOC1 = Torope_48046(B_48022);
Result_48546 = Con_48015(A_48021, LOC1);
return Result_48546;
}
N_NIMCALL(void, App_48036)(TY48008** A_48039, NimStringDesc* B_48040) {
unsureAsgnRef((void**) &(*A_48039), Con_48019((*A_48039), B_48040));
}
N_NIMCALL(void, App_48031)(TY48008** A_48034, TY48008* B_48035) {
unsureAsgnRef((void**) &(*A_48034), Con_48015((*A_48034), B_48035));
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_18599, NimStringDesc* Src_18600) {
memcpy(((NCSTRING) (&(*Dest_18599).data[((*Dest_18599).Sup.len)-0])), ((NCSTRING) ((*Src_18600).data)), ((NI32) ((NI32)((NI32)((*Src_18600).Sup.len + 1) * 1))));
(*Dest_18599).Sup.len += (*Src_18600).Sup.len;
}
static N_INLINE(void, appendChar)(NimStringDesc* Dest_18616, NIM_CHAR C_18617) {
(*Dest_18616).data[((*Dest_18616).Sup.len)-0] = C_18617;
(*Dest_18616).data[((NI32)((*Dest_18616).Sup.len + 1))-0] = 0;
(*Dest_18616).Sup.len += 1;
}
N_NIMCALL(TY48008*, Ropef_48066)(NimStringDesc* Frmt_48068, TY48008** Args_48070, NI Args_48070Len0) {
TY48008* Result_48704;
NI I_48705;
NI Length_48708;
NI Num_48709;
NI J_48764;
NIM_BOOL LOC7;
NimStringDesc* LOC14;
NimStringDesc* LOC15;
NimStringDesc* LOC16;
NI Start_48823;
NimStringDesc* LOC24;
Result_48704 = 0;
Result_48704 = NIM_NIL;
I_48705 = 0;
I_48705 = 0;
Length_48708 = 0;
Length_48708 = Frmt_48068->Sup.len;
Result_48704 = NIM_NIL;
Num_48709 = 0;
Num_48709 = 0;
while (1) {
if (!(I_48705 <= (NI32)(Length_48708 - 1))) goto LA1;
if (!((NU8)(Frmt_48068->data[I_48705]) == (NU8)(36))) goto LA3;
I_48705 += 1;
switch (((NU8)(Frmt_48068->data[I_48705]))) {
case 36:
App_48036(&Result_48704, ((NimStringDesc*) &TMP194285));
I_48705 += 1;
break;
case 35:
I_48705 += 1;
App_48031(&Result_48704, Args_48070[Num_48709]);
Num_48709 += 1;
break;
case 48 ... 57:
J_48764 = 0;
J_48764 = 0;
while (1) {
J_48764 = (NI32)((NI32)((NI32)(J_48764 * 10) + ((NU8)(Frmt_48068->data[I_48705]))) - 48);
I_48705 += 1;
LOC7 = ((NI32)((NI32)(Length_48708 + 0) - 1) < I_48705);
if (LOC7) goto LA8;
LOC7 = !((((NU8)(Frmt_48068->data[I_48705])) >= ((NU8)(48)) && ((NU8)(Frmt_48068->data[I_48705])) <= ((NU8)(57))));
LA8: ;
if (!LOC7) goto LA9;
goto LA5;
LA9: ;
} LA5: ;
Num_48709 = J_48764;
if (!((NI32)((Args_48070Len0-1) + 1) < J_48764)) goto LA12;
LOC14 = 0;
LOC15 = 0;
LOC15 = nimIntToStr(J_48764);
LOC14 = rawNewString(LOC15->Sup.len + 30);
appendString(LOC14, ((NimStringDesc*) &TMP194286));
appendString(LOC14, LOC15);
Internalerror_44212(LOC14);
LA12: ;
App_48031(&Result_48704, Args_48070[(NI32)(J_48764 - 1)]);
break;
case 78:
case 110:
App_48036(&Result_48704, Tnl_47581);
I_48705 += 1;
break;
default:
LOC16 = 0;
LOC16 = rawNewString(31);
appendString(LOC16, ((NimStringDesc*) &TMP194286));
appendChar(LOC16, Frmt_48068->data[I_48705]);
Internalerror_44212(LOC16);
break;
}
LA3: ;
Start_48823 = 0;
Start_48823 = I_48705;
while (1) {
if (!(I_48705 <= (NI32)(Length_48708 - 1))) goto LA17;
if (!!(((NU8)(Frmt_48068->data[I_48705]) == (NU8)(36)))) goto LA19;
I_48705 += 1;
goto LA18;
LA19: ;
goto LA17;
LA18: ;
} LA17: ;
if (!(Start_48823 <= (NI32)(I_48705 - 1))) goto LA22;
LOC24 = 0;
LOC24 = copyStrLast(Frmt_48068, Start_48823, (NI32)(I_48705 - 1));
App_48036(&Result_48704, LOC24);
LA22: ;
} LA1: ;
return Result_48704;
}
N_NIMCALL(TY48008*, Torope_48049)(NI64 I_48051) {
TY48008* Result_48587;
NimStringDesc* LOC1;
Result_48587 = 0;
Result_48587 = NIM_NIL;
LOC1 = 0;
LOC1 = nimInt64ToStr(I_48051);
Result_48587 = Torope_48046(LOC1);
return Result_48587;
}
N_NIMCALL(void, Appf_48071)(TY48008** C_48074, NimStringDesc* Frmt_48075, TY48008** Args_48077, NI Args_48077Len0) {
TY48008* LOC1;
LOC1 = 0;
LOC1 = Ropef_48066(Frmt_48075, Args_48077, Args_48077Len0);
App_48031(C_48074, LOC1);
}
N_NIMCALL(TY48008*, Con_48023)(NimStringDesc* A_48025, TY48008* B_48026) {
TY48008* Result_48551;
TY48008* LOC1;
Result_48551 = 0;
Result_48551 = NIM_NIL;
LOC1 = 0;
LOC1 = Torope_48046(A_48025);
Result_48551 = Con_48015(LOC1, B_48026);
return Result_48551;
}
N_NIMCALL(void, Prepend_48041)(TY48008** A_48044, TY48008* B_48045) {
unsureAsgnRef((void**) &(*A_48044), Con_48015(B_48045, (*A_48044)));
}
static N_INLINE(NI32, Updatecrc32_46014)(NI8 Val_46016, NI32 Crc_46017) {
NI32 Result_46048;
Result_46048 = 0;
Result_46048 = (NI32)(((NI32) (Crc32table_46039[((NI32)((NI32)(((NI) (Crc_46017)) ^ (NI32)(((NI) (Val_46016)) & 255)) & 255))-0])) ^ (NI32)((NU32)(Crc_46017) >> (NU32)(((NI32) 8))));
return Result_46048;
}
static N_INLINE(NI32, Updatecrc32_46018)(NIM_CHAR Val_46020, NI32 Crc_46021) {
NI32 Result_46053;
Result_46053 = 0;
Result_46053 = Updatecrc32_46014(((NI8) (((NU8)(Val_46020)))), Crc_46021);
return Result_46053;
}
N_NIMCALL(NI32, Newcrcfromropeaux_48896)(TY48008* R_48898, NI32 Startval_48899) {
NI32 Result_48900;
TY48406* Stack_48915;
TY48407 LOC1;
TY48008* It_48942;
NI I_48961;
NI L_48964;
Stack_48915 = 0;
It_48942 = 0;
Result_48900 = 0;
Stack_48915 = NIM_NIL;
Stack_48915 = (TY48406*) newSeq(NTI48406, 1);
memset((void*)&LOC1, 0, sizeof(LOC1));
LOC1[0] = R_48898;
asgnRefNoCycle((void**) &Stack_48915->data[0], LOC1[0]);
Result_48900 = Startval_48899;
while (1) {
if (!(0 < Stack_48915->Sup.len)) goto LA2;
It_48942 = NIM_NIL;
It_48942 = Pop_48429(&Stack_48915);
while (1) {
if (!((*It_48942).Data == NIM_NIL)) goto LA3;
Stack_48915 = (TY48406*) incrSeq(&(Stack_48915)->Sup, sizeof(TY48008*));
asgnRefNoCycle((void**) &Stack_48915->data[Stack_48915->Sup.len-1], (*It_48942).Right);
It_48942 = (*It_48942).Left;
} LA3: ;
I_48961 = 0;
I_48961 = 0;
L_48964 = 0;
L_48964 = (*It_48942).Data->Sup.len;
while (1) {
if (!(I_48961 < L_48964)) goto LA4;
Result_48900 = Updatecrc32_46018((*It_48942).Data->data[I_48961], Result_48900);
I_48961 += 1;
} LA4: ;
} LA2: ;
return Result_48900;
}
N_NIMCALL(NI32, Crcfromrope_48981)(TY48008* R_48983) {
NI32 Result_48984;
Result_48984 = 0;
Result_48984 = Newcrcfromropeaux_48896(R_48983, ((NI32) -1));
return Result_48984;
}
N_NIMCALL(void, Writerope_48605)(FILE** F_48608, TY48008* C_48609) {
TY48406* Stack_48624;
TY48407 LOC1;
TY48008* It_48651;
Stack_48624 = 0;
It_48651 = 0;
Stack_48624 = NIM_NIL;
Stack_48624 = (TY48406*) newSeq(NTI48406, 1);
memset((void*)&LOC1, 0, sizeof(LOC1));
LOC1[0] = C_48609;
asgnRefNoCycle((void**) &Stack_48624->data[0], LOC1[0]);
while (1) {
if (!(0 < Stack_48624->Sup.len)) goto LA2;
It_48651 = NIM_NIL;
It_48651 = Pop_48429(&Stack_48624);
while (1) {
if (!((*It_48651).Data == NIM_NIL)) goto LA3;
Stack_48624 = (TY48406*) incrSeq(&(Stack_48624)->Sup, sizeof(TY48008*));
asgnRefNoCycle((void**) &Stack_48624->data[Stack_48624->Sup.len-1], (*It_48651).Right);
It_48651 = (*It_48651).Left;
} LA3: ;
Write_3866((*F_48608), (*It_48651).Data);
} LA2: ;
}
N_NIMCALL(void, Writerope_48055)(TY48008* Head_48057, NimStringDesc* Filename_48058) {
FILE* F_48685;
NIM_BOOL LOC2;
F_48685 = 0;
LOC2 = Open_3817(&F_48685, Filename_48058, ((NU8) 1), -1);
if (!LOC2) goto LA3;
if (!!((Head_48057 == NIM_NIL))) goto LA6;
Writerope_48605(&F_48685, Head_48057);
LA6: ;
fclose(F_48685);
goto LA1;
LA3: ;
Rawmessage_44094(((NU8) 2), Filename_48058);
LA1: ;
}
N_NIMCALL(NIM_BOOL, Writeropeifnotequal_48059)(TY48008* R_48061, NimStringDesc* Filename_48062) {
NIM_BOOL Result_48989;
NI32 C_48990;
NI32 LOC2;
Result_48989 = 0;
C_48990 = 0;
C_48990 = Crcfromfile_46029(Filename_48062);
LOC2 = Crcfromrope_48981(R_48061);
if (!!((C_48990 == LOC2))) goto LA3;
Writerope_48055(R_48061, Filename_48062);
Result_48989 = NIM_TRUE;
goto LA1;
LA3: ;
Result_48989 = NIM_FALSE;
LA1: ;
return Result_48989;
}
N_NIMCALL(NI, Ropelen_48052)(TY48008* A_48054) {
NI Result_48090;
Result_48090 = 0;
if (!(A_48054 == NIM_NIL)) goto LA2;
Result_48090 = 0;
goto LA1;
LA2: ;
Result_48090 = (*A_48054).Length;
LA1: ;
return Result_48090;
}
static N_INLINE(TY48008*, Pop_48429)(TY48406** S_48434) {
TY48008* Result_48435;
NI L_48446;
Result_48435 = 0;
Result_48435 = NIM_NIL;
L_48446 = 0;
L_48446 = (NI32)((*S_48434)->Sup.len - 1);
Result_48435 = (*S_48434)->data[L_48446];
(*S_48434) = (TY48406*) setLengthSeq(&((*S_48434))->Sup, sizeof(TY48008*), L_48446);
return Result_48435;
}
N_NOINLINE(void, ropesInit)(void) {
asgnRefNoCycle((void**) &N_48126, (TY48008*) newObj(NTI48006, sizeof(TY48008)));
(*N_48126).Sup.m_type = NTI48008;
}

