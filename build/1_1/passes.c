/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long int NI;
typedef unsigned long int NU;
#include "nimbase.h"

typedef struct TY51548 TY51548;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY51526 TY51526;
typedef struct TY102006 TY102006;
typedef struct TY102002 TY102002;
typedef struct TY90031 TY90031;
typedef struct TY72204 TY72204;
typedef struct TY89028 TY89028;
typedef struct TY78011 TY78011;
typedef struct TY74267 TY74267;
typedef struct TY74263 TY74263;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY51552 TY51552;
typedef struct TY43538 TY43538;
typedef struct TY50011 TY50011;
typedef struct TY51520 TY51520;
typedef struct TNimObject TNimObject;
typedef struct TY50005 TY50005;
typedef struct TY51530 TY51530;
typedef struct TY51528 TY51528;
typedef struct TY51540 TY51540;
typedef struct TY48008 TY48008;
typedef struct TY51544 TY51544;
typedef struct TY51550 TY51550;
typedef struct TY35021 TY35021;
typedef struct TY90029 TY90029;
typedef struct TY56215 TY56215;
typedef struct TY56213 TY56213;
typedef struct TY56211 TY56211;
typedef struct TY51564 TY51564;
typedef struct TY51562 TY51562;
typedef struct TY51560 TY51560;
typedef struct TY73015 TY73015;
typedef struct TY74281 TY74281;
typedef struct TY39013 TY39013;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY245[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY245 data;
};
typedef N_NIMCALL_PTR(TY51548*, TY102041) (NimStringDesc* Filename_102042);
typedef N_NIMCALL_PTR(TY51526*, TY102045) (NimStringDesc* Filename_102046);
typedef N_NIMCALL_PTR(TY102002*, TY102007) (TY51548* Module_102008, NimStringDesc* Filename_102009);
typedef N_NIMCALL_PTR(TY102002*, TY102012) (TY51548* Module_102013, NimStringDesc* Filename_102014, TY90031* Rd_102015);
typedef N_NIMCALL_PTR(TY51526*, TY102018) (TY102002* P_102019, TY51526* N_102020);
typedef N_NIMCALL_PTR(TY51526*, TY102023) (TY102002* P_102024, TY51526* Toplevelstmt_102025);
struct TY102006 {
TY102007 Open;
TY102012 Opencached;
TY102018 Close;
TY102023 Process;
};
typedef TY102006 TY102131[10];
struct TY78011 {
TY74267* Lex;
TY74263* Tok;
};
struct TY89028 {
NU8 Skin;
TY78011 Parser;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
typedef TY102002* TY102129[10];
struct TY43538 {
NI16 Line;
NI16 Col;
NI32 Fileindex;
};
struct TY51526 {
TY51552* Typ;
NimStringDesc* Comment;
TY43538 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {TY51548* Sym;
} S4;
struct {TY50011* Ident;
} S5;
struct {TY51520* Sons;
} S6;
} KindU;
};
struct TNimObject {
TNimType* m_type;
};
struct TY72204 {
  TNimObject Sup;
NU8 Kind;
FILE* F;
NimStringDesc* S;
NI Rd;
NI Wr;
NI Lineoffset;
};
struct TY50005 {
  TNimObject Sup;
NI Id;
};
struct TY51530 {
TNimType* m_type;
NI Counter;
TY51528* Data;
};
struct TY51540 {
NU8 K;
NU8 S;
NU8 Flags;
TY51552* T;
TY48008* R;
NI A;
};
struct TY51548 {
  TY50005 Sup;
NU8 Kind;
NU8 Magic;
TY51552* Typ;
TY50011* Name;
TY43538 Info;
TY51548* Owner;
NU32 Flags;
TY51530 Tab;
TY51526* Ast;
NU32 Options;
NI Position;
NI Offset;
TY51540 Loc;
TY51544* Annex;
};
struct TY51552 {
  TY50005 Sup;
NU8 Kind;
TY51550* Sons;
TY51526* N;
NU8 Flags;
NU8 Callconv;
TY51548* Owner;
TY51548* Sym;
NI64 Size;
NI Align;
NI Containerid;
TY51540 Loc;
};
struct TY102002 {
  TNimObject Sup;
};
struct TY56211 {
NI Key;
NI Val;
};
struct TY56215 {
NI Counter;
TY56213* Data;
};
struct TY90029 {
NI Lastidxkey;
NI Lastidxval;
TY56215 Tab;
TY48008* R;
NI Offset;
};
struct TY51560 {
TY50005* Key;
TNimObject* Val;
};
struct TY51564 {
NI Counter;
TY51562* Data;
};
struct TY90031 {
  TNimObject Sup;
NI Pos;
NimStringDesc* S;
NU32 Options;
NU8 Reason;
TY35021* Moddeps;
TY35021* Files;
NI Dataidx;
NI Convertersidx;
NI Initidx;
NI Interfidx;
NI Compilerprocsidx;
NI Cgenidx;
NimStringDesc* Filename;
TY90029 Index;
TY90029 Imports;
NI Readerindex;
NI Line;
NI Moduleid;
TY51564 Syms;
};
struct TY73015 {
  TNimObject Sup;
NI Bufpos;
NCSTRING Buf;
NI Buflen;
TY72204* Stream;
NI Linenumber;
NI Sentinel;
NI Linestart;
};
struct TY74267 {
  TY73015 Sup;
NimStringDesc* Filename;
TY74281* Indentstack;
NI Dedent;
NI Indentahead;
};
struct TY74263 {
TNimType* m_type;
NU8 Toktype;
NI Indent;
TY50011* Ident;
NI64 Inumber;
NF64 Fnumber;
NU8 Base;
NimStringDesc* Literal;
TY74263* Next;
};
struct TY50011 {
  TY50005 Sup;
NimStringDesc* S;
TY50011* Next;
NI H;
};
struct TY48008 {
  TNimObject Sup;
TY48008* Left;
TY48008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY39013 {
  TNimObject Sup;
TY39013* Prev;
TY39013* Next;
};
struct TY51544 {
  TY39013 Sup;
NU8 Kind;
NIM_BOOL Generated;
TY48008* Name;
TY51526* Path;
};
struct TY51520 {
  TGenericSeq Sup;
  TY51526* data[SEQ_DECL_SIZE];
};
struct TY51528 {
  TGenericSeq Sup;
  TY51548* data[SEQ_DECL_SIZE];
};
struct TY51550 {
  TGenericSeq Sup;
  TY51552* data[SEQ_DECL_SIZE];
};
struct TY35021 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
struct TY56213 {
  TGenericSeq Sup;
  TY56211 data[SEQ_DECL_SIZE];
};
struct TY51562 {
  TGenericSeq Sup;
  TY51560 data[SEQ_DECL_SIZE];
};
struct TY74281 {
  TGenericSeq Sup;
  NI data[SEQ_DECL_SIZE];
};
N_NIMCALL(void, genericReset)(void* Dest_19528, TNimType* Mt_19529);
N_NIMCALL(void, Openpasses_102150)(TY102002** A_102153, TY51548* Module_102154, NimStringDesc* Filename_102155);
N_NIMCALL(TY72204*, Llstreamopen_72224)(NimStringDesc* Filename_72226, NU8 Mode_72227);
N_NIMCALL(void, Rawmessage_44094)(NU8 Msg_44096, NimStringDesc* Arg_44097);
N_NIMCALL(void, Openparsers_89034)(TY89028* P_89037, NimStringDesc* Filename_89038, TY72204* Inputstream_89039);
N_NIMCALL(TY51526*, Parsetoplevelstmt_89048)(TY89028* P_89051);
N_NIMCALL(void, Processtoplevelstmt_102219)(TY51526* N_102221, TY102002** A_102223);
N_NIMCALL(void, Closeparsers_89040)(TY89028* P_89043);
N_NIMCALL(void, Closepasses_102202)(TY102002** A_102205);
N_NIMCALL(void, Idsynchronizationpoint_51699)(NI Idrange_51701);
N_NIMCALL(void, Openpassescached_102183)(TY102002** A_102186, TY51548* Module_102187, NimStringDesc* Filename_102188, TY90031* Rd_102189);
N_NIMCALL(TY51526*, Loadinitsection_90067)(TY90031* R_90069);
static N_INLINE(NI, Sonslen_51804)(TY51526* N_51806);
N_NIMCALL(void, Processtoplevelstmtcached_102237)(TY51526* N_102239, TY102002** A_102241);
N_NIMCALL(void, Closepassescached_102255)(TY102002** A_102258);
TY102041 Gimportmodule_102044;
TY102045 Gincludefile_102048;
TY102131 Gpasses_102133;
NI Gpasseslen_102134;
extern TNimType* NTI89028; /* TParsers */
extern TNimType* NTI102129; /* TPassContextArray */
extern TY51526* Emptynode_51858;
N_NIMCALL(void, Openpasses_102150)(TY102002** A_102153, TY51548* Module_102154, NimStringDesc* Filename_102155) {
NI I_102179;
NI HEX3Atmp_102180;
NI Res_102182;
I_102179 = 0;
HEX3Atmp_102180 = 0;
HEX3Atmp_102180 = (NI32)(Gpasseslen_102134 - 1);
Res_102182 = 0;
Res_102182 = 0;
while (1) {
if (!(Res_102182 <= HEX3Atmp_102180)) goto LA1;
I_102179 = Res_102182;
if (!!(((void*) (Gpasses_102133[(I_102179)-0].Open)) == 0)) goto LA3;
A_102153[(I_102179)-0] = Gpasses_102133[(I_102179)-0].Open(Module_102154, Filename_102155);
goto LA2;
LA3: ;
A_102153[(I_102179)-0] = NIM_NIL;
LA2: ;
Res_102182 += 1;
} LA1: ;
}
N_NIMCALL(void, Processtoplevelstmt_102219)(TY51526* N_102221, TY102002** A_102223) {
TY51526* M_102224;
NI I_102233;
NI HEX3Atmp_102234;
NI Res_102236;
M_102224 = 0;
M_102224 = NIM_NIL;
M_102224 = N_102221;
I_102233 = 0;
HEX3Atmp_102234 = 0;
HEX3Atmp_102234 = (NI32)(Gpasseslen_102134 - 1);
Res_102236 = 0;
Res_102236 = 0;
while (1) {
if (!(Res_102236 <= HEX3Atmp_102234)) goto LA1;
I_102233 = Res_102236;
if (!!(((void*) (Gpasses_102133[(I_102233)-0].Process)) == 0)) goto LA3;
M_102224 = Gpasses_102133[(I_102233)-0].Process(A_102223[(I_102233)-0], M_102224);
LA3: ;
Res_102236 += 1;
} LA1: ;
}
N_NIMCALL(void, Closepasses_102202)(TY102002** A_102205) {
TY51526* M_102206;
NI I_102215;
NI HEX3Atmp_102216;
NI Res_102218;
M_102206 = 0;
M_102206 = NIM_NIL;
M_102206 = NIM_NIL;
I_102215 = 0;
HEX3Atmp_102216 = 0;
HEX3Atmp_102216 = (NI32)(Gpasseslen_102134 - 1);
Res_102218 = 0;
Res_102218 = 0;
while (1) {
if (!(Res_102218 <= HEX3Atmp_102216)) goto LA1;
I_102215 = Res_102218;
if (!!(((void*) (Gpasses_102133[(I_102215)-0].Close)) == 0)) goto LA3;
M_102206 = Gpasses_102133[(I_102215)-0].Close(A_102205[(I_102215)-0], M_102206);
LA3: ;
A_102205[(I_102215)-0] = NIM_NIL;
Res_102218 += 1;
} LA1: ;
}
N_NIMCALL(void, Openpassescached_102183)(TY102002** A_102186, TY51548* Module_102187, NimStringDesc* Filename_102188, TY90031* Rd_102189) {
NI I_102198;
NI HEX3Atmp_102199;
NI Res_102201;
I_102198 = 0;
HEX3Atmp_102199 = 0;
HEX3Atmp_102199 = (NI32)(Gpasseslen_102134 - 1);
Res_102201 = 0;
Res_102201 = 0;
while (1) {
if (!(Res_102201 <= HEX3Atmp_102199)) goto LA1;
I_102198 = Res_102201;
if (!!(((void*) (Gpasses_102133[(I_102198)-0].Opencached)) == 0)) goto LA3;
A_102186[(I_102198)-0] = Gpasses_102133[(I_102198)-0].Opencached(Module_102187, Filename_102188, Rd_102189);
goto LA2;
LA3: ;
A_102186[(I_102198)-0] = NIM_NIL;
LA2: ;
Res_102201 += 1;
} LA1: ;
}
static N_INLINE(NI, Sonslen_51804)(TY51526* N_51806) {
NI Result_52897;
Result_52897 = 0;
if (!(*N_51806).KindU.S6.Sons == 0) goto LA2;
Result_52897 = 0;
goto LA1;
LA2: ;
Result_52897 = (*N_51806).KindU.S6.Sons->Sup.len;
LA1: ;
return Result_52897;
}
N_NIMCALL(void, Processtoplevelstmtcached_102237)(TY51526* N_102239, TY102002** A_102241) {
TY51526* M_102242;
NI I_102251;
NI HEX3Atmp_102252;
NI Res_102254;
M_102242 = 0;
M_102242 = NIM_NIL;
M_102242 = N_102239;
I_102251 = 0;
HEX3Atmp_102252 = 0;
HEX3Atmp_102252 = (NI32)(Gpasseslen_102134 - 1);
Res_102254 = 0;
Res_102254 = 0;
while (1) {
if (!(Res_102254 <= HEX3Atmp_102252)) goto LA1;
I_102251 = Res_102254;
if (!!(((void*) (Gpasses_102133[(I_102251)-0].Opencached)) == 0)) goto LA3;
M_102242 = Gpasses_102133[(I_102251)-0].Process(A_102241[(I_102251)-0], M_102242);
LA3: ;
Res_102254 += 1;
} LA1: ;
}
N_NIMCALL(void, Closepassescached_102255)(TY102002** A_102258) {
TY51526* M_102259;
NI I_102268;
NI HEX3Atmp_102269;
NI Res_102271;
NIM_BOOL LOC3;
M_102259 = 0;
M_102259 = NIM_NIL;
M_102259 = Emptynode_51858;
I_102268 = 0;
HEX3Atmp_102269 = 0;
HEX3Atmp_102269 = (NI32)(Gpasseslen_102134 - 1);
Res_102271 = 0;
Res_102271 = 0;
while (1) {
if (!(Res_102271 <= HEX3Atmp_102269)) goto LA1;
I_102268 = Res_102271;
LOC3 = !(((void*) (Gpasses_102133[(I_102268)-0].Opencached)) == 0);
if (!(LOC3)) goto LA4;
LOC3 = !(((void*) (Gpasses_102133[(I_102268)-0].Close)) == 0);
LA4: ;
if (!LOC3) goto LA5;
M_102259 = Gpasses_102133[(I_102268)-0].Close(A_102258[(I_102268)-0], M_102259);
LA5: ;
A_102258[(I_102268)-0] = NIM_NIL;
Res_102271 += 1;
} LA1: ;
}
N_NIMCALL(void, Processmodule_102035)(TY51548* Module_102037, NimStringDesc* Filename_102038, TY72204* Stream_102039, TY90031* Rd_102040) {
TY89028 P_102278;
TY102129 A_102279;
TY72204* S_102280;
TY51526* N_102317;
TY51526* N_102340;
NI I_102349;
NI HEX3Atmp_102364;
NI LOC18;
NI Res_102366;
memset((void*)&P_102278, 0, sizeof(P_102278));
memset((void*)&A_102279, 0, sizeof(A_102279));
S_102280 = 0;
N_102317 = 0;
N_102340 = 0;
genericReset((void*)&P_102278, NTI89028);
genericReset((void*)&A_102279, NTI102129);
S_102280 = NIM_NIL;
if (!(Rd_102040 == NIM_NIL)) goto LA2;
Openpasses_102150(A_102279, Module_102037, Filename_102038);
if (!(Stream_102039 == NIM_NIL)) goto LA5;
S_102280 = Llstreamopen_72224(Filename_102038, ((NU8) 0));
if (!(S_102280 == NIM_NIL)) goto LA8;
Rawmessage_44094(((NU8) 2), Filename_102038);
goto BeforeRet;
LA8: ;
goto LA4;
LA5: ;
S_102280 = Stream_102039;
LA4: ;
while (1) {
Openparsers_89034(&P_102278, Filename_102038, S_102280);
while (1) {
N_102317 = NIM_NIL;
N_102317 = Parsetoplevelstmt_89048(&P_102278);
if (!((*N_102317).Kind == ((NU8) 1))) goto LA13;
goto LA11;
LA13: ;
Processtoplevelstmt_102219(N_102317, A_102279);
} LA11: ;
Closeparsers_89040(&P_102278);
if (!!(((*S_102280).Kind == ((NU8) 3)))) goto LA16;
goto LA10;
LA16: ;
} LA10: ;
Closepasses_102202(A_102279);
Idsynchronizationpoint_51699(1000);
goto LA1;
LA2: ;
Openpassescached_102183(A_102279, Module_102037, Filename_102038, Rd_102040);
N_102340 = NIM_NIL;
N_102340 = Loadinitsection_90067(Rd_102040);
I_102349 = 0;
HEX3Atmp_102364 = 0;
LOC18 = Sonslen_51804(N_102340);
HEX3Atmp_102364 = (NI32)(LOC18 - 1);
Res_102366 = 0;
Res_102366 = 0;
while (1) {
if (!(Res_102366 <= HEX3Atmp_102364)) goto LA19;
I_102349 = Res_102366;
Processtoplevelstmtcached_102237((*N_102340).KindU.S6.Sons->data[I_102349], A_102279);
Res_102366 += 1;
} LA19: ;
Closepassescached_102255(A_102279);
LA1: ;
BeforeRet: ;
}
N_NIMCALL(void, Registerpass_102028)(TY102006* P_102030) {
Gpasses_102133[(Gpasseslen_102134)-0] = (*P_102030);
Gpasseslen_102134 += 1;
}
N_NIMCALL(void, Initpass_102031)(TY102006* P_102034) {
(*P_102034).Open = NIM_NIL;
(*P_102034).Opencached = NIM_NIL;
(*P_102034).Close = NIM_NIL;
(*P_102034).Process = NIM_NIL;
}
N_NIMCALL(NIM_BOOL, Astneeded_102057)(TY51548* S_102059) {
NIM_BOOL Result_102060;
NIM_BOOL LOC2;
NIM_BOOL LOC3;
NIM_BOOL LOC4;
Result_102060 = 0;
LOC4 = ((3072 &(1<<(((*S_102059).Kind)&31)))!=0);
if (!(LOC4)) goto LA5;
LOC4 = ((34078720 & (*S_102059).Flags) == 0);
LA5: ;
LOC3 = LOC4;
if (!(LOC3)) goto LA6;
LOC3 = !(((*(*S_102059).Typ).Callconv == ((NU8) 5)));
LA6: ;
LOC2 = LOC3;
if (!(LOC2)) goto LA7;
LOC2 = ((*(*(*S_102059).Ast).KindU.S6.Sons->data[1]).Kind == ((NU8) 1));
LA7: ;
if (!LOC2) goto LA8;
Result_102060 = NIM_FALSE;
goto LA1;
LA8: ;
Result_102060 = NIM_TRUE;
LA1: ;
return Result_102060;
}
N_NOINLINE(void, passesInit)(void) {
}

