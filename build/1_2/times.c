/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

#include <time.h>
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY27402 TY27402;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY27402 {
  TNimObject Sup;
NI Second;
NI Minute;
NI Hour;
NI Monthday;
NU8 Month;
NI Year;
NU8 Weekday;
NI Yearday;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
typedef NU8 TY27648[7];
N_NIMCALL(TY27402, Getlocaltime_27418)(NI32 T_27420);
N_NIMCALL(TY27402, Tmtotimeinfo_27643)(struct tm* Tm_27645);
N_NIMCALL(NI32, Gettime_27416)(void);
N_NIMCALL(NimStringDesc*, nimIntToStr)(NI X_17603);
static N_INLINE(void, appendString)(NimStringDesc* Dest_16992, NimStringDesc* Src_16993);
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17009, NIM_CHAR C_17010);
N_NIMCALL(NimStringDesc*, nsuIntToStr)(NI X_23471, NI Minchars_23472);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_16887);
NIM_CONST TY27648 Weekdays_27647 = {((NU8) 6),
((NU8) 0),
((NU8) 1),
((NU8) 2),
((NU8) 3),
((NU8) 4),
((NU8) 5)}
;
extern NIM_CONST TY27648 Weekdays_27647;
extern TNimType* NTI27402; /* TTimeInfo */
N_NIMCALL(NI32, Gettime_27416)(void) {
NI32 Result_28203;
Result_28203 = 0;
Result_28203 = time(NIM_NIL);
goto BeforeRet;
BeforeRet: ;
return Result_28203;
}
N_NIMCALL(TY27402, Tmtotimeinfo_27643)(struct tm* Tm_27645) {
TY27402 Result_27646;
memset((void*)&Result_27646, 0, sizeof(Result_27646));
Result_27646.Sup.m_type = NTI27402;
Result_27646.Second = ((NI) (((NI) ((*Tm_27645).tm_sec))));
Result_27646.Minute = ((NI) (((NI) ((*Tm_27645).tm_min))));
Result_27646.Hour = ((NI) (((NI) ((*Tm_27645).tm_hour))));
Result_27646.Monthday = ((NI) (((NI) ((*Tm_27645).tm_mday))));
Result_27646.Month = ((NU8) ((*Tm_27645).tm_mon));
Result_27646.Year = ((NI) ((NI32)((*Tm_27645).tm_year + ((NI32) 1900))));
Result_27646.Weekday = Weekdays_27647[(((NI) ((*Tm_27645).tm_wday)))-0];
Result_27646.Yearday = ((NI) (((NI) ((*Tm_27645).tm_yday))));
return Result_27646;
}
N_NIMCALL(TY27402, Getlocaltime_27418)(NI32 T_27420) {
TY27402 Result_28207;
NI32 A_28208;
struct tm* LOC1;
memset((void*)&Result_28207, 0, sizeof(Result_28207));
Result_28207.Sup.m_type = NTI27402;
A_28208 = 0;
A_28208 = T_27420;
LOC1 = localtime(&A_28208);
Result_28207 = Tmtotimeinfo_27643(&(*LOC1));
return Result_28207;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_16992, NimStringDesc* Src_16993) {
memcpy(((NCSTRING) (&(*Dest_16992).data[((*Dest_16992).Sup.len)-0])), ((NCSTRING) ((*Src_16993).data)), ((NI32) ((NI64)((NI64)((*Src_16993).Sup.len + 1) * 1))));
(*Dest_16992).Sup.len += (*Src_16993).Sup.len;
}
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17009, NIM_CHAR C_17010) {
(*Dest_17009).data[((*Dest_17009).Sup.len)-0] = C_17010;
(*Dest_17009).data[((NI64)((*Dest_17009).Sup.len + 1))-0] = 0;
(*Dest_17009).Sup.len += 1;
}
N_NIMCALL(NimStringDesc*, ntgetDateStr)(void) {
NimStringDesc* Result_28804;
TY27402 Ti_28805;
NI32 LOC1;
NimStringDesc* LOC2;
NimStringDesc* LOC3;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
Result_28804 = 0;
memset((void*)&Ti_28805, 0, sizeof(Ti_28805));
LOC1 = Gettime_27416();
Ti_28805 = Getlocaltime_27418(LOC1);
Ti_28805.Sup.m_type = NTI27402;
LOC3 = nimIntToStr(Ti_28805.Year);
LOC4 = nsuIntToStr((NI64)(Ti_28805.Month + 1), 2);
LOC5 = nsuIntToStr(((NI) (Ti_28805.Monthday)), 2);
LOC2 = rawNewString(LOC3->Sup.len + LOC4->Sup.len + LOC5->Sup.len + 2);
appendString(LOC2, LOC3);
appendChar(LOC2, 45);
appendString(LOC2, LOC4);
appendChar(LOC2, 45);
appendString(LOC2, LOC5);
Result_28804 = LOC2;
return Result_28804;
}
N_NIMCALL(NimStringDesc*, ntgetClockStr)(void) {
NimStringDesc* Result_28839;
TY27402 Ti_28840;
NI32 LOC1;
NimStringDesc* LOC2;
NimStringDesc* LOC3;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
Result_28839 = 0;
memset((void*)&Ti_28840, 0, sizeof(Ti_28840));
LOC1 = Gettime_27416();
Ti_28840 = Getlocaltime_27418(LOC1);
Ti_28840.Sup.m_type = NTI27402;
LOC3 = nsuIntToStr(((NI) (Ti_28840.Hour)), 2);
LOC4 = nsuIntToStr(((NI) (Ti_28840.Minute)), 2);
LOC5 = nsuIntToStr(((NI) (Ti_28840.Second)), 2);
LOC2 = rawNewString(LOC3->Sup.len + LOC4->Sup.len + LOC5->Sup.len + 2);
appendString(LOC2, LOC3);
appendChar(LOC2, 58);
appendString(LOC2, LOC4);
appendChar(LOC2, 58);
appendString(LOC2, LOC5);
Result_28839 = LOC2;
return Result_28839;
}
N_NIMCALL(NI64, ntDiffTime)(NI32 A_27435, NI32 B_27436) {
NI64 Result_27669;
NF LOC1;
Result_27669 = 0;
LOC1 = difftime(A_27435, B_27436);
Result_27669 = float64ToInt64(((NF64) (LOC1)));
goto BeforeRet;
BeforeRet: ;
return Result_27669;
}
N_NIMCALL(NI32, Wintimetounixtime_28261)(NI64 T_28263) {
NI32 Result_28264;
Result_28264 = 0;
Result_28264 = ((NI32) ((NI64)((NI64)(T_28263 - IL64(116444736000000000)) / 10000000)));
return Result_28264;
}
N_NOINLINE(void, timesInit)(void) {
}

