/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct TY39008 TY39008;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TNimObject TNimObject;
typedef struct TY39006 TY39006;
typedef struct TY39004 TY39004;
typedef struct TY10202 TY10202;
typedef struct TY10218 TY10218;
typedef struct TY10590 TY10590;
typedef struct TY10214 TY10214;
typedef struct TY10210 TY10210;
typedef struct TY10588 TY10588;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TNimObject {
TNimType* m_type;
};
struct TY39004 {
NimStringDesc* Key;
NimStringDesc* Val;
};
struct TY39008 {
  TNimObject Sup;
NI Counter;
TY39006* Data;
NU8 Mode;
};
struct TY10202 {
NI Refcount;
TNimType* Typ;
};
struct TY10218 {
NI Len;
NI Cap;
TY10202** D;
};
struct TY10214 {
NI Counter;
NI Max;
TY10210* Head;
TY10210** Data;
};
struct TY10588 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10590 {
TY10218 Zct;
TY10218 Decstack;
TY10214 Cycleroots;
TY10218 Tempstack;
TY10588 Stat;
};
typedef NI TY8214[8];
struct TY10210 {
TY10210* Next;
NI Key;
TY8214 Bits;
};
struct TY39006 {
  TGenericSeq Sup;
  TY39004 data[SEQ_DECL_SIZE];
};
N_NIMCALL(void*, newObj)(TNimType* Typ_11907, NI Size_11908);
N_NIMCALL(void*, newSeq)(TNimType* Typ_12403, NI Len_12404);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11416, void* Src_11417);
static N_INLINE(TY10202*, Usrtocell_10622)(void* Usr_10624);
static N_INLINE(void, Rtladdzct_11256)(TY10202* C_11258);
N_NOINLINE(void, Addzct_10611)(TY10218* S_10614, TY10202* C_10615);
N_NIMCALL(void, Put_39024)(TY39008* T_39026, NimStringDesc* Key_39027, NimStringDesc* Val_39028);
N_NIMCALL(NI, Rawget_39142)(TY39008* T_39144, NimStringDesc* Key_39145);
N_NIMCALL(NI, Myhash_39105)(TY39008* T_39107, NimStringDesc* Key_39108);
N_NIMCALL(NI, Gethashstr_38031)(NimStringDesc* S_38033);
N_NIMCALL(NI, Gethashstrci_38034)(NimStringDesc* S_38036);
N_NIMCALL(NI, Getnormalizedhash_38037)(NimStringDesc* S_38039);
N_NIMCALL(NIM_BOOL, Mycmp_39110)(TY39008* T_39112, NimStringDesc* A_39113, NimStringDesc* B_39114);
N_NIMCALL(NI, Cmp_1319)(NimStringDesc* X_1321, NimStringDesc* Y_1322);
N_NIMCALL(NI, nsuCmpIgnoreCase)(NimStringDesc* A_22595, NimStringDesc* B_22596);
N_NIMCALL(NI, nsuCmpIgnoreStyle)(NimStringDesc* A_22638, NimStringDesc* B_22639);
N_NIMCALL(NI, Nexttry_39137)(NI H_39139, NI Maxhash_39140);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_16908);
N_NIMCALL(NIM_BOOL, Mustrehash_39122)(NI Length_39124, NI Counter_39125);
N_NIMCALL(void, Enlarge_39173)(TY39008* T_39175);
N_NIMCALL(void, Rawinsert_39164)(TY39008* T_39166, TY39006** Data_39168, NimStringDesc* Key_39169, NimStringDesc* Val_39170);
STRING_LITERAL(TMP190679, "", 0);
extern TNimType* NTI39010; /* PStringTable */
extern TNimType* NTI39008; /* TStringTable */
extern TNimType* NTI39006; /* TKeyValuePairSeq */
extern TY10590 Gch_10608;
static N_INLINE(TY10202*, Usrtocell_10622)(void* Usr_10624) {
TY10202* Result_10625;
Result_10625 = 0;
Result_10625 = ((TY10202*) ((NI64)((NU64)(((NI) (Usr_10624))) - (NU64)(((NI) (((NI)sizeof(TY10202))))))));
return Result_10625;
}
static N_INLINE(void, Rtladdzct_11256)(TY10202* C_11258) {
Addzct_10611(&Gch_10608.Zct, C_11258);
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11416, void* Src_11417) {
TY10202* C_11418;
TY10202* C_11419;
if (!!((Src_11417 == NIM_NIL))) goto LA2;
C_11418 = 0;
C_11418 = Usrtocell_10622(Src_11417);
(*C_11418).Refcount = (NI64)((NU64)((*C_11418).Refcount) + (NU64)(8));
LA2: ;
if (!!(((*Dest_11416) == NIM_NIL))) goto LA5;
C_11419 = 0;
C_11419 = Usrtocell_10622((*Dest_11416));
(*C_11419).Refcount = (NI64)((NU64)((*C_11419).Refcount) - (NU64)(8));
if (!((NU64)((*C_11419).Refcount) < (NU64)(8))) goto LA8;
Rtladdzct_11256(C_11419);
LA8: ;
LA5: ;
(*Dest_11416) = Src_11417;
}
N_NIMCALL(NI, Myhash_39105)(TY39008* T_39107, NimStringDesc* Key_39108) {
NI Result_39109;
Result_39109 = 0;
switch ((*T_39107).Mode) {
case ((NU8) 0):
Result_39109 = Gethashstr_38031(Key_39108);
break;
case ((NU8) 1):
Result_39109 = Gethashstrci_38034(Key_39108);
break;
case ((NU8) 2):
Result_39109 = Getnormalizedhash_38037(Key_39108);
break;
}
return Result_39109;
}
N_NIMCALL(NIM_BOOL, Mycmp_39110)(TY39008* T_39112, NimStringDesc* A_39113, NimStringDesc* B_39114) {
NIM_BOOL Result_39115;
NI LOC1;
NI LOC2;
NI LOC3;
Result_39115 = 0;
switch ((*T_39112).Mode) {
case ((NU8) 0):
LOC1 = Cmp_1319(A_39113, B_39114);
Result_39115 = (LOC1 == 0);
break;
case ((NU8) 1):
LOC2 = nsuCmpIgnoreCase(A_39113, B_39114);
Result_39115 = (LOC2 == 0);
break;
case ((NU8) 2):
LOC3 = nsuCmpIgnoreStyle(A_39113, B_39114);
Result_39115 = (LOC3 == 0);
break;
}
return Result_39115;
}
N_NIMCALL(NI, Nexttry_39137)(NI H_39139, NI Maxhash_39140) {
NI Result_39141;
Result_39141 = 0;
Result_39141 = (NI64)((NI64)((NI64)(5 * H_39139) + 1) & Maxhash_39140);
return Result_39141;
}
N_NIMCALL(NI, Rawget_39142)(TY39008* T_39144, NimStringDesc* Key_39145) {
NI Result_39146;
NI H_39147;
NI LOC1;
NIM_BOOL LOC4;
Result_39146 = 0;
H_39147 = 0;
LOC1 = Myhash_39105(T_39144, Key_39145);
H_39147 = (NI64)(LOC1 & ((*T_39144).Data->Sup.len-1));
while (1) {
if (!!((*T_39144).Data->data[H_39147].Key == 0)) goto LA2;
LOC4 = Mycmp_39110(T_39144, (*T_39144).Data->data[H_39147].Key, Key_39145);
if (!LOC4) goto LA5;
Result_39146 = H_39147;
goto BeforeRet;
LA5: ;
H_39147 = Nexttry_39137(H_39147, ((*T_39144).Data->Sup.len-1));
} LA2: ;
Result_39146 = -1;
BeforeRet: ;
return Result_39146;
}
N_NIMCALL(NIM_BOOL, Mustrehash_39122)(NI Length_39124, NI Counter_39125) {
NIM_BOOL Result_39126;
NIM_BOOL LOC1;
Result_39126 = 0;
LOC1 = ((NI64)(Length_39124 * 2) < (NI64)(Counter_39125 * 3));
if (LOC1) goto LA2;
LOC1 = ((NI64)(Length_39124 - Counter_39125) < 4);
LA2: ;
Result_39126 = LOC1;
return Result_39126;
}
N_NIMCALL(void, Rawinsert_39164)(TY39008* T_39166, TY39006** Data_39168, NimStringDesc* Key_39169, NimStringDesc* Val_39170) {
NI H_39171;
NI LOC1;
H_39171 = 0;
LOC1 = Myhash_39105(T_39166, Key_39169);
H_39171 = (NI64)(LOC1 & ((*Data_39168)->Sup.len-1));
while (1) {
if (!!((*Data_39168)->data[H_39171].Key == 0)) goto LA2;
H_39171 = Nexttry_39137(H_39171, ((*Data_39168)->Sup.len-1));
} LA2: ;
asgnRefNoCycle((void**) &(*Data_39168)->data[H_39171].Key, copyString(Key_39169));
asgnRefNoCycle((void**) &(*Data_39168)->data[H_39171].Val, copyString(Val_39170));
}
N_NIMCALL(void, Enlarge_39173)(TY39008* T_39175) {
TY39006* N_39176;
NI I_39221;
NI HEX3Atmp_39233;
NI Res_39235;
TY39006* LOC5;
N_39176 = 0;
N_39176 = (TY39006*) newSeq(NTI39006, (NI64)((*T_39175).Data->Sup.len * 2));
I_39221 = 0;
HEX3Atmp_39233 = 0;
HEX3Atmp_39233 = ((*T_39175).Data->Sup.len-1);
Res_39235 = 0;
Res_39235 = 0;
while (1) {
if (!(Res_39235 <= HEX3Atmp_39233)) goto LA1;
I_39221 = Res_39235;
if (!!((*T_39175).Data->data[I_39221].Key == 0)) goto LA3;
Rawinsert_39164(T_39175, &N_39176, (*T_39175).Data->data[I_39221].Key, (*T_39175).Data->data[I_39221].Val);
LA3: ;
Res_39235 += 1;
} LA1: ;
LOC5 = (*T_39175).Data;
asgnRefNoCycle((void**) &(*T_39175).Data, N_39176);
N_39176 = LOC5;
}
N_NIMCALL(void, Put_39024)(TY39008* T_39026, NimStringDesc* Key_39027, NimStringDesc* Val_39028) {
NI Index_39243;
NIM_BOOL LOC5;
Index_39243 = 0;
Index_39243 = Rawget_39142(T_39026, Key_39027);
if (!(0 <= Index_39243)) goto LA2;
asgnRefNoCycle((void**) &(*T_39026).Data->data[Index_39243].Val, copyString(Val_39028));
goto LA1;
LA2: ;
LOC5 = Mustrehash_39122((*T_39026).Data->Sup.len, (*T_39026).Counter);
if (!LOC5) goto LA6;
Enlarge_39173(T_39026);
LA6: ;
Rawinsert_39164(T_39026, &(*T_39026).Data, Key_39027, Val_39028);
(*T_39026).Counter += 1;
LA1: ;
}
N_NIMCALL(TY39008*, Newstringtable_39019)(NimStringDesc** Keyvaluepairs_39022, NI Keyvaluepairs_39022Len0, NU8 Mode_39023) {
TY39008* Result_39061;
NI I_39089;
Result_39061 = 0;
Result_39061 = (TY39008*) newObj(NTI39010, sizeof(TY39008));
(*Result_39061).Sup.m_type = NTI39008;
(*Result_39061).Mode = Mode_39023;
(*Result_39061).Counter = 0;
asgnRefNoCycle((void**) &(*Result_39061).Data, (TY39006*) newSeq(NTI39006, 64));
I_39089 = 0;
I_39089 = 0;
while (1) {
if (!(I_39089 < (Keyvaluepairs_39022Len0-1))) goto LA1;
Put_39024(Result_39061, Keyvaluepairs_39022[I_39089], Keyvaluepairs_39022[(NI64)(I_39089 + 1)]);
I_39089 += 2;
} LA1: ;
return Result_39061;
}
N_NIMCALL(NimStringDesc*, Get_39029)(TY39008* T_39031, NimStringDesc* Key_39032) {
NimStringDesc* Result_39153;
NI Index_39154;
Result_39153 = 0;
Index_39154 = 0;
Index_39154 = Rawget_39142(T_39031, Key_39032);
if (!(0 <= Index_39154)) goto LA2;
Result_39153 = copyString((*T_39031).Data->data[Index_39154].Val);
goto LA1;
LA2: ;
Result_39153 = copyString(((NimStringDesc*) &TMP190679));
LA1: ;
return Result_39153;
}
N_NIMCALL(NIM_BOOL, Haskey_39033)(TY39008* T_39035, NimStringDesc* Key_39036) {
NIM_BOOL Result_39161;
NI LOC1;
Result_39161 = 0;
LOC1 = Rawget_39142(T_39035, Key_39036);
Result_39161 = (0 <= LOC1);
return Result_39161;
}
N_NOINLINE(void, nstrtabsInit)(void) {
}

