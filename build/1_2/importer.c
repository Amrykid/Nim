/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct TY49523 TY49523;
typedef struct TY100012 TY100012;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY49549 TY49549;
typedef struct TY41532 TY41532;
typedef struct TY49545 TY49545;
typedef struct TY48011 TY48011;
typedef struct TY49517 TY49517;
typedef struct TY48005 TY48005;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY49527 TY49527;
typedef struct TY49525 TY49525;
typedef struct TY49537 TY49537;
typedef struct TY46008 TY46008;
typedef struct TY49541 TY49541;
typedef struct TY53079 TY53079;
typedef struct TY98002 TY98002;
typedef struct TY100006 TY100006;
typedef struct TY53107 TY53107;
typedef struct TY53109 TY53109;
typedef struct TY49898 TY49898;
typedef struct TY49894 TY49894;
typedef struct TY49896 TY49896;
typedef struct TY37019 TY37019;
typedef struct TY37013 TY37013;
typedef struct TY49547 TY49547;
typedef struct TY53092 TY53092;
typedef struct TY10202 TY10202;
typedef struct TY10218 TY10218;
typedef struct TY10590 TY10590;
typedef struct TY10214 TY10214;
typedef struct TY10210 TY10210;
typedef struct TY10588 TY10588;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TY41532 {
NI16 Line;
NI16 Col;
NI32 Fileindex;
};
struct TY49523 {
TY49549* Typ;
NimStringDesc* Comment;
TY41532 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {TY49545* Sym;
} S4;
struct {TY48011* Ident;
} S5;
struct {TY49517* Sons;
} S6;
} KindU;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY48005 {
  TNimObject Sup;
NI Id;
};
struct TY48011 {
  TY48005 Sup;
NimStringDesc* S;
TY48011* Next;
NI H;
};
struct TY49527 {
TNimType* m_type;
NI Counter;
TY49525* Data;
};
struct TY49537 {
NU8 K;
NU8 S;
NU8 Flags;
TY49549* T;
TY46008* R;
NI A;
};
struct TY49545 {
  TY48005 Sup;
NU8 Kind;
NU8 Magic;
TY49549* Typ;
TY48011* Name;
TY41532 Info;
TY49545* Owner;
NU32 Flags;
TY49527 Tab;
TY49523* Ast;
NU32 Options;
NI Position;
NI Offset;
TY49537 Loc;
TY49541* Annex;
};
typedef N_NIMCALL_PTR(TY49545*, TY98044) (NimStringDesc* Filename_98045);
struct TY53079 {
NI H;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY98002 {
  TNimObject Sup;
};
struct TY53107 {
NI Tos;
TY53109* Stack;
};
struct TY49898 {
NI Counter;
NI Max;
TY49894* Head;
TY49896* Data;
};
struct TY37019 {
TNimType* m_type;
TY37013* Head;
TY37013* Tail;
NI Counter;
};
typedef N_NIMCALL_PTR(TY49523*, TY100032) (TY100012* C_100033, TY49523* N_100034);
typedef N_NIMCALL_PTR(TY49523*, TY100037) (TY100012* C_100038, TY49523* N_100039);
struct TY100012 {
  TY98002 Sup;
TY49545* Module;
TY100006* P;
NI Instcounter;
TY49523* Generics;
NI Lastgenericidx;
TY53107 Tab;
TY49898 Ambiguoussymbols;
TY49525* Converters;
TY37019 Optionstack;
TY37019 Libs;
NIM_BOOL Fromcache;
TY100032 Semconstexpr;
TY100037 Semexpr;
TY49898 Includedfiles;
NimStringDesc* Filename;
TY49527 Userpragmas;
};
struct TY49549 {
  TY48005 Sup;
NU8 Kind;
TY49547* Sons;
TY49523* N;
NU8 Flags;
NU8 Callconv;
TY49545* Owner;
TY49545* Sym;
NI64 Size;
NI Align;
NI Containerid;
TY49537 Loc;
};
struct TY53092 {
NI H;
TY48011* Name;
};
struct TY10202 {
NI Refcount;
TNimType* Typ;
};
struct TY10218 {
NI Len;
NI Cap;
TY10202** D;
};
struct TY10214 {
NI Counter;
NI Max;
TY10210* Head;
TY10210** Data;
};
struct TY10588 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10590 {
TY10218 Zct;
TY10218 Decstack;
TY10214 Cycleroots;
TY10218 Tempstack;
TY10588 Stat;
};
struct TY46008 {
  TNimObject Sup;
TY46008* Left;
TY46008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY37013 {
  TNimObject Sup;
TY37013* Prev;
TY37013* Next;
};
struct TY49541 {
  TY37013 Sup;
NU8 Kind;
NIM_BOOL Generated;
TY46008* Name;
TY49523* Path;
};
struct TY100006 {
TY49545* Owner;
TY49545* Resultsym;
NI Nestedloopcounter;
NI Nestedblockcounter;
};
typedef NI TY8214[8];
struct TY49894 {
TY49894* Next;
NI Key;
TY8214 Bits;
};
struct TY10210 {
TY10210* Next;
NI Key;
TY8214 Bits;
};
struct TY49517 {
  TGenericSeq Sup;
  TY49523* data[SEQ_DECL_SIZE];
};
struct TY49525 {
  TGenericSeq Sup;
  TY49545* data[SEQ_DECL_SIZE];
};
struct TY53109 {
  TGenericSeq Sup;
  TY49527 data[SEQ_DECL_SIZE];
};
struct TY49896 {
  TGenericSeq Sup;
  TY49894* data[SEQ_DECL_SIZE];
};
struct TY49547 {
  TGenericSeq Sup;
  TY49549* data[SEQ_DECL_SIZE];
};
N_NIMCALL(NI, Sonslen_49801)(TY49523* N_49803);
N_NIMCALL(NimStringDesc*, Getmodulefile_103013)(TY49523* N_103015);
N_NIMCALL(NimStringDesc*, Findmodule_103016)(TY41532 Info_103018, NimStringDesc* Modulename_103019);
N_NIMCALL(NimStringDesc*, Findfile_40088)(NimStringDesc* F_40090);
N_NIMCALL(NimStringDesc*, nosaddFileExt)(NimStringDesc* Filename_32844, NimStringDesc* Ext_32845);
N_NIMCALL(void, Limessage_41562)(TY41532 Info_41564, NU8 Msg_41565, NimStringDesc* Arg_41566);
N_NIMCALL(NimStringDesc*, nosUnixToNativePath)(NimStringDesc* Path_30256);
N_NIMCALL(void, Internalerror_41567)(TY41532 Info_41569, NimStringDesc* Errmsg_41570);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_16908);
N_NIMCALL(void, Adddecl_101026)(TY100012* C_101028, TY49545* Sym_101029);
N_NIMCALL(void, Importallsymbols_103009)(TY100012* C_103011, TY49545* Frommod_103012);
N_NIMCALL(TY49545*, Inittabiter_53081)(TY53079* Ti_53084, TY49527* Tab_53085);
static N_INLINE(void, appendString)(NimStringDesc* Dest_16992, NimStringDesc* Src_16993);
N_NIMCALL(NimStringDesc*, reprEnum)(NI E_17979, TNimType* Typ_17980);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_16887);
N_NIMCALL(void, Rawimportsymbol_103061)(TY100012* C_103063, TY49545* S_103064);
N_NIMCALL(TY49545*, Strtableget_53069)(TY49527* T_53071, TY48011* Name_53072);
N_NIMCALL(void, Intsetincl_49912)(TY49898* S_49915, NI Key_49916);
N_NIMCALL(void, Strtableadd_53064)(TY49527* T_53067, TY49545* N_53068);
N_NIMCALL(TY49545*, Initidentiter_53095)(TY53092* Ti_53098, TY49527* Tab_53099, TY48011* S_53100);
N_NIMCALL(TY49545*, Nextidentiter_53101)(TY53092* Ti_53104, TY49527* Tab_53105);
N_NIMCALL(void, Addconverter_100058)(TY100012* C_100060, TY49545* Conv_100061);
N_NIMCALL(TY49545*, Nextiter_53086)(TY53079* Ti_53089, TY49527* Tab_53090);
N_NIMCALL(void, Checkminsonslen_100103)(TY49523* N_100105, NI Length_100106);
N_NIMCALL(TY49523*, Newsymnode_49732)(TY49545* Sym_49734);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11416, void* Src_11417);
static N_INLINE(TY10202*, Usrtocell_10622)(void* Usr_10624);
static N_INLINE(void, Rtladdzct_11256)(TY10202* C_11258);
N_NOINLINE(void, Addzct_10611)(TY10218* S_10614, TY10202* C_10615);
N_NIMCALL(void, Importsymbol_103220)(TY100012* C_103222, TY49523* Ident_103223, TY49545* Frommod_103224);
N_NIMCALL(void, Loadstub_86070)(TY49545* S_86072);
STRING_LITERAL(TMP191190, "nim", 3);
STRING_LITERAL(TMP191191, "getModuleFile()", 15);
STRING_LITERAL(TMP191192, "", 0);
STRING_LITERAL(TMP191193, "importAllSymbols: ", 18);
STRING_LITERAL(TMP191194, "rawImportSymbol", 15);
STRING_LITERAL(TMP191196, "importSymbol", 12);
STRING_LITERAL(TMP191197, "importSymbol: 2", 15);
STRING_LITERAL(TMP191198, "importSymbol: 3", 15);
extern TY98044 Gimportmodule_98047;
extern TNimType* NTI49174; /* TSymKind */
extern TY10590 Gch_10608;
N_NIMCALL(NimStringDesc*, Findmodule_103016)(TY41532 Info_103018, NimStringDesc* Modulename_103019) {
NimStringDesc* Result_103020;
NimStringDesc* LOC1;
Result_103020 = 0;
LOC1 = nosaddFileExt(Modulename_103019, ((NimStringDesc*) &TMP191190));
Result_103020 = Findfile_40088(LOC1);
if (!((Result_103020) && (Result_103020)->Sup.len == 0)) goto LA3;
Limessage_41562(Info_103018, ((NU8) 2), Modulename_103019);
LA3: ;
return Result_103020;
}
N_NIMCALL(NimStringDesc*, Getmodulefile_103013)(TY49523* N_103015) {
NimStringDesc* Result_103024;
NimStringDesc* LOC1;
Result_103024 = 0;
switch ((*N_103015).Kind) {
case ((NU8) 14):
case ((NU8) 15):
case ((NU8) 16):
LOC1 = nosUnixToNativePath((*N_103015).KindU.S3.Strval);
Result_103024 = Findmodule_103016((*N_103015).Info, LOC1);
break;
case ((NU8) 2):
Result_103024 = Findmodule_103016((*N_103015).Info, (*(*N_103015).KindU.S5.Ident).S);
break;
case ((NU8) 3):
Result_103024 = Findmodule_103016((*N_103015).Info, (*(*(*N_103015).KindU.S4.Sym).Name).S);
break;
default:
Internalerror_41567((*N_103015).Info, ((NimStringDesc*) &TMP191191));
Result_103024 = copyString(((NimStringDesc*) &TMP191192));
break;
}
return Result_103024;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_16992, NimStringDesc* Src_16993) {
memcpy(((NCSTRING) (&(*Dest_16992).data[((*Dest_16992).Sup.len)-0])), ((NCSTRING) ((*Src_16993).data)), ((NI32) ((NI64)((NI64)((*Src_16993).Sup.len + 1) * 1))));
(*Dest_16992).Sup.len += (*Src_16993).Sup.len;
}
N_NIMCALL(void, Rawimportsymbol_103061)(TY100012* C_103063, TY49545* S_103064) {
TY49545* Copy_103065;
TY49545* Check_103066;
NIM_BOOL LOC2;
TY49549* Etyp_103103;
NI J_103138;
NI HEX3Atmp_103211;
NI LOC15;
NI Res_103213;
TY49545* E_103163;
TY53092 It_103173;
Copy_103065 = 0;
Copy_103065 = S_103064;
Check_103066 = 0;
Check_103066 = Strtableget_53069(&(*C_103063).Tab.Stack->data[0], (*S_103064).Name);
LOC2 = !((Check_103066 == NIM_NIL));
if (!(LOC2)) goto LA3;
LOC2 = !(((*Check_103066).Sup.Id == (*Copy_103065).Sup.Id));
LA3: ;
if (!LOC2) goto LA4;
if (!!(((269824 &(1<<(((*S_103064).Kind)&31)))!=0))) goto LA7;
Intsetincl_49912(&(*C_103063).Ambiguoussymbols, (*Copy_103065).Sup.Id);
Intsetincl_49912(&(*C_103063).Ambiguoussymbols, (*Check_103066).Sup.Id);
LA7: ;
LA4: ;
Strtableadd_53064(&(*C_103063).Tab.Stack->data[0], Copy_103065);
if (!((*S_103064).Kind == ((NU8) 6))) goto LA10;
Etyp_103103 = 0;
Etyp_103103 = (*S_103064).Typ;
if (!((16386 &(IL64(1)<<(((*Etyp_103103).Kind)&IL64(63))))!=0)) goto LA13;
J_103138 = 0;
HEX3Atmp_103211 = 0;
LOC15 = Sonslen_49801((*Etyp_103103).N);
HEX3Atmp_103211 = (NI64)(LOC15 - 1);
Res_103213 = 0;
Res_103213 = 0;
while (1) {
if (!(Res_103213 <= HEX3Atmp_103211)) goto LA16;
J_103138 = Res_103213;
E_103163 = 0;
E_103163 = (*(*(*Etyp_103103).N).KindU.S6.Sons->data[J_103138]).KindU.S4.Sym;
if (!!(((*E_103163).Kind == ((NU8) 16)))) goto LA18;
Internalerror_41567((*S_103064).Info, ((NimStringDesc*) &TMP191194));
LA18: ;
memset((void*)&It_103173, 0, sizeof(It_103173));
Check_103066 = Initidentiter_53095(&It_103173, &(*C_103063).Tab.Stack->data[0], (*E_103163).Name);
while (1) {
if (!!((Check_103066 == NIM_NIL))) goto LA20;
if (!((*Check_103066).Sup.Id == (*E_103163).Sup.Id)) goto LA22;
E_103163 = NIM_NIL;
goto LA20;
LA22: ;
Check_103066 = Nextidentiter_53101(&It_103173, &(*C_103063).Tab.Stack->data[0]);
} LA20: ;
if (!!((E_103163 == NIM_NIL))) goto LA25;
Rawimportsymbol_103061(C_103063, E_103163);
LA25: ;
Res_103213 += 1;
} LA16: ;
LA13: ;
goto LA9;
LA10: ;
if (!((*S_103064).Kind == ((NU8) 12))) goto LA27;
Addconverter_100058(C_103063, S_103064);
goto LA9;
LA27: ;
LA9: ;
}
N_NIMCALL(void, Importallsymbols_103009)(TY100012* C_103011, TY49545* Frommod_103012) {
TY53079 I_103312;
TY49545* S_103314;
NimStringDesc* LOC11;
memset((void*)&I_103312, 0, sizeof(I_103312));
S_103314 = 0;
S_103314 = Inittabiter_53081(&I_103312, &(*Frommod_103012).Tab);
while (1) {
if (!!((S_103314 == NIM_NIL))) goto LA1;
if (!!(((*S_103314).Kind == ((NU8) 18)))) goto LA3;
if (!!(((*S_103314).Kind == ((NU8) 16)))) goto LA6;
if (!!(((1081280 &(1<<(((*S_103314).Kind)&31)))!=0))) goto LA9;
LOC11 = rawNewString(reprEnum((*S_103314).Kind, NTI49174)->Sup.len + 18);
appendString(LOC11, ((NimStringDesc*) &TMP191193));
appendString(LOC11, reprEnum((*S_103314).Kind, NTI49174));
Internalerror_41567((*S_103314).Info, LOC11);
LA9: ;
Rawimportsymbol_103061(C_103011, S_103314);
LA6: ;
LA3: ;
S_103314 = Nextiter_53086(&I_103312, &(*Frommod_103012).Tab);
} LA1: ;
}
N_NIMCALL(TY49523*, Evalimport_103001)(TY100012* C_103003, TY49523* N_103004) {
TY49523* Result_103377;
NI I_103385;
NI HEX3Atmp_103424;
NI LOC1;
NI Res_103426;
NimStringDesc* F_103398;
TY49545* M_103399;
Result_103377 = 0;
Result_103377 = N_103004;
I_103385 = 0;
HEX3Atmp_103424 = 0;
LOC1 = Sonslen_49801(N_103004);
HEX3Atmp_103424 = (NI64)(LOC1 - 1);
Res_103426 = 0;
Res_103426 = 0;
while (1) {
if (!(Res_103426 <= HEX3Atmp_103424)) goto LA2;
I_103385 = Res_103426;
F_103398 = 0;
F_103398 = Getmodulefile_103013((*N_103004).KindU.S6.Sons->data[I_103385]);
M_103399 = 0;
M_103399 = Gimportmodule_98047(F_103398);
if (!(((*M_103399).Flags &(1<<((((NU8) 22))&31)))!=0)) goto LA4;
Limessage_41562((*(*N_103004).KindU.S6.Sons->data[I_103385]).Info, ((NU8) 213), (*(*M_103399).Name).S);
LA4: ;
Adddecl_101026(C_103003, M_103399);
Importallsymbols_103009(C_103003, M_103399);
Res_103426 += 1;
} LA2: ;
return Result_103377;
}
static N_INLINE(TY10202*, Usrtocell_10622)(void* Usr_10624) {
TY10202* Result_10625;
Result_10625 = 0;
Result_10625 = ((TY10202*) ((NI64)((NU64)(((NI) (Usr_10624))) - (NU64)(((NI) (((NI)sizeof(TY10202))))))));
return Result_10625;
}
static N_INLINE(void, Rtladdzct_11256)(TY10202* C_11258) {
Addzct_10611(&Gch_10608.Zct, C_11258);
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11416, void* Src_11417) {
TY10202* C_11418;
TY10202* C_11419;
if (!!((Src_11417 == NIM_NIL))) goto LA2;
C_11418 = 0;
C_11418 = Usrtocell_10622(Src_11417);
(*C_11418).Refcount = (NI64)((NU64)((*C_11418).Refcount) + (NU64)(8));
LA2: ;
if (!!(((*Dest_11416) == NIM_NIL))) goto LA5;
C_11419 = 0;
C_11419 = Usrtocell_10622((*Dest_11416));
(*C_11419).Refcount = (NI64)((NU64)((*C_11419).Refcount) - (NU64)(8));
if (!((NU64)((*C_11419).Refcount) < (NU64)(8))) goto LA8;
Rtladdzct_11256(C_11419);
LA8: ;
LA5: ;
(*Dest_11416) = Src_11417;
}
N_NIMCALL(void, Importsymbol_103220)(TY100012* C_103222, TY49523* Ident_103223, TY49545* Frommod_103224) {
TY49545* S_103246;
TY53092 It_103290;
TY49545* E_103292;
if (!!(((*Ident_103223).Kind == ((NU8) 2)))) goto LA2;
Internalerror_41567((*Ident_103223).Info, ((NimStringDesc*) &TMP191196));
LA2: ;
S_103246 = 0;
S_103246 = Strtableget_53069(&(*Frommod_103224).Tab, (*Ident_103223).KindU.S5.Ident);
if (!(S_103246 == NIM_NIL)) goto LA5;
Limessage_41562((*Ident_103223).Info, ((NU8) 58), (*(*Ident_103223).KindU.S5.Ident).S);
LA5: ;
if (!((*S_103246).Kind == ((NU8) 20))) goto LA8;
Loadstub_86070(S_103246);
LA8: ;
if (!!(((1081280 &(1<<(((*S_103246).Kind)&31)))!=0))) goto LA11;
Internalerror_41567((*Ident_103223).Info, ((NimStringDesc*) &TMP191197));
LA11: ;
switch ((*S_103246).Kind) {
case ((NU8) 9):
case ((NU8) 10):
case ((NU8) 11):
case ((NU8) 13):
case ((NU8) 14):
case ((NU8) 12):
memset((void*)&It_103290, 0, sizeof(It_103290));
E_103292 = 0;
E_103292 = Initidentiter_53095(&It_103290, &(*Frommod_103224).Tab, (*S_103246).Name);
while (1) {
if (!!((E_103292 == NIM_NIL))) goto LA13;
if (!!(((*(*E_103292).Name).Sup.Id == (*(*S_103246).Name).Sup.Id))) goto LA15;
Internalerror_41567((*Ident_103223).Info, ((NimStringDesc*) &TMP191198));
LA15: ;
Rawimportsymbol_103061(C_103222, E_103292);
E_103292 = Nextidentiter_53101(&It_103290, &(*Frommod_103224).Tab);
} LA13: ;
break;
default:
Rawimportsymbol_103061(C_103222, S_103246);
break;
}
}
N_NIMCALL(TY49523*, Evalfrom_103005)(TY100012* C_103007, TY49523* N_103008) {
TY49523* Result_103433;
NimStringDesc* F_103446;
TY49545* M_103447;
NI I_103467;
NI HEX3Atmp_103481;
NI LOC1;
NI Res_103483;
Result_103433 = 0;
Result_103433 = N_103008;
Checkminsonslen_100103(N_103008, 2);
F_103446 = 0;
F_103446 = Getmodulefile_103013((*N_103008).KindU.S6.Sons->data[0]);
M_103447 = 0;
M_103447 = Gimportmodule_98047(F_103446);
asgnRefNoCycle((void**) &(*N_103008).KindU.S6.Sons->data[0], Newsymnode_49732(M_103447));
Adddecl_101026(C_103007, M_103447);
I_103467 = 0;
HEX3Atmp_103481 = 0;
LOC1 = Sonslen_49801(N_103008);
HEX3Atmp_103481 = (NI64)(LOC1 - 1);
Res_103483 = 0;
Res_103483 = 1;
while (1) {
if (!(Res_103483 <= HEX3Atmp_103481)) goto LA2;
I_103467 = Res_103483;
Importsymbol_103220(C_103007, (*N_103008).KindU.S6.Sons->data[I_103467], M_103447);
Res_103483 += 1;
} LA2: ;
return Result_103433;
}
N_NOINLINE(void, importerInit)(void) {
}

