/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct TY70015 TY70015;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY69013 TY69013;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef NU8 TY20402[32];
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY70015 {
  TNimObject Sup;
NI Bufpos;
NCSTRING Buf;
NI Buflen;
TY69013* Stream;
NI Linenumber;
NI Sentinel;
NI Linestart;
};
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY69013 {
  TNimObject Sup;
NU8 Kind;
FILE* F;
NimStringDesc* S;
NI Rd;
NI Wr;
};
N_NIMCALL(void, Closebaselexer_70029)(TY70015* L_70032);
N_NOCONV(void, Dealloc_1784)(void* P_1786);
N_NIMCALL(void, Llstreamclose_69040)(TY69013* S_69042);
N_NIMCALL(void, Fillbuffer_70056)(TY70015* L_70059);
N_NIMCALL(void, internalAssert)(NCSTRING File_5054, NI Line_5055, NIM_BOOL Cond_5056);
static N_INLINE(NI, subInt)(NI A_5803, NI B_5804);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(NI, addInt)(NI A_5603, NI B_5604);
N_NIMCALL(NI, mulInt)(NI A_6603, NI B_6604);
N_NIMCALL(NI, Llstreamread_69043)(TY69013* S_69045, void* Buf_69046, NI Buflen_69047);
static N_INLINE(NI, divInt)(NI A_6203, NI B_6204);
N_NOINLINE(void, raiseDivByZero)(void);
N_NOCONV(void*, Realloc_1780)(void* P_1782, NI Newsize_1783);
N_NIMCALL(NI, Fillbaselexer_70122)(TY70015* L_70125, NI Pos_70126);
N_NIMCALL(NI, Handlecr_70041)(TY70015* L_70044, NI Pos_70045);
N_NIMCALL(NI, Handlelf_70046)(TY70015* L_70049, NI Pos_70050);
N_NIMCALL(void, Skiputf8bom_70174)(TY70015* L_70177);
N_NIMCALL(void, Openbaselexer_70023)(TY70015* L_70026, TY69013* Inputstream_70027, NI Buflen_70028);
N_NOCONV(void*, Alloc_1774)(NI Size_1776);
N_NIMCALL(void, unsureAsgnRef)(void** Dest_11626, void* Src_11627);
N_NIMCALL(NI, Getcolnumber_70037)(TY70015* L_70039, NI Pos_70040);
N_NIMCALL(NimStringDesc*, Getcurrentline_70033)(TY70015* L_70035, NIM_BOOL Marker_70036);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_17108);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* S_1603, NIM_CHAR C_1604);
static N_INLINE(void, appendString)(NimStringDesc* Dest_17192, NimStringDesc* Src_17193);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_17087);
N_NIMCALL(NimStringDesc*, nsuRepeatChar)(NI Count_23750, NIM_CHAR C_23751);
NIM_CONST TY20402 Newlines_70012 = {
0x00, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP70280, "", 0);
STRING_LITERAL(TMP70281, "\015\012", 2);
STRING_LITERAL(TMP70282, "^\015\012", 3);
N_NIMCALL(void, Closebaselexer_70029)(TY70015* L_70032) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "closeBaseLexer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 71;F.filename = "lexbase.nim";
Dealloc_1784(((void*) ((*L_70032).Buf)));
F.line = 72;F.filename = "lexbase.nim";
Llstreamclose_69040((*L_70032).Stream);
framePtr = framePtr->prev;
}
static N_INLINE(NI, subInt)(NI A_5803, NI B_5804) {
NI Result_5805;
NIM_BOOL LOC2;
Result_5805 = 0;
Result_5805 = (NI64)((NU64)(A_5803) - (NU64)(B_5804));
LOC2 = (0 <= (NI64)(Result_5805 ^ A_5803));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5805 ^ (NI64)((NU64) ~(B_5804))));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5805;
}
static N_INLINE(NI, addInt)(NI A_5603, NI B_5604) {
NI Result_5605;
NIM_BOOL LOC2;
Result_5605 = 0;
Result_5605 = (NI64)((NU64)(A_5603) + (NU64)(B_5604));
LOC2 = (0 <= (NI64)(Result_5605 ^ A_5603));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5605 ^ B_5604));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5605;
}
static N_INLINE(NI, divInt)(NI A_6203, NI B_6204) {
NI Result_6205;
NIM_BOOL LOC5;
Result_6205 = 0;
if (!(B_6204 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
LOC5 = (A_6203 == (IL64(-9223372036854775807) - IL64(1)));
if (!(LOC5)) goto LA6;
LOC5 = (B_6204 == -1);
LA6: ;
if (!LOC5) goto LA7;
raiseOverflow();
LA7: ;
Result_6205 = (NI64)(A_6203 / B_6204);
goto BeforeRet;
BeforeRet: ;
return Result_6205;
}
N_NIMCALL(void, Fillbuffer_70056)(TY70015* L_70059) {
NI Charsread_70060;
NI Tocopy_70061;
NI S_70062;
NI Oldbuflen_70063;
NI LOC4;
NIM_BOOL LOC10;
void* LOC15;
NI LOC16;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "FillBuffer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Charsread_70060 = 0;
Tocopy_70061 = 0;
S_70062 = 0;
Oldbuflen_70063 = 0;
F.line = 82;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 82, ((*L_70059).Sentinel < (*L_70059).Buflen));
F.line = 83;F.filename = "lexbase.nim";
Tocopy_70061 = subInt(subInt((*L_70059).Buflen, (*L_70059).Sentinel), 1);
F.line = 84;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 84, (0 <= Tocopy_70061));
F.line = 85;F.filename = "lexbase.nim";
if (!(0 < Tocopy_70061)) goto LA2;
F.line = 86;F.filename = "lexbase.nim";
memmove(((void*) ((*L_70059).Buf)), ((void*) (&(*L_70059).Buf[addInt((*L_70059).Sentinel, 1)])), mulInt(Tocopy_70061, 1));
LA2: ;
F.line = 88;F.filename = "lexbase.nim";
LOC4 = Llstreamread_69043((*L_70059).Stream, ((void*) (&(*L_70059).Buf[Tocopy_70061])), mulInt(addInt((*L_70059).Sentinel, 1), 1));
Charsread_70060 = divInt(LOC4, 1);
F.line = 90;F.filename = "lexbase.nim";
S_70062 = addInt(Tocopy_70061, Charsread_70060);
F.line = 91;F.filename = "lexbase.nim";
if (!(Charsread_70060 < addInt((*L_70059).Sentinel, 1))) goto LA6;
F.line = 92;F.filename = "lexbase.nim";
(*L_70059).Buf[S_70062] = 0;
F.line = 93;F.filename = "lexbase.nim";
(*L_70059).Sentinel = S_70062;
goto LA5;
LA6: ;
F.line = 96;F.filename = "lexbase.nim";
S_70062 = subInt(S_70062, 1);
F.line = 97;F.filename = "lexbase.nim";
while (1) {
F.line = 98;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 98, (S_70062 < (*L_70059).Buflen));
F.line = 99;F.filename = "lexbase.nim";
while (1) {
LOC10 = (0 <= S_70062);
if (!(LOC10)) goto LA11;
LOC10 = !((((NU8)((*L_70059).Buf[S_70062])) == ((NU8)(13)) || ((NU8)((*L_70059).Buf[S_70062])) == ((NU8)(10))));
LA11: ;
if (!LOC10) goto LA9;
F.line = 99;F.filename = "lexbase.nim";
S_70062 = subInt(S_70062, 1);
} LA9: ;
F.line = 100;F.filename = "lexbase.nim";
if (!(0 <= S_70062)) goto LA13;
F.line = 102;F.filename = "lexbase.nim";
(*L_70059).Sentinel = S_70062;
F.line = 103;F.filename = "lexbase.nim";
goto LA8;
goto LA12;
LA13: ;
F.line = 107;F.filename = "lexbase.nim";
Oldbuflen_70063 = (*L_70059).Buflen;
F.line = 108;F.filename = "lexbase.nim";
(*L_70059).Buflen = mulInt((*L_70059).Buflen, 2);
F.line = 109;F.filename = "lexbase.nim";
LOC15 = Realloc_1780(((void*) ((*L_70059).Buf)), mulInt((*L_70059).Buflen, 1));
(*L_70059).Buf = ((NCSTRING) (LOC15));
F.line = 110;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 110, (subInt((*L_70059).Buflen, Oldbuflen_70063) == Oldbuflen_70063));
F.line = 111;F.filename = "lexbase.nim";
LOC16 = Llstreamread_69043((*L_70059).Stream, ((void*) (&(*L_70059).Buf[Oldbuflen_70063])), mulInt(Oldbuflen_70063, 1));
Charsread_70060 = divInt(LOC16, 1);
F.line = 113;F.filename = "lexbase.nim";
if (!(Charsread_70060 < Oldbuflen_70063)) goto LA18;
F.line = 114;F.filename = "lexbase.nim";
(*L_70059).Buf[addInt(Oldbuflen_70063, Charsread_70060)] = 0;
F.line = 115;F.filename = "lexbase.nim";
(*L_70059).Sentinel = addInt(Oldbuflen_70063, Charsread_70060);
F.line = 116;F.filename = "lexbase.nim";
goto LA8;
LA18: ;
F.line = 117;F.filename = "lexbase.nim";
S_70062 = subInt((*L_70059).Buflen, 1);
LA12: ;
} LA8: ;
LA5: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NI, Fillbaselexer_70122)(TY70015* L_70125, NI Pos_70126) {
NI Result_70127;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "fillBaseLexer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_70127 = 0;
F.line = 120;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 120, (Pos_70126 <= (*L_70125).Sentinel));
F.line = 121;F.filename = "lexbase.nim";
if (!(Pos_70126 < (*L_70125).Sentinel)) goto LA2;
F.line = 122;F.filename = "lexbase.nim";
Result_70127 = addInt(Pos_70126, 1);
goto LA1;
LA2: ;
F.line = 124;F.filename = "lexbase.nim";
Fillbuffer_70056(L_70125);
F.line = 125;F.filename = "lexbase.nim";
(*L_70125).Bufpos = 0;
F.line = 126;F.filename = "lexbase.nim";
Result_70127 = 0;
LA1: ;
F.line = 127;F.filename = "lexbase.nim";
(*L_70125).Linestart = Result_70127;
framePtr = framePtr->prev;
return Result_70127;
}
N_NIMCALL(NI, Handlecr_70041)(TY70015* L_70044, NI Pos_70045) {
NI Result_70137;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "HandleCR";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_70137 = 0;
F.line = 130;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 130, ((NU8)((*L_70044).Buf[Pos_70045]) == (NU8)(13)));
F.line = 131;F.filename = "lexbase.nim";
(*L_70044).Linenumber = addInt((*L_70044).Linenumber, 1);
F.line = 132;F.filename = "lexbase.nim";
Result_70137 = Fillbaselexer_70122(L_70044, Pos_70045);
F.line = 133;F.filename = "lexbase.nim";
if (!((NU8)((*L_70044).Buf[Result_70137]) == (NU8)(10))) goto LA2;
F.line = 134;F.filename = "lexbase.nim";
Result_70137 = Fillbaselexer_70122(L_70044, Result_70137);
LA2: ;
framePtr = framePtr->prev;
return Result_70137;
}
N_NIMCALL(NI, Handlelf_70046)(TY70015* L_70049, NI Pos_70050) {
NI Result_70159;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "HandleLF";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_70159 = 0;
F.line = 137;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 137, ((NU8)((*L_70049).Buf[Pos_70050]) == (NU8)(10)));
F.line = 138;F.filename = "lexbase.nim";
(*L_70049).Linenumber = addInt((*L_70049).Linenumber, 1);
F.line = 139;F.filename = "lexbase.nim";
Result_70159 = Fillbaselexer_70122(L_70049, Pos_70050);
framePtr = framePtr->prev;
return Result_70159;
}
N_NIMCALL(void, Skiputf8bom_70174)(TY70015* L_70177) {
NIM_BOOL LOC2;
NIM_BOOL LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "skip_UTF_8_BOM";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 142;F.filename = "lexbase.nim";
LOC3 = ((NU8)((*L_70177).Buf[0]) == (NU8)(239));
if (!(LOC3)) goto LA4;
LOC3 = ((NU8)((*L_70177).Buf[1]) == (NU8)(187));
LA4: ;
LOC2 = LOC3;
if (!(LOC2)) goto LA5;
LOC2 = ((NU8)((*L_70177).Buf[2]) == (NU8)(191));
LA5: ;
if (!LOC2) goto LA6;
F.line = 143;F.filename = "lexbase.nim";
(*L_70177).Bufpos = addInt((*L_70177).Bufpos, 3);
F.line = 144;F.filename = "lexbase.nim";
(*L_70177).Linestart = addInt((*L_70177).Linestart, 3);
LA6: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, Openbaselexer_70023)(TY70015* L_70026, TY69013* Inputstream_70027, NI Buflen_70028) {
void* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "openBaseLexer";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 147;F.filename = "lexbase.nim";
internalAssert("rod/lexbase.nim", 147, (0 < Buflen_70028));
F.line = 148;F.filename = "lexbase.nim";
(*L_70026).Bufpos = 0;
F.line = 149;F.filename = "lexbase.nim";
(*L_70026).Buflen = Buflen_70028;
F.line = 150;F.filename = "lexbase.nim";
LOC1 = Alloc_1774(mulInt(Buflen_70028, 1));
(*L_70026).Buf = ((NCSTRING) (LOC1));
F.line = 151;F.filename = "lexbase.nim";
(*L_70026).Sentinel = subInt(Buflen_70028, 1);
F.line = 152;F.filename = "lexbase.nim";
(*L_70026).Linestart = 0;
F.line = 153;F.filename = "lexbase.nim";
(*L_70026).Linenumber = 1;
F.line = 154;F.filename = "lexbase.nim";
unsureAsgnRef((void**) &(*L_70026).Stream, Inputstream_70027);
F.line = 155;F.filename = "lexbase.nim";
Fillbuffer_70056(L_70026);
F.line = 156;F.filename = "lexbase.nim";
Skiputf8bom_70174(L_70026);
framePtr = framePtr->prev;
}
N_NIMCALL(NI, Getcolnumber_70037)(TY70015* L_70039, NI Pos_70040) {
NI Result_70220;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getColNumber";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_70220 = 0;
F.line = 159;F.filename = "lexbase.nim";
if (subInt(Pos_70040, (*L_70039).Linestart) == (IL64(-9223372036854775807) - IL64(1))) raiseOverflow();
Result_70220 = (NI64)abs(subInt(Pos_70040, (*L_70039).Linestart));
framePtr = framePtr->prev;
return Result_70220;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_17192, NimStringDesc* Src_17193) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendString";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 150;F.filename = "sysstr.nim";
memcpy(((NCSTRING) (&(*Dest_17192).data[((*Dest_17192).Sup.len)-0])), ((NCSTRING) ((*Src_17193).data)), ((NI32) ((NI64)((NI64)((*Src_17193).Sup.len + 1) * 1))));
F.line = 151;F.filename = "sysstr.nim";
(*Dest_17192).Sup.len += (*Src_17193).Sup.len;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, Getcurrentline_70033)(TY70015* L_70035, NIM_BOOL Marker_70036) {
NimStringDesc* Result_70225;
NI I_70226;
NimStringDesc* LOC2;
NimStringDesc* LOC6;
NI LOC7;
NimStringDesc* LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getCurrentLine";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_70225 = 0;
F.line = 162;F.filename = "lexbase.nim";
Result_70225 = copyString(((NimStringDesc*) &TMP70280));
I_70226 = 0;
F.line = 163;F.filename = "lexbase.nim";
I_70226 = (*L_70035).Linestart;
F.line = 164;F.filename = "lexbase.nim";
while (1) {
if (!!((((NU8)((*L_70035).Buf[I_70226])) == ((NU8)(13)) || ((NU8)((*L_70035).Buf[I_70226])) == ((NU8)(10)) || ((NU8)((*L_70035).Buf[I_70226])) == ((NU8)(0))))) goto LA1;
F.line = 165;F.filename = "lexbase.nim";
Result_70225 = addChar(Result_70225, (*L_70035).Buf[I_70226]);
F.line = 166;F.filename = "lexbase.nim";
I_70226 = addInt(I_70226, 1);
} LA1: ;
F.line = 167;F.filename = "lexbase.nim";
LOC2 = 0;
LOC2 = rawNewString(Result_70225->Sup.len + 2);
appendString(LOC2, Result_70225);
appendString(LOC2, ((NimStringDesc*) &TMP70281));
Result_70225 = LOC2;
F.line = 168;F.filename = "lexbase.nim";
if (!Marker_70036) goto LA4;
F.line = 169;F.filename = "lexbase.nim";
LOC6 = 0;
LOC7 = Getcolnumber_70037(L_70035, (*L_70035).Bufpos);
LOC8 = 0;
LOC8 = nsuRepeatChar(LOC7, 32);
LOC6 = rawNewString(Result_70225->Sup.len + LOC8->Sup.len + 3);
appendString(LOC6, Result_70225);
appendString(LOC6, LOC8);
appendString(LOC6, ((NimStringDesc*) &TMP70282));
Result_70225 = LOC6;
LA4: ;
framePtr = framePtr->prev;
return Result_70225;
}
N_NOINLINE(void, lexbaseInit)(void) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "lexbase";
F.prev = framePtr;
F.filename = "rod/lexbase.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
framePtr = framePtr->prev;
}

