/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY61202 TY61202;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY4377 TY4377;
typedef struct TY10402 TY10402;
typedef struct TY7804 TY7804;
typedef struct TY10790 TY10790;
typedef struct TY10418 TY10418;
typedef struct TY10414 TY10414;
typedef struct TY10410 TY10410;
typedef struct TY10788 TY10788;
typedef struct TY61701 TY61701;
typedef struct TY60027 TY60027;
typedef struct TY62204 TY62204;
typedef struct TY59408 TY59408;
typedef struct TY39006 TY39006;
typedef struct TY39004 TY39004;
typedef struct TY26432 TY26432;
typedef struct TY26434 TY26434;
typedef struct TY26436 TY26436;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY61202 {
  TNimObject Sup;
NI Fprocesshandle;
NI32 Inputhandle;
NI32 Outputhandle;
NI32 Errorhandle;
NI32 Id;
NI32 Exitcode;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY10402 {
NI Refcount;
TNimType* Typ;
};
typedef N_STDCALL_PTR(void, TY7816) (TY7804* L_7818);
struct TY10418 {
NI Len;
NI Cap;
TY10402** D;
};
struct TY10414 {
NI Counter;
NI Max;
TY10410* Head;
TY10410** Data;
};
struct TY7804 {
void* Debuginfo;
NI32 Lockcount;
NI32 Recursioncount;
NI Owningthread;
NI Locksemaphore;
NI32 Reserved;
};
struct TY10788 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10790 {
TY10418 Zct;
TY10418 Decstack;
TY10414 Cycleroots;
TY10418 Tempstack;
TY7804 Cyclerootslock;
TY7804 Zctlock;
TY10788 Stat;
};
typedef N_STDCALL_PTR(void, TY7820) (TY7804* L_7822);
typedef N_NIMCALL_PTR(void, TY60028) (TY60027* S_60029);
typedef N_NIMCALL_PTR(NIM_BOOL, TY60032) (TY60027* S_60033);
typedef N_NIMCALL_PTR(void, TY60036) (TY60027* S_60037, NI Pos_60038);
typedef N_NIMCALL_PTR(NI, TY60041) (TY60027* S_60042);
typedef N_NIMCALL_PTR(NI, TY60045) (TY60027* S_60046, void* Buffer_60047, NI Buflen_60048);
typedef N_NIMCALL_PTR(void, TY60051) (TY60027* S_60052, void* Buffer_60053, NI Buflen_60054);
struct TY60027 {
  TNimObject Sup;
TY60028 Close;
TY60032 Atend;
TY60036 Setposition;
TY60041 Getposition;
TY60045 Readdata;
TY60051 Writedata;
};
struct TY62204 {
  TY60027 Sup;
NI Handle;
NIM_BOOL Attheend;
};
typedef N_STDCALL_PTR(NI32, TY26482) (NI Hfile_26483, void* Buffer_26484, NI32 Nnumberofbytestoread_26485, NI32* Lpnumberofbytesread_26487, void* Lpoverlapped_26488);
typedef N_STDCALL_PTR(NI32, TY26490) (NI Hfile_26491, void* Buffer_26492, NI32 Nnumberofbytestowrite_26493, NI32* Lpnumberofbyteswritten_26495, void* Lpoverlapped_26496);
struct TY39004 {
NimStringDesc* Key;
NimStringDesc* Val;
};
struct TY59408 {
  TNimObject Sup;
NI Counter;
TY39006* Data;
NU8 Mode;
};
struct TY26432 {
NI32 Nlength;
void* Lpsecuritydescriptor;
NI32 Binherithandle;
};
typedef N_STDCALL_PTR(NI32, TY26498) (NI* Hreadpipe_26500, NI* Hwritepipe_26501, TY26432* Lppipeattributes_26503, NI32 Nsize_26504);
typedef N_STDCALL_PTR(NI32, TY26476) (NI Hobject_26477);
struct TY26434 {
NI32 Cb;
NCSTRING Lpreserved;
NCSTRING Lpdesktop;
NCSTRING Lptitle;
NI32 Dwx;
NI32 Dwy;
NI32 Dwxsize;
NI32 Dwysize;
NI32 Dwxcountchars;
NI32 Dwycountchars;
NI32 Dwfillattribute;
NI32 Dwflags;
NI16 Wshowwindow;
NI16 Cbreserved2;
void* Lpreserved2;
NI Hstdinput;
NI Hstdoutput;
NI Hstderror;
};
struct TY26436 {
NI Hprocess;
NI Hthread;
NI32 Dwprocessid;
NI32 Dwthreadid;
};
typedef N_STDCALL_PTR(NI, TY26541) (NI32 Nstdhandle_26542);
typedef NimStringDesc* TY62426[2];
typedef N_STDCALL_PTR(NI32, TY26506) (NCSTRING Lpapplicationname_26507, NCSTRING Lpcommandline_26508, TY26432* Lpprocessattributes_26510, TY26432* Lpthreadattributes_26512, NI32 Binherithandles_26513, NI32 Dwcreationflags_26514, void* Lpenvironment_26515, NCSTRING Lpcurrentdirectory_26516, TY26434* Lpstartupinfo_26518, TY26436* Lpprocessinformation_26520);
typedef N_STDCALL_PTR(NI32, TY26522) (NI Hthread_26523);
typedef N_STDCALL_PTR(NI32, TY26525) (NI Hthread_26526);
typedef N_STDCALL_PTR(NI32, TY26528) (NI Hhandle_26529, NI32 Dwmilliseconds_26530);
typedef N_STDCALL_PTR(NI32, TY26532) (NI Hprocess_26533, NI Uexitcode_26534);
typedef N_STDCALL_PTR(NI32, TY26536) (NI Hprocess_26537, NI32* Lpexitcode_26539);
typedef NI TY8414[8];
struct TY10410 {
TY10410* Next;
NI Key;
TY8414 Bits;
};
struct TY4377 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
struct TY61701 {
  TGenericSeq Sup;
  TY61202* data[SEQ_DECL_SIZE];
};
struct TY39006 {
  TGenericSeq Sup;
  TY39004 data[SEQ_DECL_SIZE];
};
N_NIMCALL(NimStringDesc*, Executeprocess_61223)(NimStringDesc* Command_61225, NU8 Options_61228);
N_NIMCALL(NI, Executecommand_61233)(NimStringDesc* Command_61235);
N_NIMCALL(NI, nospprocessID)(TY61202* P_61264);
N_NIMCALL(NI, nospcountProcessors)(void);
N_NIMCALL(NimStringDesc*, Getenv_33425)(NimStringDesc* Key_33427);
N_NIMCALL(NI, nsuParseInt)(NimStringDesc* S_23504);
N_NIMCALL(TY61202*, Startprocessaux_61606)(NimStringDesc* Cmd_61608, NU8 Options_61610);
N_NIMCALL(TY4377*, nosparseCmdLine)(NimStringDesc* C_34434);
N_NIMCALL(void*, newSeq)(TNimType* Typ_12604, NI Len_12605);
static N_INLINE(NI, subInt)(NI A_5803, NI B_5804);
N_NOINLINE(void, raiseOverflow)(void);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* Seq_17235, NI Elemsize_17236);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11618, void* Src_11619);
static N_INLINE(TY10402*, Usrtocell_10836)(void* Usr_10838);
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005);
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010);
static N_INLINE(void, Rtladdzct_11458)(TY10402* C_11460);
N_NOINLINE(void, Addzct_10825)(TY10418* S_10828, TY10402* C_10829);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_17108);
static N_INLINE(NI, addInt)(NI A_5603, NI B_5604);
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** Cmds_61692, NI Cmds_61692Len0, NU8 Options_61694, NI N_61695);
N_NIMCALL(void, internalAssert)(NCSTRING File_5054, NI Line_5055, NIM_BOOL Cond_5056);
N_NIMCALL(void, nossleep)(NI Milsecs_36206);
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* Command_61219, NU8 Options_61222);
N_NIMCALL(NimStringDesc*, Readline_60210)(TY60027* S_60212);
static N_INLINE(void, appendString)(NimStringDesc* Dest_17192, NimStringDesc* Src_17193);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* Dest_17182, NI Addlen_17183);
N_NIMCALL(void, Hsclose_62207)(TY62204* S_62209);
N_NIMCALL(NIM_BOOL, Hsatend_62210)(TY62204* S_62212);
N_NIMCALL(NI, Hsreaddata_62214)(TY62204* S_62216, void* Buffer_62217, NI Buflen_62218);
static N_INLINE(NI, chckRange)(NI I_4610, NI A_4611, NI B_4612);
N_NOINLINE(void, raiseRangeError)(NI64 Val_5218);
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_30004);
N_NIMCALL(void, Hswritedata_62229)(TY62204* S_62231, void* Buffer_62232, NI Buflen_62233);
N_NIMCALL(TY62204*, Newfilehandlestream_62239)(NI Handle_62241);
N_NIMCALL(void*, newObj)(TNimType* Typ_12107, NI Size_12108);
N_NIMCALL(NCSTRING, Buildcommandline_62258)(NimStringDesc* A_62260, NimStringDesc** Args_62262, NI Args_62262Len0);
N_NIMCALL(NimStringDesc*, Quoteifcontainswhite_24283)(NimStringDesc* S_24285);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* S_1603, NIM_CHAR C_1604);
N_NOCONV(void*, Alloc0_1777)(NI Size_1779);
N_NIMCALL(NCSTRING, Buildenv_62277)(TY59408* Env_62279);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_17087);
N_NIMCALL(void, Createpipehandles_62336)(NI* Rdhandle_62339, NI* Wrhandle_62340);
static N_INLINE(void, Fileclose_62345)(NI H_62347);
N_NIMCALL(TY61202*, nospstartProcess)(NimStringDesc* Command_61239, NimStringDesc* Workingdir_61240, NimStringDesc** Args_61245, NI Args_61245Len0, TY59408* Env_61246, NU8 Options_61249);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING Str_17104);
static N_INLINE(void, rawEcho)(NimStringDesc* X_4094);
N_NIMCALL(void, Write_3658)(FILE* F_3660, NimStringDesc* S_3661);
static N_INLINE(void, rawEchoNL)(void);
N_NOCONV(void, Dealloc_1784)(void* P_1786);
N_NIMCALL(void, nospsuspend)(TY61202* P_61252);
N_NIMCALL(void, nospresume)(TY61202* P_61255);
N_NIMCALL(NIM_BOOL, nosprunning)(TY61202* P_61261);
N_NIMCALL(void, nospterminate)(TY61202* P_61258);
N_NIMCALL(NI, nospwaitForExit)(TY61202* P_61268);
N_NIMCALL(TY60027*, nospinputStream)(TY61202* P_61271);
N_NIMCALL(TY60027*, nospoutputStream)(TY61202* P_61274);
N_NIMCALL(TY60027*, nosperrorStream)(TY61202* P_61277);
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* Command_61232);
N_NIMCALL(TY4377*, HEX26_62435)(NimStringDesc** X_62439, NI X_62439Len0, NimStringDesc** Y_62440, NI Y_62440Len0);
STRING_LITERAL(TMP61603, "NUMBER_OF_PROCESSORS", 20);
STRING_LITERAL(TMP61688, "", 0);
STRING_LITERAL(TMP62002, "\015\012", 2);
STRING_LITERAL(TMP62843, "=", 1);
STRING_LITERAL(TMP62844, "COMSPEC", 7);
STRING_LITERAL(TMP62845, "/c", 2);
extern TNimType* NTI4377; /* seq[string] */
extern TY7816 Dl_7815;
extern TY10790 Gch_10810;
extern TY7820 Dl_7819;
extern TNimType* NTI61701; /* seq[PProcess] */
extern TY26482 Dl_26481;
extern TY26490 Dl_26489;
extern TNimType* NTI62202; /* PFileHandleStream */
extern TNimType* NTI62204; /* TFileHandleStream */
extern TY26498 Dl_26497;
extern TY26476 Dl_26475;
extern TNimType* NTI61204; /* PProcess */
extern TNimType* NTI61202; /* TProcess */
extern TY26541 Dl_26540;
extern TY26506 Dl_26505;
extern TY26522 Dl_26521;
extern TY26525 Dl_26524;
extern TY26528 Dl_26527;
extern TY26532 Dl_26531;
extern TY26536 Dl_26535;
N_NIMCALL(NimStringDesc*, Executeprocess_61223)(NimStringDesc* Command_61225, NU8 Options_61228) {
NimStringDesc* Result_61229;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "executeProcess";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_61229 = 0;
F.line = 54;F.filename = "osproc.nim";
Result_61229 = nospexecProcess(Command_61225, Options_61228);
framePtr = framePtr->prev;
return Result_61229;
}
N_NIMCALL(NI, Executecommand_61233)(NimStringDesc* Command_61235) {
NI Result_61236;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "executeCommand";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_61236 = 0;
F.line = 62;F.filename = "osproc.nim";
Result_61236 = nospexecCmd(Command_61235);
framePtr = framePtr->prev;
return Result_61236;
}
N_NIMCALL(NI, nospprocessID)(TY61202* P_61264) {
NI Result_61265;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "processID";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_61265 = 0;
F.line = 99;F.filename = "osproc.nim";
F.line = 99;F.filename = "osproc.nim";
Result_61265 = ((NI) ((*P_61264).Id));
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_61265;
}
N_NIMCALL(NI, nospcountProcessors)(void) {
NI Result_61403;
NimStringDesc* X_61404;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "countProcessors";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_61403 = 0;
X_61404 = 0;
F.line = 126;F.filename = "osproc.nim";
X_61404 = Getenv_33425(((NimStringDesc*) &TMP61603));
F.line = 127;F.filename = "osproc.nim";
if (!(0 < X_61404->Sup.len)) goto LA2;
F.line = 127;F.filename = "osproc.nim";
Result_61403 = nsuParseInt(X_61404);
LA2: ;
F.line = 147;F.filename = "osproc.nim";
if (!(Result_61403 <= 0)) goto LA5;
F.line = 147;F.filename = "osproc.nim";
Result_61403 = 1;
LA5: ;
framePtr = framePtr->prev;
return Result_61403;
}
static N_INLINE(NI, subInt)(NI A_5803, NI B_5804) {
NI Result_5805;
NIM_BOOL LOC2;
Result_5805 = 0;
Result_5805 = (NI64)((NU64)(A_5803) - (NU64)(B_5804));
LOC2 = (0 <= (NI64)(Result_5805 ^ A_5803));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5805 ^ (NI64)((NU64) ~(B_5804))));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5805;
}
static N_INLINE(TY10402*, Usrtocell_10836)(void* Usr_10838) {
TY10402* Result_10839;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "usrToCell";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_10839 = 0;
F.line = 100;F.filename = "gc.nim";
Result_10839 = ((TY10402*) ((NI64)((NU64)(((NI) (Usr_10838))) - (NU64)(((NI) (((NI)sizeof(TY10402))))))));
framePtr = framePtr->prev;
return Result_10839;
}
static N_INLINE(NI, Atomicinc_3001)(NI* Memloc_3004, NI X_3005) {
NI Result_7208;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicInc";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7208 = 0;
F.line = 29;F.filename = "systhread.nim";
Result_7208 = __sync_add_and_fetch(Memloc_3004, X_3005);
framePtr = framePtr->prev;
return Result_7208;
}
static N_INLINE(NI, Atomicdec_3006)(NI* Memloc_3009, NI X_3010) {
NI Result_7406;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicDec";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7406 = 0;
F.line = 37;F.filename = "systhread.nim";
Result_7406 = __sync_sub_and_fetch(Memloc_3009, X_3010);
framePtr = framePtr->prev;
return Result_7406;
}
static N_INLINE(void, Rtladdzct_11458)(TY10402* C_11460) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rtlAddZCT";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 211;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA2;
F.line = 211;F.filename = "gc.nim";
Dl_7815(&Gch_10810.Zctlock);
LA2: ;
F.line = 212;F.filename = "gc.nim";
Addzct_10825(&Gch_10810.Zct, C_11460);
F.line = 213;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA5;
F.line = 213;F.filename = "gc.nim";
Dl_7819(&Gch_10810.Zctlock);
LA5: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11618, void* Src_11619) {
TY10402* C_11620;
NI LOC4;
TY10402* C_11622;
NI LOC9;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "asgnRefNoCycle";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 244;F.filename = "gc.nim";
if (!!((Src_11619 == NIM_NIL))) goto LA2;
C_11620 = 0;
F.line = 245;F.filename = "gc.nim";
C_11620 = Usrtocell_10836(Src_11619);
F.line = 246;F.filename = "gc.nim";
LOC4 = Atomicinc_3001(&(*C_11620).Refcount, 8);
LA2: ;
F.line = 247;F.filename = "gc.nim";
if (!!(((*Dest_11618) == NIM_NIL))) goto LA6;
C_11622 = 0;
F.line = 248;F.filename = "gc.nim";
C_11622 = Usrtocell_10836((*Dest_11618));
F.line = 249;F.filename = "gc.nim";
LOC9 = Atomicdec_3006(&(*C_11622).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
F.line = 250;F.filename = "gc.nim";
Rtladdzct_11458(C_11622);
LA10: ;
LA6: ;
F.line = 251;F.filename = "gc.nim";
(*Dest_11618) = Src_11619;
framePtr = framePtr->prev;
}
static N_INLINE(NI, addInt)(NI A_5603, NI B_5604) {
NI Result_5605;
NIM_BOOL LOC2;
Result_5605 = 0;
Result_5605 = (NI64)((NU64)(A_5603) + (NU64)(B_5604));
LOC2 = (0 <= (NI64)(Result_5605 ^ A_5603));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5605 ^ B_5604));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5605;
}
N_NIMCALL(TY61202*, Startprocessaux_61606)(NimStringDesc* Cmd_61608, NU8 Options_61610) {
TY61202* Result_61611;
TY4377* C_61612;
TY4377* A_61630;
NI I_61663;
NI HEX3Atmp_61683;
NI Res_61685;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "startProcessAux";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_61611 = 0;
C_61612 = 0;
F.line = 150;F.filename = "osproc.nim";
C_61612 = nosparseCmdLine(Cmd_61608);
A_61630 = 0;
F.line = 151;F.filename = "osproc.nim";
A_61630 = (TY4377*) newSeq(NTI4377, 0);
I_61663 = 0;
HEX3Atmp_61683 = 0;
F.line = 152;F.filename = "osproc.nim";
HEX3Atmp_61683 = subInt(C_61612->Sup.len, 1);
Res_61685 = 0;
F.line = 1011;F.filename = "system.nim";
Res_61685 = 1;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_61685 <= HEX3Atmp_61683)) goto LA1;
F.line = 1011;F.filename = "system.nim";
I_61663 = Res_61685;
F.line = 152;F.filename = "osproc.nim";
if ((NU)(I_61663) >= (NU)(C_61612->Sup.len)) raiseIndexError();
A_61630 = (TY4377*) incrSeq(&(A_61630)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &A_61630->data[A_61630->Sup.len-1], copyString(C_61612->data[I_61663]));
F.line = 1014;F.filename = "system.nim";
Res_61685 = addInt(Res_61685, 1);
} LA1: ;
F.line = 153;F.filename = "osproc.nim";
if ((NU)(0) >= (NU)(C_61612->Sup.len)) raiseIndexError();
Result_61611 = nospstartProcess(C_61612->data[0], ((NimStringDesc*) &TMP61688), A_61630->data, A_61630->Sup.len, NIM_NIL, Options_61610);
framePtr = framePtr->prev;
return Result_61611;
}
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** Cmds_61692, NI Cmds_61692Len0, NU8 Options_61694, NI N_61695) {
NI Result_61696;
TY61701* Q_61702;
NI M_61727;
NI I_61735;
NI HEX3Atmp_61823;
NI Res_61825;
NI I_61736;
NI R_61746;
NI HEX3Atmp_61829;
NI Res_61831;
NIM_BOOL LOC8;
NI LOC11;
NI I_61808;
NI HEX3Atmp_61836;
NI Res_61838;
NI LOC16;
NI I_61818;
NI HEX3Atmp_61842;
NI Res_61844;
TY61202* P_61819;
NI LOC18;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "execProcesses";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_61696 = 0;
F.line = 161;F.filename = "osproc.nim";
internalAssert("/home/andreas/projects/nimrod/lib/pure/osproc.nim", 161, (0 < N_61695));
F.line = 162;F.filename = "osproc.nim";
if (!(1 < N_61695)) goto LA2;
Q_61702 = 0;
F.line = 164;F.filename = "osproc.nim";
Q_61702 = (TY61701*) newSeq(NTI61701, N_61695);
M_61727 = 0;
F.line = 165;F.filename = "osproc.nim";
M_61727 = ((N_61695 <= Cmds_61692Len0) ? N_61695 : Cmds_61692Len0);
I_61735 = 0;
HEX3Atmp_61823 = 0;
F.line = 166;F.filename = "osproc.nim";
HEX3Atmp_61823 = subInt(M_61727, 1);
Res_61825 = 0;
F.line = 1011;F.filename = "system.nim";
Res_61825 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_61825 <= HEX3Atmp_61823)) goto LA4;
F.line = 1011;F.filename = "system.nim";
I_61735 = Res_61825;
F.line = 167;F.filename = "osproc.nim";
if ((NU)(I_61735) >= (NU)(Q_61702->Sup.len)) raiseIndexError();
if ((NU)(I_61735) >= (NU)(Cmds_61692Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Q_61702->data[I_61735], Startprocessaux_61606(Cmds_61692[I_61735], Options_61694));
F.line = 1014;F.filename = "system.nim";
Res_61825 = addInt(Res_61825, 1);
} LA4: ;
I_61736 = 0;
F.line = 182;F.filename = "osproc.nim";
I_61736 = M_61727;
F.line = 183;F.filename = "osproc.nim";
while (1) {
if (!(I_61736 <= (Cmds_61692Len0-1))) goto LA5;
F.line = 184;F.filename = "osproc.nim";
nossleep(50);
R_61746 = 0;
HEX3Atmp_61829 = 0;
F.line = 185;F.filename = "osproc.nim";
HEX3Atmp_61829 = subInt(N_61695, 1);
Res_61831 = 0;
F.line = 1011;F.filename = "system.nim";
Res_61831 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_61831 <= HEX3Atmp_61829)) goto LA6;
F.line = 1011;F.filename = "system.nim";
R_61746 = Res_61831;
F.line = 186;F.filename = "osproc.nim";
if ((NU)(R_61746) >= (NU)(Q_61702->Sup.len)) raiseIndexError();
LOC8 = nosprunning(Q_61702->data[R_61746]);
if (!!(LOC8)) goto LA9;
F.line = 188;F.filename = "osproc.nim";
if ((NU)(R_61746) >= (NU)(Q_61702->Sup.len)) raiseIndexError();
LOC11 = nospwaitForExit(Q_61702->data[R_61746]);
Result_61696 = ((LOC11 >= Result_61696) ? LOC11 : Result_61696);
F.line = 189;F.filename = "osproc.nim";
if ((NU)(R_61746) >= (NU)(Q_61702->Sup.len)) raiseIndexError();
if ((NU)(I_61736) >= (NU)(Cmds_61692Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Q_61702->data[R_61746], Startprocessaux_61606(Cmds_61692[I_61736], Options_61694));
F.line = 190;F.filename = "osproc.nim";
I_61736 = addInt(I_61736, 1);
F.line = 191;F.filename = "osproc.nim";
if (!((Cmds_61692Len0-1) < I_61736)) goto LA13;
F.line = 191;F.filename = "osproc.nim";
goto LA6;
LA13: ;
LA9: ;
F.line = 1014;F.filename = "system.nim";
Res_61831 = addInt(Res_61831, 1);
} LA6: ;
} LA5: ;
I_61808 = 0;
HEX3Atmp_61836 = 0;
F.line = 192;F.filename = "osproc.nim";
HEX3Atmp_61836 = subInt(M_61727, 1);
Res_61838 = 0;
F.line = 1011;F.filename = "system.nim";
Res_61838 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_61838 <= HEX3Atmp_61836)) goto LA15;
F.line = 1011;F.filename = "system.nim";
I_61808 = Res_61838;
F.line = 193;F.filename = "osproc.nim";
if ((NU)(I_61808) >= (NU)(Q_61702->Sup.len)) raiseIndexError();
LOC16 = nospwaitForExit(Q_61702->data[I_61808]);
Result_61696 = ((LOC16 >= Result_61696) ? LOC16 : Result_61696);
F.line = 1014;F.filename = "system.nim";
Res_61838 = addInt(Res_61838, 1);
} LA15: ;
goto LA1;
LA2: ;
I_61818 = 0;
HEX3Atmp_61842 = 0;
F.line = 195;F.filename = "osproc.nim";
HEX3Atmp_61842 = (Cmds_61692Len0-1);
Res_61844 = 0;
F.line = 1011;F.filename = "system.nim";
Res_61844 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_61844 <= HEX3Atmp_61842)) goto LA17;
F.line = 1011;F.filename = "system.nim";
I_61818 = Res_61844;
P_61819 = 0;
F.line = 196;F.filename = "osproc.nim";
if ((NU)(I_61818) >= (NU)(Cmds_61692Len0)) raiseIndexError();
P_61819 = Startprocessaux_61606(Cmds_61692[I_61818], Options_61694);
F.line = 197;F.filename = "osproc.nim";
LOC18 = nospwaitForExit(P_61819);
Result_61696 = ((LOC18 >= Result_61696) ? LOC18 : Result_61696);
F.line = 1014;F.filename = "system.nim";
Res_61844 = addInt(Res_61844, 1);
} LA17: ;
LA1: ;
framePtr = framePtr->prev;
return Result_61696;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_17192, NimStringDesc* Src_17193) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendString";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 150;F.filename = "sysstr.nim";
memcpy(((NCSTRING) (&(*Dest_17192).data[((*Dest_17192).Sup.len)-0])), ((NCSTRING) ((*Src_17193).data)), ((NI32) ((NI64)((NI64)((*Src_17193).Sup.len + 1) * 1))));
F.line = 151;F.filename = "sysstr.nim";
(*Dest_17192).Sup.len += (*Src_17193).Sup.len;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* Command_61219, NU8 Options_61222) {
NimStringDesc* Result_61854;
TY61202* P_61855;
TY60027* Outp_61856;
NIM_BOOL LOC2;
NIM_BOOL LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "execProcess";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_61854 = 0;
P_61855 = 0;
F.line = 203;F.filename = "osproc.nim";
P_61855 = Startprocessaux_61606(Command_61219, Options_61222);
Outp_61856 = 0;
F.line = 204;F.filename = "osproc.nim";
Outp_61856 = nospoutputStream(P_61855);
F.line = 205;F.filename = "osproc.nim";
Result_61854 = copyString(((NimStringDesc*) &TMP61688));
F.line = 206;F.filename = "osproc.nim";
while (1) {
LOC2 = nosprunning(P_61855);
if (LOC2) goto LA3;
LOC4 = (*Outp_61856).Atend(Outp_61856);
LOC2 = !(LOC4);
LA3: ;
if (!LOC2) goto LA1;
F.line = 207;F.filename = "osproc.nim";
LOC5 = 0;
LOC5 = Readline_60210(Outp_61856);
Result_61854 = resizeString(Result_61854, LOC5->Sup.len + 0);
appendString(Result_61854, LOC5);
F.line = 208;F.filename = "osproc.nim";
Result_61854 = resizeString(Result_61854, 2);
appendString(Result_61854, ((NimStringDesc*) &TMP62002));
} LA1: ;
framePtr = framePtr->prev;
return Result_61854;
}
N_NIMCALL(void, Hsclose_62207)(TY62204* S_62209) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsClose";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
framePtr = framePtr->prev;
}
N_NIMCALL(NIM_BOOL, Hsatend_62210)(TY62204* S_62212) {
NIM_BOOL Result_62213;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsAtEnd";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62213 = 0;
F.line = 227;F.filename = "osproc.nim";
F.line = 227;F.filename = "osproc.nim";
Result_62213 = (*S_62212).Attheend;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_62213;
}
static N_INLINE(NI, chckRange)(NI I_4610, NI A_4611, NI B_4612) {
NI Result_5316;
NIM_BOOL LOC2;
Result_5316 = 0;
LOC2 = (A_4611 <= I_4610);
if (!(LOC2)) goto LA3;
LOC2 = (I_4610 <= B_4612);
LA3: ;
if (!LOC2) goto LA4;
Result_5316 = I_4610;
goto BeforeRet;
goto LA1;
LA4: ;
raiseRangeError(((NI64) (I_4610)));
LA1: ;
BeforeRet: ;
return Result_5316;
}
N_NIMCALL(NI, Hsreaddata_62214)(TY62204* S_62216, void* Buffer_62217, NI Buflen_62218) {
NI Result_62219;
NI32 Br_62220;
NI32 A_62222;
NIM_BOOL LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsReadData";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62219 = 0;
F.line = 230;F.filename = "osproc.nim";
if (!(*S_62216).Attheend) goto LA2;
F.line = 230;F.filename = "osproc.nim";
F.line = 230;F.filename = "osproc.nim";
Result_62219 = 0;
goto BeforeRet;
LA2: ;
Br_62220 = 0;
A_62222 = 0;
F.line = 232;F.filename = "osproc.nim";
A_62222 = Dl_26481((*S_62216).Handle, Buffer_62217, ((NI32)chckRange(Buflen_62218, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))), &Br_62220, NIM_NIL);
F.line = 236;F.filename = "osproc.nim";
LOC5 = (((NI) (A_62222)) == 0);
if (!(LOC5)) goto LA6;
LOC5 = !((((NI) (Br_62220)) == 0));
LA6: ;
if (!LOC5) goto LA7;
F.line = 236;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP61688));
LA7: ;
F.line = 237;F.filename = "osproc.nim";
(*S_62216).Attheend = (((NI) (Br_62220)) < Buflen_62218);
F.line = 238;F.filename = "osproc.nim";
Result_62219 = ((NI) (Br_62220));
BeforeRet: ;
framePtr = framePtr->prev;
return Result_62219;
}
N_NIMCALL(void, Hswritedata_62229)(TY62204* S_62231, void* Buffer_62232, NI Buflen_62233) {
NI32 Byteswritten_62234;
NI32 A_62236;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "hsWriteData";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Byteswritten_62234 = 0;
A_62236 = 0;
F.line = 242;F.filename = "osproc.nim";
A_62236 = Dl_26489((*S_62231).Handle, Buffer_62232, ((NI32)chckRange(Buflen_62233, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))), &Byteswritten_62234, NIM_NIL);
F.line = 243;F.filename = "osproc.nim";
if (!(((NI) (A_62236)) == 0)) goto LA2;
F.line = 243;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP61688));
LA2: ;
framePtr = framePtr->prev;
}
N_NIMCALL(TY62204*, Newfilehandlestream_62239)(NI Handle_62241) {
TY62204* Result_62242;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "newFileHandleStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62242 = 0;
F.line = 246;F.filename = "osproc.nim";
Result_62242 = (TY62204*) newObj(NTI62202, sizeof(TY62204));
(*Result_62242).Sup.Sup.m_type = NTI62204;
F.line = 247;F.filename = "osproc.nim";
(*Result_62242).Handle = Handle_62241;
F.line = 248;F.filename = "osproc.nim";
(*Result_62242).Sup.Close = ((TY60028) (Hsclose_62207));
F.line = 249;F.filename = "osproc.nim";
(*Result_62242).Sup.Atend = ((TY60032) (Hsatend_62210));
F.line = 250;F.filename = "osproc.nim";
(*Result_62242).Sup.Readdata = ((TY60045) (Hsreaddata_62214));
F.line = 251;F.filename = "osproc.nim";
(*Result_62242).Sup.Writedata = ((TY60051) (Hswritedata_62229));
framePtr = framePtr->prev;
return Result_62242;
}
N_NIMCALL(NCSTRING, Buildcommandline_62258)(NimStringDesc* A_62260, NimStringDesc** Args_62262, NI Args_62262Len0) {
NCSTRING Result_62263;
NimStringDesc* Res_62264;
NI I_62272;
NI HEX3Atmp_62814;
NI Res_62816;
NimStringDesc* LOC2;
void* LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "buildCommandLine";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62263 = 0;
Res_62264 = 0;
F.line = 254;F.filename = "osproc.nim";
Res_62264 = Quoteifcontainswhite_24283(A_62260);
I_62272 = 0;
HEX3Atmp_62814 = 0;
F.line = 255;F.filename = "osproc.nim";
HEX3Atmp_62814 = (Args_62262Len0-1);
Res_62816 = 0;
F.line = 1011;F.filename = "system.nim";
Res_62816 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_62816 <= HEX3Atmp_62814)) goto LA1;
F.line = 1011;F.filename = "system.nim";
I_62272 = Res_62816;
F.line = 256;F.filename = "osproc.nim";
Res_62264 = addChar(Res_62264, 32);
F.line = 257;F.filename = "osproc.nim";
if ((NU)(I_62272) >= (NU)(Args_62262Len0)) raiseIndexError();
LOC2 = 0;
LOC2 = Quoteifcontainswhite_24283(Args_62262[I_62272]);
Res_62264 = resizeString(Res_62264, LOC2->Sup.len + 0);
appendString(Res_62264, LOC2);
F.line = 1014;F.filename = "system.nim";
Res_62816 = addInt(Res_62816, 1);
} LA1: ;
F.line = 258;F.filename = "osproc.nim";
LOC3 = Alloc0_1777(addInt(Res_62264->Sup.len, 1));
Result_62263 = ((NCSTRING) (LOC3));
F.line = 259;F.filename = "osproc.nim";
memcpy(((void*) (Result_62263)), ((void*) (Res_62264->data)), Res_62264->Sup.len);
framePtr = framePtr->prev;
return Result_62263;
}
N_NIMCALL(NCSTRING, Buildenv_62277)(TY59408* Env_62279) {
NCSTRING Result_62280;
NI L_62281;
NimStringDesc* Key_62282;
NimStringDesc* Val_62283;
NI H_62821;
NI HEX3Atmp_62823;
NI Res_62825;
void* LOC5;
NimStringDesc* Key_62300;
NimStringDesc* Val_62301;
NI H_62832;
NI HEX3Atmp_62834;
NI Res_62836;
NimStringDesc* X_62318;
NimStringDesc* LOC10;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "buildEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62280 = 0;
L_62281 = 0;
F.line = 262;F.filename = "osproc.nim";
L_62281 = 0;
Key_62282 = 0;
Val_62283 = 0;
H_62821 = 0;
HEX3Atmp_62823 = 0;
F.line = 40;F.filename = "strtabs.nim";
HEX3Atmp_62823 = ((*Env_62279).Data->Sup.len-1);
Res_62825 = 0;
F.line = 1011;F.filename = "system.nim";
Res_62825 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_62825 <= HEX3Atmp_62823)) goto LA1;
F.line = 1011;F.filename = "system.nim";
H_62821 = Res_62825;
F.line = 41;F.filename = "strtabs.nim";
if ((NU)(H_62821) >= (NU)((*Env_62279).Data->Sup.len)) raiseIndexError();
if (!!((*Env_62279).Data->data[H_62821].Key == 0)) goto LA3;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_62821) >= (NU)((*Env_62279).Data->Sup.len)) raiseIndexError();
Key_62282 = (*Env_62279).Data->data[H_62821].Key;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_62821) >= (NU)((*Env_62279).Data->Sup.len)) raiseIndexError();
Val_62283 = (*Env_62279).Data->data[H_62821].Val;
F.line = 263;F.filename = "osproc.nim";
L_62281 = addInt(L_62281, addInt(addInt(Key_62282->Sup.len, Val_62283->Sup.len), 2));
LA3: ;
F.line = 1014;F.filename = "system.nim";
Res_62825 = addInt(Res_62825, 1);
} LA1: ;
F.line = 264;F.filename = "osproc.nim";
LOC5 = Alloc0_1777(addInt(L_62281, 2));
Result_62280 = ((NCSTRING) (LOC5));
F.line = 265;F.filename = "osproc.nim";
L_62281 = 0;
Key_62300 = 0;
Val_62301 = 0;
H_62832 = 0;
HEX3Atmp_62834 = 0;
F.line = 40;F.filename = "strtabs.nim";
HEX3Atmp_62834 = ((*Env_62279).Data->Sup.len-1);
Res_62836 = 0;
F.line = 1011;F.filename = "system.nim";
Res_62836 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_62836 <= HEX3Atmp_62834)) goto LA6;
F.line = 1011;F.filename = "system.nim";
H_62832 = Res_62836;
F.line = 41;F.filename = "strtabs.nim";
if ((NU)(H_62832) >= (NU)((*Env_62279).Data->Sup.len)) raiseIndexError();
if (!!((*Env_62279).Data->data[H_62832].Key == 0)) goto LA8;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_62832) >= (NU)((*Env_62279).Data->Sup.len)) raiseIndexError();
Key_62300 = (*Env_62279).Data->data[H_62832].Key;
F.line = 42;F.filename = "strtabs.nim";
if ((NU)(H_62832) >= (NU)((*Env_62279).Data->Sup.len)) raiseIndexError();
Val_62301 = (*Env_62279).Data->data[H_62832].Val;
X_62318 = 0;
F.line = 267;F.filename = "osproc.nim";
LOC10 = 0;
LOC10 = rawNewString(Key_62300->Sup.len + Val_62301->Sup.len + 1);
appendString(LOC10, Key_62300);
appendString(LOC10, ((NimStringDesc*) &TMP62843));
appendString(LOC10, Val_62301);
X_62318 = LOC10;
F.line = 268;F.filename = "osproc.nim";
memcpy(((void*) (&Result_62280[L_62281])), ((void*) (X_62318->data)), addInt(X_62318->Sup.len, 1));
F.line = 269;F.filename = "osproc.nim";
L_62281 = addInt(L_62281, addInt(X_62318->Sup.len, 1));
LA8: ;
F.line = 1014;F.filename = "system.nim";
Res_62836 = addInt(Res_62836, 1);
} LA6: ;
framePtr = framePtr->prev;
return Result_62280;
}
N_NIMCALL(void, Createpipehandles_62336)(NI* Rdhandle_62339, NI* Wrhandle_62340) {
TY26432 Piinheritablepipe_62341;
NI32 LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "CreatePipeHandles";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)&Piinheritablepipe_62341, 0, sizeof(Piinheritablepipe_62341));
F.line = 280;F.filename = "osproc.nim";
Piinheritablepipe_62341.Nlength = ((NI32)chckRange(((NI)sizeof(TY26432)), ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 281;F.filename = "osproc.nim";
Piinheritablepipe_62341.Lpsecuritydescriptor = NIM_NIL;
F.line = 282;F.filename = "osproc.nim";
Piinheritablepipe_62341.Binherithandle = ((NI32) 1);
F.line = 283;F.filename = "osproc.nim";
LOC2 = Dl_26497(Rdhandle_62339, Wrhandle_62340, &Piinheritablepipe_62341, ((NI32) 1024));
if (!(LOC2 == ((NI32) 0))) goto LA3;
F.line = 284;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP61688));
LA3: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, Fileclose_62345)(NI H_62347) {
NI32 LOC4;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "fileClose";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 287;F.filename = "osproc.nim";
if (!(4 < H_62347)) goto LA2;
F.line = 287;F.filename = "osproc.nim";
LOC4 = Dl_26475(H_62347);
LA2: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, rawEcho)(NimStringDesc* X_4094) {
Write_3658(stdout, X_4094);
}
static N_INLINE(void, rawEchoNL)(void) {
Write_3658(stdout, ((NimStringDesc*) &TMP62002));
}
N_NIMCALL(TY61202*, nospstartProcess)(NimStringDesc* Command_61239, NimStringDesc* Workingdir_61240, NimStringDesc** Args_61245, NI Args_61245Len0, TY59408* Env_61246, NU8 Options_61249) {
TY61202* Result_62363;
TY26434 Si_62364;
TY26436 Procinfo_62365;
NI Success_62366;
NI Hi_62367;
NI Ho_62368;
NI He_62369;
NCSTRING Cmdl_62413;
NimStringDesc* LOC10;
TY4377* LOC11;
TY62426 LOC12;
TY4377* LOC13;
NCSTRING Wd_62521;
NCSTRING E_62522;
NimStringDesc* LOC23;
NI32 LOC24;
NI32 LOC37;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "startProcess";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62363 = 0;
memset((void*)&Si_62364, 0, sizeof(Si_62364));
memset((void*)&Procinfo_62365, 0, sizeof(Procinfo_62365));
Success_62366 = 0;
Hi_62367 = 0;
Ho_62368 = 0;
He_62369 = 0;
F.line = 299;F.filename = "osproc.nim";
Result_62363 = (TY61202*) newObj(NTI61204, sizeof(TY61202));
(*Result_62363).Sup.m_type = NTI61202;
F.line = 300;F.filename = "osproc.nim";
Si_62364.Cb = ((NI32)chckRange(((NI)sizeof(TY26434)), ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 301;F.filename = "osproc.nim";
if (!!(((Options_61249 &(1<<((((NU8) 3))&7)))!=0))) goto LA2;
F.line = 302;F.filename = "osproc.nim";
Si_62364.Dwflags = ((NI32) 256);
F.line = 303;F.filename = "osproc.nim";
Createpipehandles_62336(&Si_62364.Hstdinput, &Hi_62367);
F.line = 304;F.filename = "osproc.nim";
Createpipehandles_62336(&Ho_62368, &Si_62364.Hstdoutput);
F.line = 305;F.filename = "osproc.nim";
if (!((Options_61249 &(1<<((((NU8) 2))&7)))!=0)) goto LA5;
F.line = 306;F.filename = "osproc.nim";
Si_62364.Hstderror = Si_62364.Hstdoutput;
F.line = 307;F.filename = "osproc.nim";
He_62369 = Ho_62368;
goto LA4;
LA5: ;
F.line = 309;F.filename = "osproc.nim";
Createpipehandles_62336(&He_62369, &Si_62364.Hstderror);
LA4: ;
F.line = 310;F.filename = "osproc.nim";
(*Result_62363).Inputhandle = ((NI32)chckRange(Hi_62367, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 311;F.filename = "osproc.nim";
(*Result_62363).Outputhandle = ((NI32)chckRange(Ho_62368, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 312;F.filename = "osproc.nim";
(*Result_62363).Errorhandle = ((NI32)chckRange(He_62369, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
goto LA1;
LA2: ;
F.line = 314;F.filename = "osproc.nim";
Si_62364.Hstderror = Dl_26540(((NI32) -12));
F.line = 315;F.filename = "osproc.nim";
Si_62364.Hstdinput = Dl_26540(((NI32) -10));
F.line = 316;F.filename = "osproc.nim";
Si_62364.Hstdoutput = Dl_26540(((NI32) -11));
F.line = 317;F.filename = "osproc.nim";
(*Result_62363).Inputhandle = ((NI32)chckRange(Si_62364.Hstdinput, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 318;F.filename = "osproc.nim";
(*Result_62363).Outputhandle = ((NI32)chckRange(Si_62364.Hstdoutput, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 319;F.filename = "osproc.nim";
(*Result_62363).Errorhandle = ((NI32)chckRange(Si_62364.Hstderror, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
LA1: ;
Cmdl_62413 = 0;
F.line = 322;F.filename = "osproc.nim";
if (!NIM_FALSE) goto LA8;
F.line = 323;F.filename = "osproc.nim";
LOC10 = 0;
LOC10 = Getenv_33425(((NimStringDesc*) &TMP62844));
LOC11 = 0;
LOC11 = (TY4377*) newSeq(NTI4377, 2);
memset((void*)&LOC12, 0, sizeof(LOC12));
LOC12[0] = copyString(((NimStringDesc*) &TMP62845));
LOC12[1] = copyString(Command_61239);
asgnRefNoCycle((void**) &LOC11->data[0], copyString(LOC12[0]));
asgnRefNoCycle((void**) &LOC11->data[1], copyString(LOC12[1]));
LOC13 = 0;
LOC13 = HEX26_62435(LOC11->data, LOC11->Sup.len, Args_61245, Args_61245Len0);
Cmdl_62413 = Buildcommandline_62258(LOC10, LOC13->data, LOC13->Sup.len);
goto LA7;
LA8: ;
F.line = 325;F.filename = "osproc.nim";
Cmdl_62413 = Buildcommandline_62258(Command_61239, Args_61245, Args_61245Len0);
LA7: ;
Wd_62521 = 0;
F.line = 326;F.filename = "osproc.nim";
Wd_62521 = NIM_NIL;
E_62522 = 0;
F.line = 327;F.filename = "osproc.nim";
E_62522 = NIM_NIL;
F.line = 328;F.filename = "osproc.nim";
if (!(0 < Workingdir_61240->Sup.len)) goto LA15;
F.line = 328;F.filename = "osproc.nim";
Wd_62521 = Workingdir_61240->data;
LA15: ;
F.line = 329;F.filename = "osproc.nim";
if (!!((Env_61246 == NIM_NIL))) goto LA18;
F.line = 329;F.filename = "osproc.nim";
E_62522 = Buildenv_62277(Env_61246);
LA18: ;
F.line = 330;F.filename = "osproc.nim";
if (!((Options_61249 &(1<<((((NU8) 0))&7)))!=0)) goto LA21;
F.line = 330;F.filename = "osproc.nim";
LOC23 = 0;
LOC23 = cstrToNimstr(Cmdl_62413);
rawEcho(LOC23);
rawEchoNL();
LA21: ;
F.line = 331;F.filename = "osproc.nim";
LOC24 = Dl_26505(NIM_NIL, Cmdl_62413, NIM_NIL, NIM_NIL, ((NI32) 1), ((NI32) 32), ((void*) (E_62522)), Wd_62521, &Si_62364, &Procinfo_62365);
Success_62366 = ((NI) (LOC24));
F.line = 334;F.filename = "osproc.nim";
if (!!(((Options_61249 &(1<<((((NU8) 3))&7)))!=0))) goto LA26;
F.line = 335;F.filename = "osproc.nim";
Fileclose_62345(Si_62364.Hstdinput);
F.line = 336;F.filename = "osproc.nim";
Fileclose_62345(Si_62364.Hstdoutput);
F.line = 337;F.filename = "osproc.nim";
if (!!(((Options_61249 &(1<<((((NU8) 2))&7)))!=0))) goto LA29;
F.line = 338;F.filename = "osproc.nim";
Fileclose_62345(Si_62364.Hstderror);
LA29: ;
LA26: ;
F.line = 340;F.filename = "osproc.nim";
if (!!((E_62522 == NIM_NIL))) goto LA32;
F.line = 340;F.filename = "osproc.nim";
Dealloc_1784(((void*) (E_62522)));
LA32: ;
F.line = 341;F.filename = "osproc.nim";
Dealloc_1784(((void*) (Cmdl_62413)));
F.line = 342;F.filename = "osproc.nim";
if (!(Success_62366 == 0)) goto LA35;
F.line = 342;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP61688));
LA35: ;
F.line = 344;F.filename = "osproc.nim";
LOC37 = Dl_26475(Procinfo_62365.Hthread);
F.line = 345;F.filename = "osproc.nim";
(*Result_62363).Fprocesshandle = Procinfo_62365.Hprocess;
F.line = 346;F.filename = "osproc.nim";
(*Result_62363).Id = Procinfo_62365.Dwprocessid;
framePtr = framePtr->prev;
return Result_62363;
}
N_NIMCALL(void, nospsuspend)(TY61202* P_61252) {
NI32 LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "suspend";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 349;F.filename = "osproc.nim";
LOC1 = Dl_26521((*P_61252).Fprocesshandle);
framePtr = framePtr->prev;
}
N_NIMCALL(void, nospresume)(TY61202* P_61255) {
NI32 LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "resume";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 352;F.filename = "osproc.nim";
LOC1 = Dl_26524((*P_61255).Fprocesshandle);
framePtr = framePtr->prev;
}
N_NIMCALL(NIM_BOOL, nosprunning)(TY61202* P_61261) {
NIM_BOOL Result_62584;
NI32 X_62585;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "running";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62584 = 0;
X_62585 = 0;
F.line = 355;F.filename = "osproc.nim";
X_62585 = Dl_26527((*P_61261).Fprocesshandle, ((NI32) 50));
F.line = 356;F.filename = "osproc.nim";
F.line = 356;F.filename = "osproc.nim";
Result_62584 = (X_62585 == ((NI32) 258));
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_62584;
}
N_NIMCALL(void, nospterminate)(TY61202* P_61258) {
NIM_BOOL LOC2;
NI32 LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "terminate";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 359;F.filename = "osproc.nim";
LOC2 = nosprunning(P_61258);
if (!LOC2) goto LA3;
F.line = 360;F.filename = "osproc.nim";
LOC5 = Dl_26531((*P_61258).Fprocesshandle, 0);
LA3: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NI, nospwaitForExit)(TY61202* P_61268) {
NI Result_62594;
NI32 LOC1;
NI32 Res_62595;
NI32 LOC2;
NI32 LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "waitForExit";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62594 = 0;
F.line = 363;F.filename = "osproc.nim";
LOC1 = Dl_26527((*P_61268).Fprocesshandle, ((NI32) -1));
Res_62595 = 0;
F.line = 365;F.filename = "osproc.nim";
LOC2 = Dl_26535((*P_61268).Fprocesshandle, &Res_62595);
F.line = 366;F.filename = "osproc.nim";
Result_62594 = ((NI) (Res_62595));
F.line = 367;F.filename = "osproc.nim";
LOC3 = Dl_26475((*P_61268).Fprocesshandle);
framePtr = framePtr->prev;
return Result_62594;
}
N_NIMCALL(TY60027*, nospinputStream)(TY61202* P_61271) {
TY60027* Result_62600;
TY62204* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "inputStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62600 = 0;
F.line = 370;F.filename = "osproc.nim";
LOC1 = 0;
LOC1 = Newfilehandlestream_62239(((NI) ((*P_61271).Inputhandle)));
Result_62600 = &LOC1->Sup;
framePtr = framePtr->prev;
return Result_62600;
}
N_NIMCALL(TY60027*, nospoutputStream)(TY61202* P_61274) {
TY60027* Result_62604;
TY62204* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "outputStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62604 = 0;
F.line = 373;F.filename = "osproc.nim";
LOC1 = 0;
LOC1 = Newfilehandlestream_62239(((NI) ((*P_61274).Outputhandle)));
Result_62604 = &LOC1->Sup;
framePtr = framePtr->prev;
return Result_62604;
}
N_NIMCALL(TY60027*, nosperrorStream)(TY61202* P_61277) {
TY60027* Result_62608;
TY62204* LOC1;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "errorStream";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62608 = 0;
F.line = 376;F.filename = "osproc.nim";
LOC1 = 0;
LOC1 = Newfilehandlestream_62239(((NI) ((*P_61277).Errorhandle)));
Result_62608 = &LOC1->Sup;
framePtr = framePtr->prev;
return Result_62608;
}
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* Command_61232) {
NI Result_62612;
TY26434 Si_62613;
TY26436 Procinfo_62614;
NI Process_62615;
NI32 L_62616;
NI32 LOC2;
NI32 LOC5;
NI32 LOC7;
NI32 LOC10;
NI32 LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "execCmd";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62612 = 0;
memset((void*)&Si_62613, 0, sizeof(Si_62613));
memset((void*)&Procinfo_62614, 0, sizeof(Procinfo_62614));
Process_62615 = 0;
L_62616 = 0;
F.line = 384;F.filename = "osproc.nim";
Si_62613.Cb = ((NI32)chckRange(((NI)sizeof(TY26434)), ((NI32) (-2147483647 -1)), ((NI32) 2147483647)));
F.line = 385;F.filename = "osproc.nim";
Si_62613.Hstderror = Dl_26540(((NI32) -12));
F.line = 386;F.filename = "osproc.nim";
Si_62613.Hstdinput = Dl_26540(((NI32) -10));
F.line = 387;F.filename = "osproc.nim";
Si_62613.Hstdoutput = Dl_26540(((NI32) -11));
F.line = 388;F.filename = "osproc.nim";
LOC2 = Dl_26505(NIM_NIL, Command_61232->data, NIM_NIL, NIM_NIL, ((NI32) 0), ((NI32) 32), NIM_NIL, NIM_NIL, &Si_62613, &Procinfo_62614);
if (!(((NI) (LOC2)) == 0)) goto LA3;
F.line = 390;F.filename = "osproc.nim";
nosOSError(((NimStringDesc*) &TMP61688));
goto LA1;
LA3: ;
F.line = 392;F.filename = "osproc.nim";
Process_62615 = Procinfo_62614.Hprocess;
F.line = 393;F.filename = "osproc.nim";
LOC5 = Dl_26475(Procinfo_62614.Hthread);
F.line = 394;F.filename = "osproc.nim";
LOC7 = Dl_26527(Process_62615, ((NI32) -1));
if (!!((((NI) (LOC7)) == -1))) goto LA8;
F.line = 395;F.filename = "osproc.nim";
LOC10 = Dl_26535(Process_62615, &L_62616);
F.line = 396;F.filename = "osproc.nim";
Result_62612 = ((NI) (L_62616));
goto LA6;
LA8: ;
F.line = 398;F.filename = "osproc.nim";
Result_62612 = -1;
LA6: ;
F.line = 399;F.filename = "osproc.nim";
LOC11 = Dl_26475(Process_62615);
LA1: ;
framePtr = framePtr->prev;
return Result_62612;
}
N_NIMCALL(TY4377*, HEX26_62435)(NimStringDesc** X_62439, NI X_62439Len0, NimStringDesc** Y_62440, NI Y_62440Len0) {
TY4377* Result_62442;
NI I_62492;
NI HEX3Atmp_62802;
NI Res_62804;
NI I_62510;
NI HEX3Atmp_62808;
NI Res_62810;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "&";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_62442 = 0;
F.line = 1102;F.filename = "system.nim";
Result_62442 = (TY4377*) newSeq(NTI4377, addInt(X_62439Len0, Y_62440Len0));
I_62492 = 0;
HEX3Atmp_62802 = 0;
F.line = 1103;F.filename = "system.nim";
HEX3Atmp_62802 = subInt(X_62439Len0, 1);
Res_62804 = 0;
F.line = 1011;F.filename = "system.nim";
Res_62804 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_62804 <= HEX3Atmp_62802)) goto LA1;
F.line = 1011;F.filename = "system.nim";
I_62492 = Res_62804;
F.line = 1104;F.filename = "system.nim";
if ((NU)(I_62492) >= (NU)(Result_62442->Sup.len)) raiseIndexError();
if ((NU)(I_62492) >= (NU)(X_62439Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Result_62442->data[I_62492], copyString(X_62439[I_62492]));
F.line = 1014;F.filename = "system.nim";
Res_62804 = addInt(Res_62804, 1);
} LA1: ;
I_62510 = 0;
HEX3Atmp_62808 = 0;
F.line = 1105;F.filename = "system.nim";
HEX3Atmp_62808 = subInt(Y_62440Len0, 1);
Res_62810 = 0;
F.line = 1011;F.filename = "system.nim";
Res_62810 = 0;
F.line = 1012;F.filename = "system.nim";
while (1) {
if (!(Res_62810 <= HEX3Atmp_62808)) goto LA2;
F.line = 1011;F.filename = "system.nim";
I_62510 = Res_62810;
F.line = 1106;F.filename = "system.nim";
if ((NU)(addInt(I_62510, X_62439Len0)) >= (NU)(Result_62442->Sup.len)) raiseIndexError();
if ((NU)(I_62510) >= (NU)(Y_62440Len0)) raiseIndexError();
asgnRefNoCycle((void**) &Result_62442->data[addInt(I_62510, X_62439Len0)], copyString(Y_62440[I_62510]));
F.line = 1014;F.filename = "system.nim";
Res_62810 = addInt(Res_62810, 1);
} LA2: ;
framePtr = framePtr->prev;
return Result_62442;
}
N_NOINLINE(void, osprocInit)(void) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "osproc";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/osproc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
framePtr = framePtr->prev;
}

