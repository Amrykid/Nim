/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct TY55215 TY55215;
typedef struct TY55213 TY55213;
typedef struct TY55211 TY55211;
typedef struct TGenericSeq TGenericSeq;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY50548 TY50548;
typedef struct TY50530 TY50530;
typedef struct TY50528 TY50528;
typedef struct TY49011 TY49011;
typedef struct TY49005 TY49005;
typedef struct TNimObject TNimObject;
typedef struct NimStringDesc NimStringDesc;
typedef struct TY50552 TY50552;
typedef struct TY42538 TY42538;
typedef struct TY50526 TY50526;
typedef struct TY50540 TY50540;
typedef struct TY47008 TY47008;
typedef struct TY50544 TY50544;
typedef struct TY10602 TY10602;
typedef struct TY10614 TY10614;
typedef struct TY10996 TY10996;
typedef struct TY10618 TY10618;
typedef struct TY10610 TY10610;
typedef struct TY10994 TY10994;
typedef struct TY55071 TY55071;
typedef struct TY50564 TY50564;
typedef struct TY50562 TY50562;
typedef struct TY50560 TY50560;
typedef struct TY55099 TY55099;
typedef struct TY55101 TY55101;
typedef struct TY55084 TY55084;
typedef struct TY50570 TY50570;
typedef struct TY50568 TY50568;
typedef struct TY50566 TY50566;
typedef struct TY50520 TY50520;
typedef struct TY50550 TY50550;
typedef struct TY38013 TY38013;
struct TY55211 {
NI Key;
NI Val;
};
struct TGenericSeq {
NI len;
NI space;
};
struct TY55215 {
NI Counter;
TY55213* Data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY50530 {
TNimType* m_type;
NI Counter;
TY50528* Data;
};
struct TNimObject {
TNimType* m_type;
};
struct TY49005 {
  TNimObject Sup;
NI Id;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TY49011 {
  TY49005 Sup;
NimStringDesc* S;
TY49011* Next;
NI H;
};
struct TY42538 {
NI16 Line;
NI16 Col;
NI32 Fileindex;
};
struct TY50540 {
NU8 K;
NU8 S;
NU8 Flags;
TY50552* T;
TY47008* R;
NI A;
};
struct TY50548 {
  TY49005 Sup;
NU8 Kind;
NU8 Magic;
TY50552* Typ;
TY49011* Name;
TY42538 Info;
TY50548* Owner;
NU32 Flags;
TY50530 Tab;
TY50526* Ast;
NU32 Options;
NI Position;
NI Offset;
TY50540 Loc;
TY50544* Annex;
};
struct TY10602 {
NI Refcount;
TNimType* Typ;
};
struct TY10618 {
NI Len;
NI Cap;
TY10602** D;
};
struct TY10614 {
NI Counter;
NI Max;
TY10610* Head;
TY10610** Data;
};
struct TY10994 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10996 {
TY10618 Zct;
TY10618 Decstack;
TY10614 Cycleroots;
TY10618 Tempstack;
TY10994 Stat;
};
struct TY55071 {
NI H;
};
struct TY50560 {
TY49005* Key;
TNimObject* Val;
};
struct TY50564 {
NI Counter;
TY50562* Data;
};
struct TY55099 {
NI Tos;
TY55101* Stack;
};
struct TY55084 {
NI H;
TY49011* Name;
};
struct TY50566 {
TY49005* Key;
TY50526* Val;
};
struct TY50570 {
NI Counter;
TY50568* Data;
};
struct TY50526 {
TY50552* Typ;
NimStringDesc* Comment;
TY42538 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {TY50548* Sym;
} S4;
struct {TY49011* Ident;
} S5;
struct {TY50520* Sons;
} S6;
} KindU;
};
struct TY50552 {
  TY49005 Sup;
NU8 Kind;
TY50550* Sons;
TY50526* N;
NU8 Flags;
NU8 Callconv;
TY50548* Owner;
TY50548* Sym;
NI64 Size;
NI Align;
NI Containerid;
TY50540 Loc;
};
struct TY47008 {
  TNimObject Sup;
TY47008* Left;
TY47008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY38013 {
  TNimObject Sup;
TY38013* Prev;
TY38013* Next;
};
struct TY50544 {
  TY38013 Sup;
NU8 Kind;
NIM_BOOL Generated;
TY47008* Name;
TY50526* Path;
};
typedef NI TY8614[8];
struct TY10610 {
TY10610* Next;
NI Key;
TY8614 Bits;
};
struct TY55213 {
  TGenericSeq Sup;
  TY55211 data[SEQ_DECL_SIZE];
};
struct TY50528 {
  TGenericSeq Sup;
  TY50548* data[SEQ_DECL_SIZE];
};
struct TY50562 {
  TGenericSeq Sup;
  TY50560 data[SEQ_DECL_SIZE];
};
struct TY55101 {
  TGenericSeq Sup;
  TY50530 data[SEQ_DECL_SIZE];
};
struct TY50568 {
  TGenericSeq Sup;
  TY50566 data[SEQ_DECL_SIZE];
};
struct TY50520 {
  TGenericSeq Sup;
  TY50526* data[SEQ_DECL_SIZE];
};
struct TY50550 {
  TGenericSeq Sup;
  TY50552* data[SEQ_DECL_SIZE];
};
N_NIMCALL(void*, newSeq)(TNimType* Typ_14204, NI Len_14205);
N_NIMCALL(void, unsureAsgnRef)(void** Dest_13026, void* Src_13027);
N_NIMCALL(NI, Nexttry_55205)(NI H_55207, NI Maxhash_55208);
N_NIMCALL(NIM_BOOL, Mustrehash_55201)(NI Length_55203, NI Counter_55204);
N_NIMCALL(void, Strtableenlarge_57293)(TY50530* T_57296);
N_NIMCALL(void, Strtablerawinsert_57256)(TY50528** Data_57259, TY50548* N_57260);
N_NIMCALL(void, Internalerror_43159)(TY42538 Info_43161, NimStringDesc* Errmsg_43162);
static N_INLINE(void, appendString)(NimStringDesc* Dest_18599, NimStringDesc* Src_18600);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_18489);
static N_INLINE(void, asgnRef)(void** Dest_13014, void* Src_13015);
static N_INLINE(void, Incref_13002)(TY10602* C_13004);
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225);
static N_INLINE(NIM_BOOL, Canbecycleroot_11416)(TY10602* C_11418);
static N_INLINE(void, Rtladdcycleroot_12052)(TY10602* C_12054);
N_NOINLINE(void, Incl_10880)(TY10614* S_10883, TY10602* Cell_10884);
static N_INLINE(TY10602*, Usrtocell_11412)(void* Usr_11414);
static N_INLINE(void, Decref_12801)(TY10602* C_12803);
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230);
static N_INLINE(void, Rtladdzct_12401)(TY10602* C_12403);
N_NOINLINE(void, Addzct_11401)(TY10618* S_11404, TY10602* C_11405);
N_NIMCALL(TY50548*, Nextiter_55078)(TY55071* Ti_55081, TY50530* Tab_55082);
N_NIMCALL(NI, Iitablerawget_58101)(TY55215 T_58103, NI Key_58104);
N_NIMCALL(void, Iitablerawinsert_58119)(TY55213** Data_58122, NI Key_58123, NI Val_58124);
N_NIMCALL(NI, Idtablerawget_57732)(TY50564 T_57734, NI Key_57735);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13018, void* Src_13019);
N_NIMCALL(void, Idtablerawinsert_57784)(TY50562** Data_57787, TY49005* Key_57788, TNimObject* Val_57789);
N_NIMCALL(TY50548*, Strtableget_55066)(TY50530* T_55068, TY49011* Name_55069);
N_NIMCALL(TY50548*, Nextidentiter_55093)(TY55084* Ti_55096, TY50530* Tab_55097);
N_NIMCALL(NI, Idnodetablerawget_57917)(TY50570 T_57919, TY49005* Key_57920);
N_NIMCALL(void, Idnodetablerawinsert_57944)(TY50568** Data_57947, TY49005* Key_57948, TY50526* Val_57949);
static N_INLINE(NI, Sonslen_50804)(TY50526* N_50806);
N_NIMCALL(TGenericSeq*, setLengthSeq)(TGenericSeq* Seq_18803, NI Elemsize_18804, NI Newlen_18805);
N_NIMCALL(void, Initstrtable_50747)(TY50530* X_50750);
N_NIMCALL(NU8, Symtabadduniqueat_55135)(TY55099* Tab_55138, TY50548* E_55139, NI At_55140);
N_NIMCALL(NIM_BOOL, Strtableincl_57381)(TY50530* T_57384, TY50548* N_57385);
N_NIMCALL(void, Strtableadd_55061)(TY50530* T_55064, TY50548* N_55065);
N_NIMCALL(TY50548*, Lookupinrecord_55194)(TY50526* N_55196, TY49011* Field_55197);
static N_INLINE(TY50526*, Lastson_50810)(TY50526* N_50812);
STRING_LITERAL(TMP191609, "StrTableRawInsert: ", 19);
STRING_LITERAL(TMP192067, "getSymFromList", 14);
STRING_LITERAL(TMP192687, "lookupInRecord", 14);
STRING_LITERAL(TMP192688, "lookupInRecord(record case branch)", 34);
STRING_LITERAL(TMP192689, "lookupInRecord()", 16);
extern TNimType* NTI55213; /* TIIPairSeq */
extern TNimType* NTI50528; /* TSymSeq */
extern TY10996 Gch_11014;
extern TNimType* NTI50562; /* TIdPairSeq */
extern TNimType* NTI55101; /* seq[TStrTable] */
extern TNimType* NTI50568; /* TIdNodePairSeq */
N_NIMCALL(void, Initiitable_55220)(TY55215* X_55223) {
NI I_58098;
NI Res_58100;
(*X_55223).Counter = 0;
unsureAsgnRef((void**) &(*X_55223).Data, (TY55213*) newSeq(NTI55213, 8));
I_58098 = 0;
Res_58100 = 0;
Res_58100 = 0;
while (1) {
if (!(Res_58100 <= 7)) goto LA1;
I_58098 = Res_58100;
(*X_55223).Data->data[I_58098].Key = (IL64(-9223372036854775807) - IL64(1));
Res_58100 += 1;
} LA1: ;
}
N_NIMCALL(NI, Nexttry_55205)(NI H_55207, NI Maxhash_55208) {
NI Result_56824;
Result_56824 = 0;
Result_56824 = (NI64)((NI64)((NI64)(5 * H_55207) + 1) & Maxhash_55208);
return Result_56824;
}
N_NIMCALL(TY50548*, Strtableget_55066)(TY50530* T_55068, TY49011* Name_55069) {
TY50548* Result_57440;
NI H_57441;
Result_57440 = 0;
H_57441 = 0;
H_57441 = (NI64)((*Name_55069).H & ((*T_55068).Data->Sup.len-1));
while (1) {
Result_57440 = (*T_55068).Data->data[H_57441];
if (!(Result_57440 == NIM_NIL)) goto LA3;
goto LA1;
LA3: ;
if (!((*(*Result_57440).Name).Sup.Id == (*Name_55069).Sup.Id)) goto LA6;
goto LA1;
LA6: ;
H_57441 = Nexttry_55205(H_57441, ((*T_55068).Data->Sup.len-1));
} LA1: ;
return Result_57440;
}
N_NIMCALL(NIM_BOOL, Mustrehash_55201)(NI Length_55203, NI Counter_55204) {
NIM_BOOL Result_55521;
NIM_BOOL LOC1;
Result_55521 = 0;
LOC1 = ((NI64)(Length_55203 * 2) < (NI64)(Counter_55204 * 3));
if (LOC1) goto LA2;
LOC1 = ((NI64)(Length_55203 - Counter_55204) < 4);
LA2: ;
Result_55521 = LOC1;
return Result_55521;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_18599, NimStringDesc* Src_18600) {
memcpy(((NCSTRING) (&(*Dest_18599).data[((*Dest_18599).Sup.len)-0])), ((NCSTRING) ((*Src_18600).data)), ((NI32) ((NI64)((NI64)((*Src_18600).Sup.len + 1) * 1))));
(*Dest_18599).Sup.len += (*Src_18600).Sup.len;
}
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225) {
NI Result_7807;
Result_7807 = 0;
(*Memloc_3224) += X_3225;
Result_7807 = (*Memloc_3224);
return Result_7807;
}
static N_INLINE(NIM_BOOL, Canbecycleroot_11416)(TY10602* C_11418) {
NIM_BOOL Result_11419;
Result_11419 = 0;
Result_11419 = !((((*(*C_11418).Typ).flags &(1<<((((NU8) 1))&7)))!=0));
return Result_11419;
}
static N_INLINE(void, Rtladdcycleroot_12052)(TY10602* C_12054) {
Incl_10880(&Gch_11014.Cycleroots, C_12054);
}
static N_INLINE(void, Incref_13002)(TY10602* C_13004) {
NI LOC1;
NIM_BOOL LOC3;
LOC1 = Atomicinc_3221(&(*C_13004).Refcount, 8);
LOC3 = Canbecycleroot_11416(C_13004);
if (!LOC3) goto LA4;
Rtladdcycleroot_12052(C_13004);
LA4: ;
}
static N_INLINE(TY10602*, Usrtocell_11412)(void* Usr_11414) {
TY10602* Result_11415;
Result_11415 = 0;
Result_11415 = ((TY10602*) ((NI64)((NU64)(((NI) (Usr_11414))) - (NU64)(((NI) (((NI)sizeof(TY10602))))))));
return Result_11415;
}
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230) {
NI Result_8006;
Result_8006 = 0;
(*Memloc_3229) -= X_3230;
Result_8006 = (*Memloc_3229);
return Result_8006;
}
static N_INLINE(void, Rtladdzct_12401)(TY10602* C_12403) {
Addzct_11401(&Gch_11014.Zct, C_12403);
}
static N_INLINE(void, Decref_12801)(TY10602* C_12803) {
NI LOC2;
NIM_BOOL LOC5;
LOC2 = Atomicdec_3226(&(*C_12803).Refcount, 8);
if (!((NU64)(LOC2) < (NU64)(8))) goto LA3;
Rtladdzct_12401(C_12803);
goto LA1;
LA3: ;
LOC5 = Canbecycleroot_11416(C_12803);
if (!LOC5) goto LA6;
Rtladdcycleroot_12052(C_12803);
goto LA1;
LA6: ;
LA1: ;
}
static N_INLINE(void, asgnRef)(void** Dest_13014, void* Src_13015) {
TY10602* LOC4;
TY10602* LOC8;
if (!!((Src_13015 == NIM_NIL))) goto LA2;
LOC4 = Usrtocell_11412(Src_13015);
Incref_13002(LOC4);
LA2: ;
if (!!(((*Dest_13014) == NIM_NIL))) goto LA6;
LOC8 = Usrtocell_11412((*Dest_13014));
Decref_12801(LOC8);
LA6: ;
(*Dest_13014) = Src_13015;
}
N_NIMCALL(void, Strtablerawinsert_57256)(TY50528** Data_57259, TY50548* N_57260) {
NI H_57261;
NimStringDesc* LOC5;
H_57261 = 0;
H_57261 = (NI64)((*(*N_57260).Name).H & ((*Data_57259)->Sup.len-1));
while (1) {
if (!!(((*Data_57259)->data[H_57261] == NIM_NIL))) goto LA1;
if (!((*Data_57259)->data[H_57261] == N_57260)) goto LA3;
LOC5 = 0;
LOC5 = rawNewString((*(*N_57260).Name).S->Sup.len + 19);
appendString(LOC5, ((NimStringDesc*) &TMP191609));
appendString(LOC5, (*(*N_57260).Name).S);
Internalerror_43159((*N_57260).Info, LOC5);
LA3: ;
H_57261 = Nexttry_55205(H_57261, ((*Data_57259)->Sup.len-1));
} LA1: ;
asgnRef((void**) &(*Data_57259)->data[H_57261], N_57260);
}
N_NIMCALL(void, Strtableenlarge_57293)(TY50530* T_57296) {
TY50528* N_57297;
NI I_57328;
NI HEX3Atmp_57350;
NI Res_57352;
TY50528* LOC5;
N_57297 = 0;
N_57297 = (TY50528*) newSeq(NTI50528, (NI64)((*T_57296).Data->Sup.len * 2));
I_57328 = 0;
HEX3Atmp_57350 = 0;
HEX3Atmp_57350 = ((*T_57296).Data->Sup.len-1);
Res_57352 = 0;
Res_57352 = 0;
while (1) {
if (!(Res_57352 <= HEX3Atmp_57350)) goto LA1;
I_57328 = Res_57352;
if (!!(((*T_57296).Data->data[I_57328] == NIM_NIL))) goto LA3;
Strtablerawinsert_57256(&N_57297, (*T_57296).Data->data[I_57328]);
LA3: ;
Res_57352 += 1;
} LA1: ;
LOC5 = 0;
LOC5 = (*T_57296).Data;
unsureAsgnRef((void**) &(*T_57296).Data, N_57297);
N_57297 = LOC5;
}
N_NIMCALL(void, Strtableadd_55061)(TY50530* T_55064, TY50548* N_55065) {
NIM_BOOL LOC2;
LOC2 = Mustrehash_55201((*T_55064).Data->Sup.len, (*T_55064).Counter);
if (!LOC2) goto LA3;
Strtableenlarge_57293(T_55064);
LA3: ;
Strtablerawinsert_57256(&(*T_55064).Data, N_55065);
(*T_55064).Counter += 1;
}
N_NIMCALL(TY50548*, Nextiter_55078)(TY55071* Ti_55081, TY50530* Tab_55082) {
TY50548* Result_57500;
Result_57500 = 0;
Result_57500 = NIM_NIL;
while (1) {
if (!((*Ti_55081).H <= ((*Tab_55082).Data->Sup.len-1))) goto LA1;
Result_57500 = (*Tab_55082).Data->data[(*Ti_55081).H];
(*Ti_55081).H += 1;
if (!!((Result_57500 == NIM_NIL))) goto LA3;
goto LA1;
LA3: ;
} LA1: ;
return Result_57500;
}
N_NIMCALL(TY50548*, Inittabiter_55073)(TY55071* Ti_55076, TY50530* Tab_55077) {
TY50548* Result_57492;
Result_57492 = 0;
(*Ti_55076).H = 0;
if (!((*Tab_55077).Counter == 0)) goto LA2;
Result_57492 = NIM_NIL;
goto LA1;
LA2: ;
Result_57492 = Nextiter_55078(Ti_55076, Tab_55077);
LA1: ;
return Result_57492;
}
N_NIMCALL(NI, Iitablerawget_58101)(TY55215 T_58103, NI Key_58104) {
NI Result_58105;
NI H_58106;
Result_58105 = 0;
H_58106 = 0;
H_58106 = (NI64)(Key_58104 & (T_58103.Data->Sup.len-1));
while (1) {
if (!!((T_58103.Data->data[H_58106].Key == (IL64(-9223372036854775807) - IL64(1))))) goto LA1;
if (!(T_58103.Data->data[H_58106].Key == Key_58104)) goto LA3;
Result_58105 = H_58106;
goto BeforeRet;
LA3: ;
H_58106 = Nexttry_55205(H_58106, (T_58103.Data->Sup.len-1));
} LA1: ;
Result_58105 = -1;
BeforeRet: ;
return Result_58105;
}
N_NIMCALL(void, Iitablerawinsert_58119)(TY55213** Data_58122, NI Key_58123, NI Val_58124) {
NI H_58125;
H_58125 = 0;
H_58125 = (NI64)(Key_58123 & ((*Data_58122)->Sup.len-1));
while (1) {
if (!!(((*Data_58122)->data[H_58125].Key == (IL64(-9223372036854775807) - IL64(1))))) goto LA1;
H_58125 = Nexttry_55205(H_58125, ((*Data_58122)->Sup.len-1));
} LA1: ;
(*Data_58122)->data[H_58125].Key = Key_58123;
(*Data_58122)->data[H_58125].Val = Val_58124;
}
N_NIMCALL(void, Iitableput_55228)(TY55215* T_55231, NI Key_55232, NI Val_55233) {
NI Index_58138;
NIM_BOOL LOC5;
TY55213* N_58153;
NI I_58184;
NI HEX3Atmp_58219;
NI Res_58221;
NI I_58193;
NI HEX3Atmp_58222;
NI Res_58224;
TY55213* LOC13;
Index_58138 = 0;
Index_58138 = Iitablerawget_58101((*T_55231), Key_55232);
if (!(0 <= Index_58138)) goto LA2;
(*T_55231).Data->data[Index_58138].Val = Val_55233;
goto LA1;
LA2: ;
LOC5 = Mustrehash_55201((*T_55231).Data->Sup.len, (*T_55231).Counter);
if (!LOC5) goto LA6;
N_58153 = 0;
N_58153 = (TY55213*) newSeq(NTI55213, (NI64)((*T_55231).Data->Sup.len * 2));
I_58184 = 0;
HEX3Atmp_58219 = 0;
HEX3Atmp_58219 = (N_58153->Sup.len-1);
Res_58221 = 0;
Res_58221 = 0;
while (1) {
if (!(Res_58221 <= HEX3Atmp_58219)) goto LA8;
I_58184 = Res_58221;
N_58153->data[I_58184].Key = (IL64(-9223372036854775807) - IL64(1));
Res_58221 += 1;
} LA8: ;
I_58193 = 0;
HEX3Atmp_58222 = 0;
HEX3Atmp_58222 = ((*T_55231).Data->Sup.len-1);
Res_58224 = 0;
Res_58224 = 0;
while (1) {
if (!(Res_58224 <= HEX3Atmp_58222)) goto LA9;
I_58193 = Res_58224;
if (!!(((*T_55231).Data->data[I_58193].Key == (IL64(-9223372036854775807) - IL64(1))))) goto LA11;
Iitablerawinsert_58119(&N_58153, (*T_55231).Data->data[I_58193].Key, (*T_55231).Data->data[I_58193].Val);
LA11: ;
Res_58224 += 1;
} LA9: ;
LOC13 = 0;
LOC13 = (*T_55231).Data;
unsureAsgnRef((void**) &(*T_55231).Data, N_58153);
N_58153 = LOC13;
LA6: ;
Iitablerawinsert_58119(&(*T_55231).Data, Key_55232, Val_55233);
(*T_55231).Counter += 1;
LA1: ;
}
N_NIMCALL(NI, Idtablerawget_57732)(TY50564 T_57734, NI Key_57735) {
NI Result_57736;
NI H_57737;
Result_57736 = 0;
H_57737 = 0;
H_57737 = (NI64)(Key_57735 & (T_57734.Data->Sup.len-1));
while (1) {
if (!!((T_57734.Data->data[H_57737].Key == NIM_NIL))) goto LA1;
if (!((*T_57734.Data->data[H_57737].Key).Id == Key_57735)) goto LA3;
Result_57736 = H_57737;
goto BeforeRet;
LA3: ;
H_57737 = Nexttry_55205(H_57737, (T_57734.Data->Sup.len-1));
} LA1: ;
Result_57736 = -1;
BeforeRet: ;
return Result_57736;
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13018, void* Src_13019) {
TY10602* C_13020;
NI LOC4;
TY10602* C_13022;
NI LOC9;
if (!!((Src_13019 == NIM_NIL))) goto LA2;
C_13020 = 0;
C_13020 = Usrtocell_11412(Src_13019);
LOC4 = Atomicinc_3221(&(*C_13020).Refcount, 8);
LA2: ;
if (!!(((*Dest_13018) == NIM_NIL))) goto LA6;
C_13022 = 0;
C_13022 = Usrtocell_11412((*Dest_13018));
LOC9 = Atomicdec_3226(&(*C_13022).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
Rtladdzct_12401(C_13022);
LA10: ;
LA6: ;
(*Dest_13018) = Src_13019;
}
N_NIMCALL(void, Idtablerawinsert_57784)(TY50562** Data_57787, TY49005* Key_57788, TNimObject* Val_57789) {
NI H_57790;
H_57790 = 0;
H_57790 = (NI64)((*Key_57788).Id & ((*Data_57787)->Sup.len-1));
while (1) {
if (!!(((*Data_57787)->data[H_57790].Key == NIM_NIL))) goto LA1;
H_57790 = Nexttry_55205(H_57790, ((*Data_57787)->Sup.len-1));
} LA1: ;
asgnRefNoCycle((void**) &(*Data_57787)->data[H_57790].Key, Key_57788);
asgnRefNoCycle((void**) &(*Data_57787)->data[H_57790].Val, Val_57789);
}
N_NIMCALL(void, Idtableput_55166)(TY50564* T_55169, TY49005* Key_55170, TNimObject* Val_55171) {
NI Index_57821;
TY50562* N_57822;
NIM_BOOL LOC5;
NI I_57876;
NI HEX3Atmp_57911;
NI Res_57913;
TY50562* LOC12;
Index_57821 = 0;
N_57822 = 0;
Index_57821 = Idtablerawget_57732((*T_55169), (*Key_55170).Id);
if (!(0 <= Index_57821)) goto LA2;
asgnRefNoCycle((void**) &(*T_55169).Data->data[Index_57821].Val, Val_55171);
goto LA1;
LA2: ;
LOC5 = Mustrehash_55201((*T_55169).Data->Sup.len, (*T_55169).Counter);
if (!LOC5) goto LA6;
N_57822 = (TY50562*) newSeq(NTI50562, (NI64)((*T_55169).Data->Sup.len * 2));
I_57876 = 0;
HEX3Atmp_57911 = 0;
HEX3Atmp_57911 = ((*T_55169).Data->Sup.len-1);
Res_57913 = 0;
Res_57913 = 0;
while (1) {
if (!(Res_57913 <= HEX3Atmp_57911)) goto LA8;
I_57876 = Res_57913;
if (!!(((*T_55169).Data->data[I_57876].Key == NIM_NIL))) goto LA10;
Idtablerawinsert_57784(&N_57822, (*T_55169).Data->data[I_57876].Key, (*T_55169).Data->data[I_57876].Val);
LA10: ;
Res_57913 += 1;
} LA8: ;
LOC12 = 0;
LOC12 = (*T_55169).Data;
unsureAsgnRef((void**) &(*T_55169).Data, N_57822);
N_57822 = LOC12;
LA6: ;
Idtablerawinsert_57784(&(*T_55169).Data, Key_55170, Val_55171);
(*T_55169).Counter += 1;
LA1: ;
}
N_NIMCALL(TNimObject*, Idtableget_55162)(TY50564 T_55164, NI Key_55165) {
TNimObject* Result_57780;
NI Index_57781;
Result_57780 = 0;
Index_57781 = 0;
Index_57781 = Idtablerawget_57732(T_55164, Key_55165);
if (!(0 <= Index_57781)) goto LA2;
Result_57780 = T_55164.Data->data[Index_57781].Val;
goto LA1;
LA2: ;
Result_57780 = NIM_NIL;
LA1: ;
return Result_57780;
}
N_NIMCALL(NI, Iitableget_55224)(TY55215 T_55226, NI Key_55227) {
NI Result_58115;
NI Index_58116;
Result_58115 = 0;
Index_58116 = 0;
Index_58116 = Iitablerawget_58101(T_55226, Key_55227);
if (!(0 <= Index_58116)) goto LA2;
Result_58115 = T_55226.Data->data[Index_58116].Val;
goto LA1;
LA2: ;
Result_58115 = (IL64(-9223372036854775807) - IL64(1));
LA1: ;
return Result_58115;
}
N_NIMCALL(void, Initsymtab_55103)(TY55099* Tab_55106) {
(*Tab_55106).Tos = 0;
unsureAsgnRef((void**) &(*Tab_55106).Stack, (TY55101*) newSeq(NTI55101, 0));
}
N_NIMCALL(TY50548*, Symtabget_55111)(TY55099 Tab_55113, TY49011* S_55114) {
TY50548* Result_57543;
NI I_57566;
NI HEX3Atmp_57578;
NI Res_57580;
Result_57543 = 0;
I_57566 = 0;
HEX3Atmp_57578 = 0;
HEX3Atmp_57578 = (NI64)(((NI) (Tab_55113.Tos)) - 1);
Res_57580 = 0;
Res_57580 = HEX3Atmp_57578;
while (1) {
if (!(0 <= Res_57580)) goto LA1;
I_57566 = Res_57580;
Result_57543 = Strtableget_55066(&Tab_55113.Stack->data[I_57566], S_55114);
if (!!((Result_57543 == NIM_NIL))) goto LA3;
goto BeforeRet;
LA3: ;
Res_57580 -= 1;
} LA1: ;
Result_57543 = NIM_NIL;
BeforeRet: ;
return Result_57543;
}
N_NIMCALL(TY50548*, Getmodule_55198)(TY50548* S_55200) {
TY50548* Result_55409;
NIM_BOOL LOC2;
Result_55409 = 0;
Result_55409 = S_55200;
while (1) {
LOC2 = !((Result_55409 == NIM_NIL));
if (!(LOC2)) goto LA3;
LOC2 = !(((*Result_55409).Kind == ((NU8) 6)));
LA3: ;
if (!LOC2) goto LA1;
Result_55409 = (*Result_55409).Owner;
} LA1: ;
return Result_55409;
}
N_NIMCALL(TY50548*, Nextidentiter_55093)(TY55084* Ti_55096, TY50530* Tab_55097) {
TY50548* Result_57469;
NI H_57470;
NI Start_57471;
Result_57469 = 0;
H_57470 = 0;
Start_57471 = 0;
H_57470 = (NI64)((*Ti_55096).H & ((*Tab_55097).Data->Sup.len-1));
Start_57471 = H_57470;
Result_57469 = (*Tab_55097).Data->data[H_57470];
while (1) {
if (!!((Result_57469 == NIM_NIL))) goto LA1;
if (!((*(*Result_57469).Name).Sup.Id == (*(*Ti_55096).Name).Sup.Id)) goto LA3;
goto LA1;
LA3: ;
H_57470 = Nexttry_55205(H_57470, ((*Tab_55097).Data->Sup.len-1));
if (!(H_57470 == Start_57471)) goto LA6;
Result_57469 = NIM_NIL;
goto LA1;
LA6: ;
Result_57469 = (*Tab_55097).Data->data[H_57470];
} LA1: ;
(*Ti_55096).H = Nexttry_55205(H_57470, ((*Tab_55097).Data->Sup.len-1));
return Result_57469;
}
N_NIMCALL(TY50548*, Initidentiter_55087)(TY55084* Ti_55090, TY50530* Tab_55091, TY49011* S_55092) {
TY50548* Result_57461;
Result_57461 = 0;
(*Ti_55090).H = (*S_55092).H;
unsureAsgnRef((void**) &(*Ti_55090).Name, S_55092);
if (!((*Tab_55091).Counter == 0)) goto LA2;
Result_57461 = NIM_NIL;
goto LA1;
LA2: ;
Result_57461 = Nextidentiter_55093(Ti_55090, Tab_55091);
LA1: ;
return Result_57461;
}
N_NIMCALL(NI, Idnodetablerawget_57917)(TY50570 T_57919, TY49005* Key_57920) {
NI Result_57921;
NI H_57922;
Result_57921 = 0;
H_57922 = 0;
H_57922 = (NI64)((*Key_57920).Id & (T_57919.Data->Sup.len-1));
while (1) {
if (!!((T_57919.Data->data[H_57922].Key == NIM_NIL))) goto LA1;
if (!((*T_57919.Data->data[H_57922].Key).Id == (*Key_57920).Id)) goto LA3;
Result_57921 = H_57922;
goto BeforeRet;
LA3: ;
H_57922 = Nexttry_55205(H_57922, (T_57919.Data->Sup.len-1));
} LA1: ;
Result_57921 = -1;
BeforeRet: ;
return Result_57921;
}
N_NIMCALL(TY50526*, Idnodetableget_55176)(TY50570 T_55178, TY49005* Key_55179) {
TY50526* Result_57940;
NI Index_57941;
Result_57940 = 0;
Index_57941 = 0;
Index_57941 = Idnodetablerawget_57917(T_55178, Key_55179);
if (!(0 <= Index_57941)) goto LA2;
Result_57940 = T_55178.Data->data[Index_57941].Val;
goto LA1;
LA2: ;
Result_57940 = NIM_NIL;
LA1: ;
return Result_57940;
}
N_NIMCALL(void, Idnodetablerawinsert_57944)(TY50568** Data_57947, TY49005* Key_57948, TY50526* Val_57949) {
NI H_57950;
H_57950 = 0;
H_57950 = (NI64)((*Key_57948).Id & ((*Data_57947)->Sup.len-1));
while (1) {
if (!!(((*Data_57947)->data[H_57950].Key == NIM_NIL))) goto LA1;
H_57950 = Nexttry_55205(H_57950, ((*Data_57947)->Sup.len-1));
} LA1: ;
asgnRefNoCycle((void**) &(*Data_57947)->data[H_57950].Key, Key_57948);
asgnRefNoCycle((void**) &(*Data_57947)->data[H_57950].Val, Val_57949);
}
N_NIMCALL(void, Idnodetableput_55180)(TY50570* T_55183, TY49005* Key_55184, TY50526* Val_55185) {
NI Index_57981;
NIM_BOOL LOC5;
TY50568* N_58005;
NI I_58036;
NI HEX3Atmp_58071;
NI Res_58073;
TY50568* LOC12;
Index_57981 = 0;
Index_57981 = Idnodetablerawget_57917((*T_55183), Key_55184);
if (!(0 <= Index_57981)) goto LA2;
asgnRefNoCycle((void**) &(*T_55183).Data->data[Index_57981].Val, Val_55185);
goto LA1;
LA2: ;
LOC5 = Mustrehash_55201((*T_55183).Data->Sup.len, (*T_55183).Counter);
if (!LOC5) goto LA6;
N_58005 = 0;
N_58005 = (TY50568*) newSeq(NTI50568, (NI64)((*T_55183).Data->Sup.len * 2));
I_58036 = 0;
HEX3Atmp_58071 = 0;
HEX3Atmp_58071 = ((*T_55183).Data->Sup.len-1);
Res_58073 = 0;
Res_58073 = 0;
while (1) {
if (!(Res_58073 <= HEX3Atmp_58071)) goto LA8;
I_58036 = Res_58073;
if (!!(((*T_55183).Data->data[I_58036].Key == NIM_NIL))) goto LA10;
Idnodetablerawinsert_57944(&N_58005, (*T_55183).Data->data[I_58036].Key, (*T_55183).Data->data[I_58036].Val);
LA10: ;
Res_58073 += 1;
} LA8: ;
LOC12 = 0;
LOC12 = (*T_55183).Data;
unsureAsgnRef((void**) &(*T_55183).Data, N_58005);
N_58005 = LOC12;
LA6: ;
Idnodetablerawinsert_57944(&(*T_55183).Data, Key_55184, Val_55185);
(*T_55183).Counter += 1;
LA1: ;
}
static N_INLINE(NI, Sonslen_50804)(TY50526* N_50806) {
NI Result_51880;
Result_51880 = 0;
if (!(*N_50806).KindU.S6.Sons == 0) goto LA2;
Result_51880 = 0;
goto LA1;
LA2: ;
Result_51880 = (*N_50806).KindU.S6.Sons->Sup.len;
LA1: ;
return Result_51880;
}
N_NIMCALL(TY50548*, Getsymfromlist_55189)(TY50526* List_55191, TY49011* Ident_55192, NI Start_55193) {
TY50548* Result_55453;
NI I_55462;
NI HEX3Atmp_55510;
NI LOC1;
NI Res_55512;
Result_55453 = 0;
I_55462 = 0;
HEX3Atmp_55510 = 0;
LOC1 = Sonslen_50804(List_55191);
HEX3Atmp_55510 = (NI64)(LOC1 - 1);
Res_55512 = 0;
Res_55512 = Start_55193;
while (1) {
if (!(Res_55512 <= HEX3Atmp_55510)) goto LA2;
I_55462 = Res_55512;
if (!!(((*(*List_55191).KindU.S6.Sons->data[I_55462]).Kind == ((NU8) 3)))) goto LA4;
Internalerror_43159((*List_55191).Info, ((NimStringDesc*) &TMP192067));
LA4: ;
Result_55453 = (*(*List_55191).KindU.S6.Sons->data[I_55462]).KindU.S4.Sym;
if (!((*(*Result_55453).Name).Sup.Id == (*Ident_55192).Sup.Id)) goto LA7;
goto BeforeRet;
LA7: ;
Res_55512 += 1;
} LA2: ;
Result_55453 = NIM_NIL;
BeforeRet: ;
return Result_55453;
}
N_NIMCALL(TNimObject*, Idtableget_55158)(TY50564 T_55160, TY49005* Key_55161) {
TNimObject* Result_57772;
NI Index_57773;
Result_57772 = 0;
Index_57773 = 0;
Index_57773 = Idtablerawget_57732(T_55160, (*Key_55161).Id);
if (!(0 <= Index_57773)) goto LA2;
Result_57772 = T_55160.Data->data[Index_57773].Val;
goto LA1;
LA2: ;
Result_57772 = NIM_NIL;
LA1: ;
return Result_57772;
}
N_NIMCALL(void, Openscope_55141)(TY55099* Tab_55144) {
if (!((*Tab_55144).Stack->Sup.len <= ((NI) ((*Tab_55144).Tos)))) goto LA2;
(*Tab_55144).Stack = (TY55101*) setLengthSeq(&((*Tab_55144).Stack)->Sup, sizeof(TY50530), (NI64)(((NI) ((*Tab_55144).Tos)) + 1));
LA2: ;
Initstrtable_50747(&(*Tab_55144).Stack->data[(*Tab_55144).Tos]);
(*Tab_55144).Tos += 1;
}
N_NIMCALL(NIM_BOOL, Strtableincl_57381)(TY50530* T_57384, TY50548* N_57385) {
NIM_BOOL Result_57386;
NI H_57387;
TY50548* It_57388;
NIM_BOOL LOC9;
Result_57386 = 0;
H_57387 = 0;
It_57388 = 0;
H_57387 = (NI64)((*(*N_57385).Name).H & ((*T_57384).Data->Sup.len-1));
while (1) {
It_57388 = (*T_57384).Data->data[H_57387];
if (!(It_57388 == NIM_NIL)) goto LA3;
goto LA1;
LA3: ;
if (!((*(*It_57388).Name).Sup.Id == (*(*N_57385).Name).Sup.Id)) goto LA6;
asgnRef((void**) &(*T_57384).Data->data[H_57387], N_57385);
Result_57386 = NIM_TRUE;
goto BeforeRet;
LA6: ;
H_57387 = Nexttry_55205(H_57387, ((*T_57384).Data->Sup.len-1));
} LA1: ;
LOC9 = Mustrehash_55201((*T_57384).Data->Sup.len, (*T_57384).Counter);
if (!LOC9) goto LA10;
Strtableenlarge_57293(T_57384);
Strtablerawinsert_57256(&(*T_57384).Data, N_57385);
goto LA8;
LA10: ;
asgnRef((void**) &(*T_57384).Data->data[H_57387], N_57385);
LA8: ;
(*T_57384).Counter += 1;
Result_57386 = NIM_FALSE;
BeforeRet: ;
return Result_57386;
}
N_NIMCALL(NU8, Symtabadduniqueat_55135)(TY55099* Tab_55138, TY50548* E_55139, NI At_55140) {
NU8 Result_57600;
NIM_BOOL LOC2;
Result_57600 = 0;
LOC2 = Strtableincl_57381(&(*Tab_55138).Stack->data[At_55140], E_55139);
if (!LOC2) goto LA3;
Result_57600 = ((NU8) 0);
goto LA1;
LA3: ;
Result_57600 = ((NU8) 1);
LA1: ;
return Result_57600;
}
N_NIMCALL(NU8, Symtabaddunique_55130)(TY55099* Tab_55133, TY50548* E_55134) {
NU8 Result_57607;
Result_57607 = 0;
Result_57607 = Symtabadduniqueat_55135(Tab_55133, E_55134, ((NI) ((NI64)(((NI) ((*Tab_55133).Tos)) - 1))));
return Result_57607;
}
N_NIMCALL(void, Rawclosescope_55145)(TY55099* Tab_55148) {
(*Tab_55148).Tos -= 1;
}
N_NIMCALL(void, Symtabaddat_55124)(TY55099* Tab_55127, TY50548* E_55128, NI At_55129) {
Strtableadd_55061(&(*Tab_55127).Stack->data[At_55129], E_55128);
}
N_NIMCALL(TY50548*, Symtablocalget_55115)(TY55099 Tab_55117, TY49011* S_55118) {
TY50548* Result_57538;
Result_57538 = 0;
Result_57538 = Strtableget_55066(&Tab_55117.Stack->data[(NI64)(((NI) (Tab_55117.Tos)) - 1)], S_55118);
return Result_57538;
}
N_NIMCALL(void, Symtabadd_55119)(TY55099* Tab_55122, TY50548* E_55123) {
Strtableadd_55061(&(*Tab_55122).Stack->data[(NI64)(((NI) ((*Tab_55122).Tos)) - 1)], E_55123);
}
N_NIMCALL(NIM_BOOL, Idtablehasobjectaskey_55172)(TY50564 T_55174, TY49005* Key_55175) {
NIM_BOOL Result_57755;
NI Index_57756;
Result_57755 = 0;
Index_57756 = 0;
Index_57756 = Idtablerawget_57732(T_55174, (*Key_55175).Id);
if (!(0 <= Index_57756)) goto LA2;
Result_57755 = (T_55174.Data->data[Index_57756].Key == Key_55175);
goto LA1;
LA2: ;
Result_57755 = NIM_FALSE;
LA1: ;
return Result_57755;
}
static N_INLINE(TY50526*, Lastson_50810)(TY50526* N_50812) {
TY50526* Result_52841;
NI LOC1;
Result_52841 = 0;
LOC1 = Sonslen_50804(N_50812);
Result_52841 = (*N_50812).KindU.S6.Sons->data[(NI64)(LOC1 - 1)];
return Result_52841;
}
N_NIMCALL(TY50548*, Lookupinrecord_55194)(TY50526* N_55196, TY49011* Field_55197) {
TY50548* Result_55238;
NI I_55262;
NI HEX3Atmp_55400;
NI LOC1;
NI Res_55402;
NI I_55338;
NI HEX3Atmp_55403;
NI LOC12;
NI Res_55405;
TY50526* LOC14;
Result_55238 = 0;
Result_55238 = NIM_NIL;
switch ((*N_55196).Kind) {
case ((NU8) 113):
I_55262 = 0;
HEX3Atmp_55400 = 0;
LOC1 = Sonslen_50804(N_55196);
HEX3Atmp_55400 = (NI64)(LOC1 - 1);
Res_55402 = 0;
Res_55402 = 0;
while (1) {
if (!(Res_55402 <= HEX3Atmp_55400)) goto LA2;
I_55262 = Res_55402;
Result_55238 = Lookupinrecord_55194((*N_55196).KindU.S6.Sons->data[I_55262], Field_55197);
if (!!((Result_55238 == NIM_NIL))) goto LA4;
goto BeforeRet;
LA4: ;
Res_55402 += 1;
} LA2: ;
break;
case ((NU8) 114):
if (!!(((*(*N_55196).KindU.S6.Sons->data[0]).Kind == ((NU8) 3)))) goto LA7;
Internalerror_43159((*N_55196).Info, ((NimStringDesc*) &TMP192687));
LA7: ;
Result_55238 = Lookupinrecord_55194((*N_55196).KindU.S6.Sons->data[0], Field_55197);
if (!!((Result_55238 == NIM_NIL))) goto LA10;
goto BeforeRet;
LA10: ;
I_55338 = 0;
HEX3Atmp_55403 = 0;
LOC12 = Sonslen_50804(N_55196);
HEX3Atmp_55403 = (NI64)(LOC12 - 1);
Res_55405 = 0;
Res_55405 = 1;
while (1) {
if (!(Res_55405 <= HEX3Atmp_55403)) goto LA13;
I_55338 = Res_55405;
switch ((*(*N_55196).KindU.S6.Sons->data[I_55338]).Kind) {
case ((NU8) 75):
case ((NU8) 78):
LOC14 = 0;
LOC14 = Lastson_50810((*N_55196).KindU.S6.Sons->data[I_55338]);
Result_55238 = Lookupinrecord_55194(LOC14, Field_55197);
if (!!((Result_55238 == NIM_NIL))) goto LA16;
goto BeforeRet;
LA16: ;
break;
default:
Internalerror_43159((*N_55196).Info, ((NimStringDesc*) &TMP192688));
break;
}
Res_55405 += 1;
} LA13: ;
break;
case ((NU8) 3):
if (!((*(*(*N_55196).KindU.S4.Sym).Name).Sup.Id == (*Field_55197).Sup.Id)) goto LA19;
Result_55238 = (*N_55196).KindU.S4.Sym;
LA19: ;
break;
default:
Internalerror_43159((*N_55196).Info, ((NimStringDesc*) &TMP192689));
break;
}
BeforeRet: ;
return Result_55238;
}
N_NOINLINE(void, astalgoInit)(void) {
}

