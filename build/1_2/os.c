/* Generated by Nimrod Compiler v0.8.9 */
/*   (c) 2010 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

#include <errno.h>
#include <string.h>
typedef struct TY4177 TY4177;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY10402 TY10402;
typedef struct TY7804 TY7804;
typedef struct TY10790 TY10790;
typedef struct TY10418 TY10418;
typedef struct TY10414 TY10414;
typedef struct TY10410 TY10410;
typedef struct TY10788 TY10788;
typedef struct TY32378 TY32378;
typedef struct TY32515 TY32515;
typedef struct TY422 TY422;
typedef struct TY418 TY418;
typedef struct TY416 TY416;
typedef struct E_Base E_Base;
typedef struct TNimObject TNimObject;
typedef struct TY26598 TY26598;
typedef struct TY26596 TY26596;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY10402 {
NI Refcount;
TNimType* Typ;
};
typedef N_STDCALL_PTR(void, TY7816) (TY7804* L_7818);
struct TY10418 {
NI Len;
NI Cap;
TY10402** D;
};
struct TY10414 {
NI Counter;
NI Max;
TY10410* Head;
TY10410** Data;
};
struct TY7804 {
void* Debuginfo;
NI32 Lockcount;
NI32 Recursioncount;
NI Owningthread;
NI Locksemaphore;
NI32 Reserved;
};
struct TY10788 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY10790 {
TY10418 Zct;
TY10418 Decstack;
TY10414 Cycleroots;
TY10418 Tempstack;
TY7804 Cyclerootslock;
TY7804 Zctlock;
TY10788 Stat;
};
typedef N_STDCALL_PTR(void, TY7820) (TY7804* L_7822);
typedef N_STDCALL_PTR(NCSTRING, TY26648) (void);
typedef N_STDCALL_PTR(NI32, TY26650) (NCSTRING Para1_26651);
struct TY32378 {
NimStringDesc* Head;
NimStringDesc* Tail;
};
struct TY32515 {
NimStringDesc* Dir;
NimStringDesc* Name;
NimStringDesc* Ext;
};
typedef N_STDCALL_PTR(NI32, TY26583) (NI Handle_26584, NCSTRING Buf_26585, NI32 Size_26586);
typedef N_STDCALL_PTR(NI32, TY26565) (NI32 Nbufferlength_26566, NCSTRING Lpbuffer_26567);
typedef N_STDCALL_PTR(NI32, TY26551) (void);
typedef N_STDCALL_PTR(NI32, TY26553) (NI32 Dwflags_26554, void* Lpsource_26555, NI32 Dwmessageid_26556, NI32 Dwlanguageid_26557, void* Lpbuffer_26558, NI32 Nsize_26559, void* Arguments_26560);
typedef N_STDCALL_PTR(void, TY26562) (void* P_26563);
struct TNimObject {
TNimType* m_type;
};
struct E_Base {
  TNimObject Sup;
E_Base* parent;
NCSTRING name;
NimStringDesc* message;
};
struct TY416 {
  E_Base Sup;
};
struct TY418 {
  TY416 Sup;
};
struct TY422 {
  TY418 Sup;
};
typedef N_STDCALL_PTR(NI32, TY26572) (NCSTRING Pathname_26573, void* Security_26574);
typedef N_STDCALL_PTR(NI32, TY26636) (NCSTRING Lpfilename_26637);
typedef N_STDCALL_PTR(void, TY26667) (NI32 Dwmilliseconds_26668);
typedef N_STDCALL_PTR(NI32, TY26579) (NCSTRING Lpname_26580, NCSTRING Lpvalue_26581);
struct TY26596 {
NI32 Dwlowdatetime;
NI32 Dwhighdatetime;
};
typedef NIM_CHAR TY26609[260];
typedef NIM_CHAR TY26612[14];
struct TY26598 {
NI32 Dwfileattributes;
TY26596 Ftcreationtime;
TY26596 Ftlastaccesstime;
TY26596 Ftlastwritetime;
NI32 Nfilesizehigh;
NI32 Nfilesizelow;
NI32 Dwreserved0;
NI32 Dwreserved1;
TY26609 Cfilename;
TY26612 Calternatefilename;
};
typedef N_STDCALL_PTR(NI, TY26616) (NCSTRING Lpfilename_26617, TY26598* Lpfindfiledata_26619);
typedef N_STDCALL_PTR(void, TY26626) (NI Hfindfile_26627);
typedef N_STDCALL_PTR(NCSTRING, TY26653) (void);
typedef NI TY8414[8];
struct TY10410 {
TY10410* Next;
NI Key;
TY8414 Bits;
};
struct TY4177 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
N_NIMCALL(void*, newSeq)(TNimType* Typ_12604, NI Len_12605);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11618, void* Src_11619);
static N_INLINE(TY10402*, Usrtocell_10836)(void* Usr_10838);
static N_INLINE(NI, Atomicinc_2801)(NI* Memloc_2804, NI X_2805);
static N_INLINE(NI, Atomicdec_2806)(NI* Memloc_2809, NI X_2810);
static N_INLINE(void, Rtladdzct_11458)(TY10402* C_11460);
N_NOINLINE(void, Addzct_10825)(TY10418* S_10828, TY10402* C_10829);
N_NIMCALL(NI, Findenvvar_33402)(NimStringDesc* Key_33404);
N_NIMCALL(void, Getenvvarsc_33243)(void);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING Str_17104);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* Seq_17235, NI Elemsize_17236);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_17108);
static N_INLINE(NI, addInt)(NI A_5603, NI B_5604);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(void, appendString)(NimStringDesc* Dest_17192, NimStringDesc* Src_17193);
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17209, NIM_CHAR C_17210);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_17087);
N_NIMCALL(NIM_BOOL, nsuStartsWith)(NimStringDesc* S_23769, NimStringDesc* Prefix_23770);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* S_1748, NI First_1749);
N_NIMCALL(NI, nsuFindChar)(NimStringDesc* S_24227, NIM_CHAR Sub_24228, NI Start_24229);
N_NIMCALL(NI, Searchextpos_32478)(NimStringDesc* S_32480);
static N_INLINE(NI, subInt)(NI A_5803, NI B_5804);
N_NIMCALL(NimStringDesc*, Normext_32468)(NimStringDesc* Ext_32470);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* S_1752, NI First_1753, NI Last_1754);
N_NIMCALL(void, unsureAsgnRef)(void** Dest_11626, void* Src_11627);
N_NIMCALL(void, nossplitFile)(NimStringDesc* Path_32514, TY32515* Result);
N_NIMCALL(NimStringDesc*, nosgetApplicationFilename)(void);
N_NIMCALL(NimStringDesc*, mnewString)(NI Len_1349);
N_NIMCALL(NimStringDesc*, setLengthStr)(NimStringDesc* S_17225, NI Newlen_17226);
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_30004);
N_NIMCALL(void*, newObj)(TNimType* Typ_12107, NI Size_12108);
N_NIMCALL(void, raiseException)(E_Base* E_5004, NCSTRING Ename_5005);
N_NIMCALL(NimStringDesc*, nosJoinPath)(NimStringDesc* Head_32203, NimStringDesc* Tail_32204);
N_NIMCALL(void, Rawcreatedir_34219)(NimStringDesc* Dir_34221);
N_NIMCALL(void, nosSplitPath)(NimStringDesc* Path_32377, TY32378* Result);
static N_INLINE(NI, divInt)(NI A_6203, NI B_6204);
N_NOINLINE(void, raiseDivByZero)(void);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* S_1603, NIM_CHAR C_1604);
static N_INLINE(NI, modInt)(NI A_6403, NI B_6404);
static N_INLINE(NI, chckRange)(NI I_4410, NI A_4411, NI B_4412);
N_NOINLINE(void, raiseRangeError)(NI64 Val_5218);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* Dest_17182, NI Addlen_17183);
N_NIMCALL(NimStringDesc*, Getenv_33425)(NimStringDesc* Key_33427);
static N_INLINE(NIM_BOOL, eqStrings)(NimStringDesc* A_17047, NimStringDesc* B_17048);
N_NIMCALL(NI, noscmpPaths)(NimStringDesc* Patha_32865, NimStringDesc* Pathb_32866);
N_NIMCALL(NI, Cmp_1321)(NimStringDesc* X_1323, NimStringDesc* Y_1324);
N_NIMCALL(NI, nsuCmpIgnoreCase)(NimStringDesc* A_22595, NimStringDesc* B_22596);
N_NIMCALL(NI64, ntDiffTime)(NI32 A_27435, NI32 B_27436);
N_NIMCALL(NI32, nosgetLastModificationTime)(NimStringDesc* File_31203);
N_NIMCALL(NI32, Wintimetounixtime_28261)(NI64 T_28263);
N_NIMCALL(NI64, Rdfiletime_26654)(TY26596 F_26656);
N_NIMCALL(TY4177*, nosparseCmdLine)(NimStringDesc* C_34434);
STRING_LITERAL(TMP39351, "", 0);
STRING_LITERAL(TMP40220, "unknown OS error", 16);
STRING_LITERAL(TMP67416, "C:\\", 3);
STRING_LITERAL(TMP67417, ".", 1);
STRING_LITERAL(TMP67418, "..\\", 3);
STRING_LITERAL(TMP74535, "APPDATA", 7);
STRING_LITERAL(TMP74536, "\\", 1);
NIM_BOOL Envcomputed_33220;
TY4177* Environment_33238;
extern TNimType* NTI4177; /* seq[string] */
extern TY7816 Dl_7815;
extern TY10790 Gch_10810;
extern TY7820 Dl_7819;
TY4177* Ownargv_35402;
extern TY26648 Dl_26647;
extern TY26650 Dl_26649;
extern TY26583 Dl_26582;
extern TY26565 Dl_26564;
extern TY26551 Dl_26550;
extern TY26553 Dl_26552;
extern TY26562 Dl_26561;
extern TNimType* NTI30017; /* ref EOS */
extern TNimType* NTI422; /* EOS */
extern TY26572 Dl_26571;
extern TY26636 Dl_26635;
extern TY26667 Dl_26666;
extern TY26579 Dl_26578;
extern TY26616 Dl_26615;
extern TY26626 Dl_26625;
extern TY26653 Dl_26652;
static N_INLINE(TY10402*, Usrtocell_10836)(void* Usr_10838) {
TY10402* Result_10839;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "usrToCell";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_10839 = 0;
F.line = 100;F.filename = "gc.nim";
Result_10839 = ((TY10402*) ((NI64)((NU64)(((NI) (Usr_10838))) - (NU64)(((NI) (((NI)sizeof(TY10402))))))));
framePtr = framePtr->prev;
return Result_10839;
}
static N_INLINE(NI, Atomicinc_2801)(NI* Memloc_2804, NI X_2805) {
NI Result_7208;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicInc";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7208 = 0;
F.line = 29;F.filename = "systhread.nim";
Result_7208 = __sync_add_and_fetch(Memloc_2804, X_2805);
framePtr = framePtr->prev;
return Result_7208;
}
static N_INLINE(NI, Atomicdec_2806)(NI* Memloc_2809, NI X_2810) {
NI Result_7406;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "atomicDec";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/systhread.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_7406 = 0;
F.line = 37;F.filename = "systhread.nim";
Result_7406 = __sync_sub_and_fetch(Memloc_2809, X_2810);
framePtr = framePtr->prev;
return Result_7406;
}
static N_INLINE(void, Rtladdzct_11458)(TY10402* C_11460) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rtlAddZCT";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 211;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA2;
F.line = 211;F.filename = "gc.nim";
Dl_7815(&Gch_10810.Zctlock);
LA2: ;
F.line = 212;F.filename = "gc.nim";
Addzct_10825(&Gch_10810.Zct, C_11460);
F.line = 213;F.filename = "gc.nim";
if (!NIM_TRUE) goto LA5;
F.line = 213;F.filename = "gc.nim";
Dl_7819(&Gch_10810.Zctlock);
LA5: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_11618, void* Src_11619) {
TY10402* C_11620;
NI LOC4;
TY10402* C_11622;
NI LOC9;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "asgnRefNoCycle";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/gc.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 244;F.filename = "gc.nim";
if (!!((Src_11619 == NIM_NIL))) goto LA2;
C_11620 = 0;
F.line = 245;F.filename = "gc.nim";
C_11620 = Usrtocell_10836(Src_11619);
F.line = 246;F.filename = "gc.nim";
LOC4 = Atomicinc_2801(&(*C_11620).Refcount, 8);
LA2: ;
F.line = 247;F.filename = "gc.nim";
if (!!(((*Dest_11618) == NIM_NIL))) goto LA6;
C_11622 = 0;
F.line = 248;F.filename = "gc.nim";
C_11622 = Usrtocell_10836((*Dest_11618));
F.line = 249;F.filename = "gc.nim";
LOC9 = Atomicdec_2806(&(*C_11622).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
F.line = 250;F.filename = "gc.nim";
Rtladdzct_11458(C_11622);
LA10: ;
LA6: ;
F.line = 251;F.filename = "gc.nim";
(*Dest_11618) = Src_11619;
framePtr = framePtr->prev;
}
static N_INLINE(NI, addInt)(NI A_5603, NI B_5604) {
NI Result_5605;
NIM_BOOL LOC2;
Result_5605 = 0;
Result_5605 = (NI64)((NU64)(A_5603) + (NU64)(B_5604));
LOC2 = (0 <= (NI64)(Result_5605 ^ A_5603));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5605 ^ B_5604));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5605;
}
N_NIMCALL(void, Getenvvarsc_33243)(void) {
NCSTRING Env_33245;
NCSTRING E_33246;
NCSTRING Eend_33247;
NimStringDesc* LOC8;
NI32 LOC12;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getEnvVarsC";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 692;F.filename = "os.nim";
if (!!(Envcomputed_33220)) goto LA2;
Env_33245 = 0;
F.line = 694;F.filename = "os.nim";
Env_33245 = Dl_26647();
E_33246 = 0;
F.line = 695;F.filename = "os.nim";
E_33246 = Env_33245;
F.line = 696;F.filename = "os.nim";
if (!(E_33246 == NIM_NIL)) goto LA5;
F.line = 696;F.filename = "os.nim";
goto BeforeRet;
LA5: ;
F.line = 697;F.filename = "os.nim";
while (1) {
Eend_33247 = 0;
F.line = 698;F.filename = "os.nim";
Eend_33247 = strchr(E_33246, ((NI32) 0));
F.line = 699;F.filename = "os.nim";
LOC8 = 0;
LOC8 = cstrToNimstr(E_33246);
Environment_33238 = (TY4177*) incrSeq(&(Environment_33238)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Environment_33238->data[Environment_33238->Sup.len-1], copyString(LOC8));
F.line = 700;F.filename = "os.nim";
E_33246 = ((NCSTRING) (addInt(((NI) (Eend_33247)), 1)));
F.line = 701;F.filename = "os.nim";
if (!((NU8)(Eend_33247[1]) == (NU8)(0))) goto LA10;
F.line = 701;F.filename = "os.nim";
goto LA7;
LA10: ;
} LA7: ;
F.line = 702;F.filename = "os.nim";
Envcomputed_33220 = NIM_TRUE;
F.line = 703;F.filename = "os.nim";
LOC12 = Dl_26649(Env_33245);
LA2: ;
BeforeRet: ;
framePtr = framePtr->prev;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_17192, NimStringDesc* Src_17193) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendString";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 150;F.filename = "sysstr.nim";
memcpy(((NCSTRING) (&(*Dest_17192).data[((*Dest_17192).Sup.len)-0])), ((NCSTRING) ((*Src_17193).data)), ((NI32) ((NI64)((NI64)((*Src_17193).Sup.len + 1) * 1))));
F.line = 151;F.filename = "sysstr.nim";
(*Dest_17192).Sup.len += (*Src_17193).Sup.len;
framePtr = framePtr->prev;
}
static N_INLINE(void, appendChar)(NimStringDesc* Dest_17209, NIM_CHAR C_17210) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "appendChar";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 154;F.filename = "sysstr.nim";
(*Dest_17209).data[((*Dest_17209).Sup.len)-0] = C_17210;
F.line = 155;F.filename = "sysstr.nim";
(*Dest_17209).data[((NI64)((*Dest_17209).Sup.len + 1))-0] = 0;
F.line = 156;F.filename = "sysstr.nim";
(*Dest_17209).Sup.len += 1;
framePtr = framePtr->prev;
}
N_NIMCALL(NI, Findenvvar_33402)(NimStringDesc* Key_33404) {
NI Result_33405;
NimStringDesc* Temp_33410;
NimStringDesc* LOC1;
NI I_33418;
NI HEX3Atmp_33420;
NI Res_33422;
NIM_BOOL LOC4;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "findEnvVar";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33405 = 0;
F.line = 720;F.filename = "os.nim";
Getenvvarsc_33243();
Temp_33410 = 0;
F.line = 721;F.filename = "os.nim";
LOC1 = 0;
LOC1 = rawNewString(Key_33404->Sup.len + 1);
appendString(LOC1, Key_33404);
appendChar(LOC1, 61);
Temp_33410 = LOC1;
I_33418 = 0;
HEX3Atmp_33420 = 0;
F.line = 722;F.filename = "os.nim";
HEX3Atmp_33420 = (Environment_33238->Sup.len-1);
Res_33422 = 0;
F.line = 1019;F.filename = "system.nim";
Res_33422 = 0;
F.line = 1020;F.filename = "system.nim";
while (1) {
if (!(Res_33422 <= HEX3Atmp_33420)) goto LA2;
F.line = 1019;F.filename = "system.nim";
I_33418 = Res_33422;
F.line = 723;F.filename = "os.nim";
if ((NU)(I_33418) >= (NU)(Environment_33238->Sup.len)) raiseIndexError();
LOC4 = nsuStartsWith(Environment_33238->data[I_33418], Temp_33410);
if (!LOC4) goto LA5;
F.line = 723;F.filename = "os.nim";
F.line = 723;F.filename = "os.nim";
Result_33405 = I_33418;
goto BeforeRet;
LA5: ;
F.line = 1022;F.filename = "system.nim";
Res_33422 = addInt(Res_33422, 1);
} LA2: ;
F.line = 724;F.filename = "os.nim";
F.line = 724;F.filename = "os.nim";
Result_33405 = -1;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_33405;
}
N_NIMCALL(NimStringDesc*, Getenv_33425)(NimStringDesc* Key_33427) {
NimStringDesc* Result_33428;
NI I_33429;
NI LOC4;
NCSTRING Env_33432;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_33428 = 0;
I_33429 = 0;
F.line = 732;F.filename = "os.nim";
I_33429 = Findenvvar_33402(Key_33427);
F.line = 733;F.filename = "os.nim";
if (!(0 <= I_33429)) goto LA2;
F.line = 734;F.filename = "os.nim";
F.line = 734;F.filename = "os.nim";
if ((NU)(I_33429) >= (NU)(Environment_33238->Sup.len)) raiseIndexError();
if ((NU)(I_33429) >= (NU)(Environment_33238->Sup.len)) raiseIndexError();
LOC4 = nsuFindChar(Environment_33238->data[I_33429], 61, 0);
Result_33428 = copyStr(Environment_33238->data[I_33429], addInt(LOC4, 1));
goto BeforeRet;
goto LA1;
LA2: ;
Env_33432 = 0;
F.line = 736;F.filename = "os.nim";
Env_33432 = getenv(Key_33427->data);
F.line = 737;F.filename = "os.nim";
if (!(Env_33432 == NIM_NIL)) goto LA6;
F.line = 737;F.filename = "os.nim";
F.line = 737;F.filename = "os.nim";
Result_33428 = copyString(((NimStringDesc*) &TMP39351));
goto BeforeRet;
LA6: ;
F.line = 738;F.filename = "os.nim";
Result_33428 = cstrToNimstr(Env_33432);
LA1: ;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_33428;
}
static N_INLINE(NI, subInt)(NI A_5803, NI B_5804) {
NI Result_5805;
NIM_BOOL LOC2;
Result_5805 = 0;
Result_5805 = (NI64)((NU64)(A_5803) - (NU64)(B_5804));
LOC2 = (0 <= (NI64)(Result_5805 ^ A_5803));
if (LOC2) goto LA3;
LOC2 = (0 <= (NI64)(Result_5805 ^ (NI64)((NU64) ~(B_5804))));
LA3: ;
if (!LOC2) goto LA4;
goto BeforeRet;
LA4: ;
raiseOverflow();
BeforeRet: ;
return Result_5805;
}
N_NIMCALL(NI, Searchextpos_32478)(NimStringDesc* S_32480) {
NI Result_32481;
NI I_32491;
NI HEX3Atmp_32507;
NI Res_32509;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "searchExtPos";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32481 = 0;
F.line = 424;F.filename = "os.nim";
Result_32481 = -1;
I_32491 = 0;
HEX3Atmp_32507 = 0;
F.line = 425;F.filename = "os.nim";
HEX3Atmp_32507 = subInt(S_32480->Sup.len, 1);
Res_32509 = 0;
F.line = 1010;F.filename = "system.nim";
Res_32509 = HEX3Atmp_32507;
F.line = 1011;F.filename = "system.nim";
while (1) {
if (!(1 <= Res_32509)) goto LA1;
F.line = 1010;F.filename = "system.nim";
I_32491 = Res_32509;
F.line = 426;F.filename = "os.nim";
if ((NU)(I_32491) > (NU)(S_32480->Sup.len)) raiseIndexError();
if (!((NU8)(S_32480->data[I_32491]) == (NU8)(46))) goto LA3;
F.line = 427;F.filename = "os.nim";
Result_32481 = I_32491;
F.line = 428;F.filename = "os.nim";
goto LA1;
goto LA2;
LA3: ;
if ((NU)(I_32491) > (NU)(S_32480->Sup.len)) raiseIndexError();
if (!(((NU8)(S_32480->data[I_32491])) == ((NU8)(92)) || ((NU8)(S_32480->data[I_32491])) == ((NU8)(47)))) goto LA5;
F.line = 430;F.filename = "os.nim";
goto LA1;
goto LA2;
LA5: ;
LA2: ;
F.line = 1013;F.filename = "system.nim";
Res_32509 = subInt(Res_32509, 1);
} LA1: ;
framePtr = framePtr->prev;
return Result_32481;
}
N_NIMCALL(NimStringDesc*, Normext_32468)(NimStringDesc* Ext_32470) {
NimStringDesc* Result_32471;
NIM_BOOL LOC2;
NimStringDesc* LOC6;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "normExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32471 = 0;
F.line = 419;F.filename = "os.nim";
LOC2 = ((Ext_32470) && (Ext_32470)->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(0) > (NU)(Ext_32470->Sup.len)) raiseIndexError();
LOC2 = ((NU8)(Ext_32470->data[0]) == (NU8)(46));
LA3: ;
if (!LOC2) goto LA4;
F.line = 419;F.filename = "os.nim";
Result_32471 = copyString(Ext_32470);
goto LA1;
LA4: ;
F.line = 420;F.filename = "os.nim";
LOC6 = 0;
LOC6 = rawNewString(Ext_32470->Sup.len + 1);
appendChar(LOC6, 46);
appendString(LOC6, Ext_32470);
Result_32471 = LOC6;
LA1: ;
framePtr = framePtr->prev;
return Result_32471;
}
N_NIMCALL(NimStringDesc*, nosChangeFileExt)(NimStringDesc* Filename_32820, NimStringDesc* Ext_32821) {
NimStringDesc* Result_32822;
NI Extpos_32823;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
NimStringDesc* LOC6;
NimStringDesc* LOC7;
NimStringDesc* LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "ChangeFileExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32822 = 0;
Extpos_32823 = 0;
F.line = 533;F.filename = "os.nim";
Extpos_32823 = Searchextpos_32478(Filename_32820);
F.line = 534;F.filename = "os.nim";
if (!(Extpos_32823 < 0)) goto LA2;
F.line = 534;F.filename = "os.nim";
LOC4 = 0;
LOC5 = 0;
LOC5 = Normext_32468(Ext_32821);
LOC4 = rawNewString(Filename_32820->Sup.len + LOC5->Sup.len + 0);
appendString(LOC4, Filename_32820);
appendString(LOC4, LOC5);
Result_32822 = LOC4;
goto LA1;
LA2: ;
F.line = 535;F.filename = "os.nim";
LOC6 = 0;
LOC7 = 0;
LOC7 = copyStrLast(Filename_32820, 0, subInt(Extpos_32823, 1));
LOC8 = 0;
LOC8 = Normext_32468(Ext_32821);
LOC6 = rawNewString(LOC7->Sup.len + LOC8->Sup.len + 0);
appendString(LOC6, LOC7);
appendString(LOC6, LOC8);
Result_32822 = LOC6;
LA1: ;
framePtr = framePtr->prev;
return Result_32822;
}
N_NIMCALL(void, nosSplitPath)(NimStringDesc* Path_32377, TY32378* Result) {
NI Seppos_32382;
NI I_32392;
NI HEX3Atmp_32408;
NI Res_32410;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "SplitPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)Result, 0, sizeof((*Result)));
Seppos_32382 = 0;
F.line = 380;F.filename = "os.nim";
Seppos_32382 = -1;
I_32392 = 0;
HEX3Atmp_32408 = 0;
F.line = 381;F.filename = "os.nim";
HEX3Atmp_32408 = subInt(Path_32377->Sup.len, 1);
Res_32410 = 0;
F.line = 1010;F.filename = "system.nim";
Res_32410 = HEX3Atmp_32408;
F.line = 1011;F.filename = "system.nim";
while (1) {
if (!(0 <= Res_32410)) goto LA1;
F.line = 1010;F.filename = "system.nim";
I_32392 = Res_32410;
F.line = 382;F.filename = "os.nim";
if ((NU)(I_32392) > (NU)(Path_32377->Sup.len)) raiseIndexError();
if (!(((NU8)(Path_32377->data[I_32392])) == ((NU8)(92)) || ((NU8)(Path_32377->data[I_32392])) == ((NU8)(47)))) goto LA3;
F.line = 383;F.filename = "os.nim";
Seppos_32382 = I_32392;
F.line = 384;F.filename = "os.nim";
goto LA1;
LA3: ;
F.line = 1013;F.filename = "system.nim";
Res_32410 = subInt(Res_32410, 1);
} LA1: ;
F.line = 385;F.filename = "os.nim";
if (!(0 <= Seppos_32382)) goto LA6;
F.line = 386;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Head, copyStrLast(Path_32377, 0, subInt(Seppos_32382, 1)));
F.line = 387;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Tail, copyStr(Path_32377, addInt(Seppos_32382, 1)));
goto LA5;
LA6: ;
F.line = 389;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Head, copyString(((NimStringDesc*) &TMP39351)));
F.line = 390;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Tail, copyString(Path_32377));
LA5: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, nossplitFile)(NimStringDesc* Path_32514, TY32515* Result) {
NIM_BOOL LOC2;
NI Seppos_32539;
NI Dotpos_32542;
NI I_32552;
NI HEX3Atmp_32574;
NI Res_32576;
NIM_BOOL LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "splitFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
memset((void*)Result, 0, sizeof((*Result)));
F.line = 449;F.filename = "os.nim";
LOC2 = (Path_32514->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(subInt(Path_32514->Sup.len, 1)) > (NU)(Path_32514->Sup.len)) raiseIndexError();
LOC2 = (((NU8)(Path_32514->data[subInt(Path_32514->Sup.len, 1)])) == ((NU8)(92)) || ((NU8)(Path_32514->data[subInt(Path_32514->Sup.len, 1)])) == ((NU8)(47)));
LA3: ;
if (!LOC2) goto LA4;
F.line = 450;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Dir, copyString(Path_32514));
unsureAsgnRef((void**) &(*Result).Name, copyString(((NimStringDesc*) &TMP39351)));
unsureAsgnRef((void**) &(*Result).Ext, copyString(((NimStringDesc*) &TMP39351)));
goto LA1;
LA4: ;
Seppos_32539 = 0;
F.line = 452;F.filename = "os.nim";
Seppos_32539 = -1;
Dotpos_32542 = 0;
F.line = 453;F.filename = "os.nim";
Dotpos_32542 = Path_32514->Sup.len;
I_32552 = 0;
HEX3Atmp_32574 = 0;
F.line = 454;F.filename = "os.nim";
HEX3Atmp_32574 = subInt(Path_32514->Sup.len, 1);
Res_32576 = 0;
F.line = 1010;F.filename = "system.nim";
Res_32576 = HEX3Atmp_32574;
F.line = 1011;F.filename = "system.nim";
while (1) {
if (!(0 <= Res_32576)) goto LA6;
F.line = 1010;F.filename = "system.nim";
I_32552 = Res_32576;
F.line = 455;F.filename = "os.nim";
if ((NU)(I_32552) > (NU)(Path_32514->Sup.len)) raiseIndexError();
if (!((NU8)(Path_32514->data[I_32552]) == (NU8)(46))) goto LA8;
F.line = 456;F.filename = "os.nim";
LOC11 = (Dotpos_32542 == Path_32514->Sup.len);
if (!(LOC11)) goto LA12;
LOC11 = (0 < I_32552);
LA12: ;
if (!LOC11) goto LA13;
F.line = 456;F.filename = "os.nim";
Dotpos_32542 = I_32552;
LA13: ;
goto LA7;
LA8: ;
if ((NU)(I_32552) > (NU)(Path_32514->Sup.len)) raiseIndexError();
if (!(((NU8)(Path_32514->data[I_32552])) == ((NU8)(92)) || ((NU8)(Path_32514->data[I_32552])) == ((NU8)(47)))) goto LA15;
F.line = 458;F.filename = "os.nim";
Seppos_32539 = I_32552;
F.line = 459;F.filename = "os.nim";
goto LA6;
goto LA7;
LA15: ;
LA7: ;
F.line = 1013;F.filename = "system.nim";
Res_32576 = subInt(Res_32576, 1);
} LA6: ;
F.line = 460;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Dir, copyStrLast(Path_32514, 0, subInt(Seppos_32539, 1)));
F.line = 461;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Name, copyStrLast(Path_32514, addInt(Seppos_32539, 1), subInt(Dotpos_32542, 1)));
F.line = 462;F.filename = "os.nim";
unsureAsgnRef((void**) &(*Result).Ext, copyStr(Path_32514, Dotpos_32542));
LA1: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetApplicationFilename)(void) {
NimStringDesc* Result_36003;
NI32 Len_36004;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getApplicationFilename";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_36003 = 0;
F.line = 1182;F.filename = "os.nim";
Result_36003 = mnewString(256);
Len_36004 = 0;
F.line = 1183;F.filename = "os.nim";
Len_36004 = Dl_26582(0, Result_36003->data, ((NI32) 256));
F.line = 1184;F.filename = "os.nim";
Result_36003 = setLengthStr(Result_36003, ((NI) (Len_36004)));
framePtr = framePtr->prev;
return Result_36003;
}
N_NIMCALL(NimStringDesc*, nosgetApplicationDir)(void) {
NimStringDesc* Result_36203;
NimStringDesc* LOC1;
TY32515 LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getApplicationDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_36203 = 0;
F.line = 1211;F.filename = "os.nim";
LOC1 = 0;
LOC1 = nosgetApplicationFilename();
memset((void*)&LOC2, 0, sizeof(LOC2));
nossplitFile(LOC1, &LOC2);
Result_36203 = copyString(LOC2.Dir);
framePtr = framePtr->prev;
return Result_36203;
}
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_30004) {
NI32 Err_30009;
NCSTRING Msgbuf_30012;
NI32 LOC8;
NimStringDesc* M_30016;
TY422* E_30018;
TY422* E_30204;
NCSTRING LOC19;
TY422* E_30221;
TY422* E_30238;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "OSError";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 156;F.filename = "os.nim";
if (!(Msg_30004->Sup.len == 0)) goto LA2;
Err_30009 = 0;
F.line = 158;F.filename = "os.nim";
Err_30009 = Dl_26550();
F.line = 159;F.filename = "os.nim";
if (!!((Err_30009 == ((NI32) 0)))) goto LA5;
Msgbuf_30012 = 0;
F.line = 162;F.filename = "os.nim";
LOC8 = Dl_26552(((NI32) 4864), NIM_NIL, Err_30009, ((NI32) 0), ((void*) (&Msgbuf_30012)), ((NI32) 0), NIM_NIL);
if (!!((LOC8 == ((NI32) 0)))) goto LA9;
M_30016 = 0;
F.line = 164;F.filename = "os.nim";
M_30016 = cstrToNimstr(Msgbuf_30012);
F.line = 165;F.filename = "os.nim";
if (!!((Msgbuf_30012 == NIM_NIL))) goto LA12;
F.line = 166;F.filename = "os.nim";
Dl_26561(((void*) (Msgbuf_30012)));
LA12: ;
E_30018 = 0;
F.line = 1278;F.filename = "system.nim";
E_30018 = (TY422*) newObj(NTI30017, sizeof(TY422));
(*E_30018).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1279;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_30018).Sup.Sup.Sup.message, copyString(M_30016));
F.line = 167;F.filename = "os.nim";
raiseException((E_Base*)E_30018, "EOS");
LA9: ;
LA5: ;
F.line = 168;F.filename = "os.nim";
if (!!((errno == ((NI32) 0)))) goto LA16;
E_30204 = 0;
F.line = 1278;F.filename = "system.nim";
E_30204 = (TY422*) newObj(NTI30017, sizeof(TY422));
(*E_30204).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1279;F.filename = "system.nim";
LOC19 = strerror(errno);
asgnRefNoCycle((void**) &(*E_30204).Sup.Sup.Sup.message, cstrToNimstr(LOC19));
F.line = 169;F.filename = "os.nim";
raiseException((E_Base*)E_30204, "EOS");
goto LA15;
LA16: ;
E_30221 = 0;
F.line = 1278;F.filename = "system.nim";
E_30221 = (TY422*) newObj(NTI30017, sizeof(TY422));
(*E_30221).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1279;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_30221).Sup.Sup.Sup.message, copyString(((NimStringDesc*) &TMP40220)));
F.line = 171;F.filename = "os.nim";
raiseException((E_Base*)E_30221, "EOS");
LA15: ;
goto LA1;
LA2: ;
E_30238 = 0;
F.line = 1278;F.filename = "system.nim";
E_30238 = (TY422*) newObj(NTI30017, sizeof(TY422));
(*E_30238).Sup.Sup.Sup.Sup.m_type = NTI422;
F.line = 1279;F.filename = "system.nim";
asgnRefNoCycle((void**) &(*E_30238).Sup.Sup.Sup.message, copyString(Msg_30004));
F.line = 173;F.filename = "os.nim";
raiseException((E_Base*)E_30238, "EOS");
LA1: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetCurrentDir)(void) {
NimStringDesc* Result_31810;
NI32 L_31812;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getCurrentDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_31810 = 0;
F.line = 289;F.filename = "os.nim";
Result_31810 = mnewString(512);
L_31812 = 0;
F.line = 291;F.filename = "os.nim";
L_31812 = Dl_26564(((NI32) 512), Result_31810->data);
F.line = 292;F.filename = "os.nim";
if (!(L_31812 == ((NI32) 0))) goto LA2;
F.line = 292;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP39351));
LA2: ;
F.line = 293;F.filename = "os.nim";
Result_31810 = setLengthStr(Result_31810, ((NI) (L_31812)));
framePtr = framePtr->prev;
return Result_31810;
}
N_NIMCALL(NimStringDesc*, nosJoinPath)(NimStringDesc* Head_32203, NimStringDesc* Tail_32204) {
NimStringDesc* Result_32205;
NimStringDesc* LOC9;
NimStringDesc* LOC10;
NimStringDesc* LOC11;
NimStringDesc* LOC15;
NimStringDesc* LOC16;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "JoinPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32205 = 0;
F.line = 324;F.filename = "os.nim";
if (!(Head_32203->Sup.len == 0)) goto LA2;
F.line = 325;F.filename = "os.nim";
Result_32205 = copyString(Tail_32204);
goto LA1;
LA2: ;
if ((NU)(subInt(Head_32203->Sup.len, 1)) > (NU)(Head_32203->Sup.len)) raiseIndexError();
if (!(((NU8)(Head_32203->data[subInt(Head_32203->Sup.len, 1)])) == ((NU8)(92)) || ((NU8)(Head_32203->data[subInt(Head_32203->Sup.len, 1)])) == ((NU8)(47)))) goto LA4;
F.line = 327;F.filename = "os.nim";
if ((NU)(0) > (NU)(Tail_32204->Sup.len)) raiseIndexError();
if (!(((NU8)(Tail_32204->data[0])) == ((NU8)(92)) || ((NU8)(Tail_32204->data[0])) == ((NU8)(47)))) goto LA7;
F.line = 328;F.filename = "os.nim";
LOC9 = 0;
LOC10 = 0;
LOC10 = copyStr(Tail_32204, 1);
LOC9 = rawNewString(Head_32203->Sup.len + LOC10->Sup.len + 0);
appendString(LOC9, Head_32203);
appendString(LOC9, LOC10);
Result_32205 = LOC9;
goto LA6;
LA7: ;
F.line = 330;F.filename = "os.nim";
LOC11 = 0;
LOC11 = rawNewString(Head_32203->Sup.len + Tail_32204->Sup.len + 0);
appendString(LOC11, Head_32203);
appendString(LOC11, Tail_32204);
Result_32205 = LOC11;
LA6: ;
goto LA1;
LA4: ;
F.line = 332;F.filename = "os.nim";
if ((NU)(0) > (NU)(Tail_32204->Sup.len)) raiseIndexError();
if (!(((NU8)(Tail_32204->data[0])) == ((NU8)(92)) || ((NU8)(Tail_32204->data[0])) == ((NU8)(47)))) goto LA13;
F.line = 333;F.filename = "os.nim";
LOC15 = 0;
LOC15 = rawNewString(Head_32203->Sup.len + Tail_32204->Sup.len + 0);
appendString(LOC15, Head_32203);
appendString(LOC15, Tail_32204);
Result_32205 = LOC15;
goto LA12;
LA13: ;
F.line = 335;F.filename = "os.nim";
LOC16 = 0;
LOC16 = rawNewString(Head_32203->Sup.len + Tail_32204->Sup.len + 1);
appendString(LOC16, Head_32203);
appendChar(LOC16, 92);
appendString(LOC16, Tail_32204);
Result_32205 = LOC16;
LA12: ;
LA1: ;
framePtr = framePtr->prev;
return Result_32205;
}
N_NIMCALL(NimStringDesc*, nosJoinPathOpenArray)(NimStringDesc** Parts_32287, NI Parts_32287Len0) {
NimStringDesc* Result_32288;
NI I_32311;
NI HEX3Atmp_32313;
NI Res_32315;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "JoinPath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32288 = 0;
F.line = 341;F.filename = "os.nim";
if ((NU)(0) >= (NU)(Parts_32287Len0)) raiseIndexError();
Result_32288 = copyString(Parts_32287[0]);
I_32311 = 0;
HEX3Atmp_32313 = 0;
F.line = 342;F.filename = "os.nim";
HEX3Atmp_32313 = (Parts_32287Len0-1);
Res_32315 = 0;
F.line = 1019;F.filename = "system.nim";
Res_32315 = 1;
F.line = 1020;F.filename = "system.nim";
while (1) {
if (!(Res_32315 <= HEX3Atmp_32313)) goto LA1;
F.line = 1019;F.filename = "system.nim";
I_32311 = Res_32315;
F.line = 343;F.filename = "os.nim";
if ((NU)(I_32311) >= (NU)(Parts_32287Len0)) raiseIndexError();
Result_32288 = nosJoinPath(Result_32288, Parts_32287[I_32311]);
F.line = 1022;F.filename = "system.nim";
Res_32315 = addInt(Res_32315, 1);
} LA1: ;
framePtr = framePtr->prev;
return Result_32288;
}
N_NIMCALL(void, Rawcreatedir_34219)(NimStringDesc* Dir_34221) {
NIM_BOOL LOC2;
NI32 LOC3;
NI32 LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "rawCreateDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 917;F.filename = "os.nim";
LOC3 = Dl_26571(Dir_34221->data, NIM_NIL);
LOC2 = (LOC3 == ((NI32) 0));
if (!(LOC2)) goto LA4;
LOC5 = Dl_26550();
LOC2 = !((LOC5 == ((NI32) 183)));
LA4: ;
if (!LOC2) goto LA6;
F.line = 918;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP39351));
LA6: ;
framePtr = framePtr->prev;
}
N_NIMCALL(void, noscreateDir)(NimStringDesc* Dir_34403) {
NI I_34413;
NI HEX3Atmp_34427;
NI Res_34429;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "createDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
I_34413 = 0;
HEX3Atmp_34427 = 0;
F.line = 927;F.filename = "os.nim";
HEX3Atmp_34427 = subInt(Dir_34403->Sup.len, 1);
Res_34429 = 0;
F.line = 1019;F.filename = "system.nim";
Res_34429 = 1;
F.line = 1020;F.filename = "system.nim";
while (1) {
if (!(Res_34429 <= HEX3Atmp_34427)) goto LA1;
F.line = 1019;F.filename = "system.nim";
I_34413 = Res_34429;
F.line = 928;F.filename = "os.nim";
if ((NU)(I_34413) > (NU)(Dir_34403->Sup.len)) raiseIndexError();
if (!(((NU8)(Dir_34403->data[I_34413])) == ((NU8)(92)) || ((NU8)(Dir_34403->data[I_34413])) == ((NU8)(47)))) goto LA3;
F.line = 928;F.filename = "os.nim";
LOC5 = 0;
LOC5 = copyStrLast(Dir_34403, 0, subInt(I_34413, 1));
Rawcreatedir_34219(LOC5);
LA3: ;
F.line = 1022;F.filename = "system.nim";
Res_34429 = addInt(Res_34429, 1);
} LA1: ;
F.line = 929;F.filename = "os.nim";
Rawcreatedir_34219(Dir_34403);
framePtr = framePtr->prev;
}
N_NIMCALL(NIM_BOOL, nosexistsFile)(NimStringDesc* Filename_30804) {
NIM_BOOL Result_30805;
NI32 A_30806;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "existsFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_30805 = 0;
A_30806 = 0;
F.line = 224;F.filename = "os.nim";
A_30806 = Dl_26635(Filename_30804->data);
F.line = 225;F.filename = "os.nim";
if (!!((A_30806 == ((NI32) -1)))) goto LA2;
F.line = 226;F.filename = "os.nim";
Result_30805 = ((NI32)(A_30806 & ((NI32) 16)) == ((NI32) 0));
LA2: ;
framePtr = framePtr->prev;
return Result_30805;
}
N_NIMCALL(NimStringDesc*, nosextractFilename)(NimStringDesc* Path_32585) {
NimStringDesc* Result_32586;
NIM_BOOL LOC2;
TY32378 LOC6;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "extractFilename";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32586 = 0;
F.line = 475;F.filename = "os.nim";
LOC2 = (Path_32585->Sup.len == 0);
if (LOC2) goto LA3;
if ((NU)(subInt(Path_32585->Sup.len, 1)) > (NU)(Path_32585->Sup.len)) raiseIndexError();
LOC2 = (((NU8)(Path_32585->data[subInt(Path_32585->Sup.len, 1)])) == ((NU8)(92)) || ((NU8)(Path_32585->data[subInt(Path_32585->Sup.len, 1)])) == ((NU8)(47)));
LA3: ;
if (!LOC2) goto LA4;
F.line = 476;F.filename = "os.nim";
Result_32586 = copyString(((NimStringDesc*) &TMP39351));
goto LA1;
LA4: ;
F.line = 478;F.filename = "os.nim";
memset((void*)&LOC6, 0, sizeof(LOC6));
nosSplitPath(Path_32585, &LOC6);
Result_32586 = copyString(LOC6.Tail);
LA1: ;
framePtr = framePtr->prev;
return Result_32586;
}
static N_INLINE(NI, divInt)(NI A_6203, NI B_6204) {
NI Result_6205;
NIM_BOOL LOC5;
Result_6205 = 0;
if (!(B_6204 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
LOC5 = (A_6203 == (IL64(-9223372036854775807) - IL64(1)));
if (!(LOC5)) goto LA6;
LOC5 = (B_6204 == -1);
LA6: ;
if (!LOC5) goto LA7;
raiseOverflow();
LA7: ;
Result_6205 = (NI64)(A_6203 / B_6204);
goto BeforeRet;
BeforeRet: ;
return Result_6205;
}
static N_INLINE(NI, modInt)(NI A_6403, NI B_6404) {
NI Result_6405;
Result_6405 = 0;
if (!(B_6404 == 0)) goto LA2;
raiseDivByZero();
LA2: ;
Result_6405 = (NI64)(A_6403 % B_6404);
goto BeforeRet;
BeforeRet: ;
return Result_6405;
}
N_NIMCALL(TY4177*, nosparseCmdLine)(NimStringDesc* C_34434) {
TY4177* Result_34436;
NI I_34453;
NimStringDesc* A_34454;
NIM_BOOL LOC3;
NIM_BOOL Inquote_34473;
NI J_34474;
NI K_34498;
NI HEX3Atmp_34622;
NI Res_34624;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "parseCmdLine";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_34436 = 0;
F.line = 962;F.filename = "os.nim";
Result_34436 = (TY4177*) newSeq(NTI4177, 0);
I_34453 = 0;
F.line = 963;F.filename = "os.nim";
I_34453 = 0;
A_34454 = 0;
F.line = 964;F.filename = "os.nim";
A_34454 = copyString(((NimStringDesc*) &TMP39351));
F.line = 965;F.filename = "os.nim";
while (1) {
F.line = 966;F.filename = "os.nim";
A_34454 = setLengthStr(A_34454, 0);
F.line = 967;F.filename = "os.nim";
while (1) {
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
LOC3 = ((NU8)(C_34434->data[I_34453]) == (NU8)(32));
if (LOC3) goto LA4;
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
LOC3 = ((NU8)(C_34434->data[I_34453]) == (NU8)(9));
LA4: ;
if (!LOC3) goto LA2;
F.line = 967;F.filename = "os.nim";
I_34453 = addInt(I_34453, 1);
} LA2: ;
F.line = 970;F.filename = "os.nim";
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
if (!((NU8)(C_34434->data[I_34453]) == (NU8)(0))) goto LA6;
F.line = 970;F.filename = "os.nim";
goto LA1;
LA6: ;
Inquote_34473 = 0;
F.line = 971;F.filename = "os.nim";
Inquote_34473 = NIM_FALSE;
F.line = 972;F.filename = "os.nim";
while (1) {
F.line = 973;F.filename = "os.nim";
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
switch (((NU8)(C_34434->data[I_34453]))) {
case 0:
F.line = 974;F.filename = "os.nim";
goto LA8;
break;
case 92:
J_34474 = 0;
F.line = 976;F.filename = "os.nim";
J_34474 = I_34453;
F.line = 977;F.filename = "os.nim";
while (1) {
if ((NU)(J_34474) > (NU)(C_34434->Sup.len)) raiseIndexError();
if (!((NU8)(C_34434->data[J_34474]) == (NU8)(92))) goto LA9;
F.line = 977;F.filename = "os.nim";
J_34474 = addInt(J_34474, 1);
} LA9: ;
F.line = 978;F.filename = "os.nim";
if ((NU)(J_34474) > (NU)(C_34434->Sup.len)) raiseIndexError();
if (!((NU8)(C_34434->data[J_34474]) == (NU8)(34))) goto LA11;
K_34498 = 0;
HEX3Atmp_34622 = 0;
F.line = 979;F.filename = "os.nim";
HEX3Atmp_34622 = divInt(subInt(J_34474, I_34453), 2);
Res_34624 = 0;
F.line = 1019;F.filename = "system.nim";
Res_34624 = 1;
F.line = 1020;F.filename = "system.nim";
while (1) {
if (!(Res_34624 <= HEX3Atmp_34622)) goto LA13;
F.line = 1019;F.filename = "system.nim";
K_34498 = Res_34624;
F.line = 979;F.filename = "os.nim";
A_34454 = addChar(A_34454, 92);
F.line = 1022;F.filename = "system.nim";
Res_34624 = addInt(Res_34624, 1);
} LA13: ;
F.line = 980;F.filename = "os.nim";
if (!(modInt(subInt(J_34474, I_34453), 2) == 0)) goto LA15;
F.line = 981;F.filename = "os.nim";
I_34453 = J_34474;
goto LA14;
LA15: ;
F.line = 983;F.filename = "os.nim";
A_34454 = addChar(A_34454, 34);
F.line = 984;F.filename = "os.nim";
I_34453 = addInt(J_34474, 1);
LA14: ;
goto LA10;
LA11: ;
F.line = 986;F.filename = "os.nim";
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
A_34454 = addChar(A_34454, C_34434->data[I_34453]);
F.line = 987;F.filename = "os.nim";
I_34453 = addInt(I_34453, 1);
LA10: ;
break;
case 34:
F.line = 989;F.filename = "os.nim";
I_34453 = addInt(I_34453, 1);
F.line = 990;F.filename = "os.nim";
if (!!(Inquote_34473)) goto LA18;
F.line = 990;F.filename = "os.nim";
Inquote_34473 = NIM_TRUE;
goto LA17;
LA18: ;
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
if (!((NU8)(C_34434->data[I_34453]) == (NU8)(34))) goto LA20;
F.line = 992;F.filename = "os.nim";
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
A_34454 = addChar(A_34454, C_34434->data[I_34453]);
F.line = 993;F.filename = "os.nim";
I_34453 = addInt(I_34453, 1);
goto LA17;
LA20: ;
F.line = 995;F.filename = "os.nim";
Inquote_34473 = NIM_FALSE;
F.line = 996;F.filename = "os.nim";
goto LA8;
LA17: ;
break;
case 32:
case 9:
F.line = 998;F.filename = "os.nim";
if (!!(Inquote_34473)) goto LA23;
F.line = 998;F.filename = "os.nim";
goto LA8;
LA23: ;
F.line = 999;F.filename = "os.nim";
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
A_34454 = addChar(A_34454, C_34434->data[I_34453]);
F.line = 1000;F.filename = "os.nim";
I_34453 = addInt(I_34453, 1);
break;
default:
F.line = 1002;F.filename = "os.nim";
if ((NU)(I_34453) > (NU)(C_34434->Sup.len)) raiseIndexError();
A_34454 = addChar(A_34454, C_34434->data[I_34453]);
F.line = 1003;F.filename = "os.nim";
I_34453 = addInt(I_34453, 1);
break;
}
} LA8: ;
F.line = 1018;F.filename = "os.nim";
Result_34436 = (TY4177*) incrSeq(&(Result_34436)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Result_34436->data[Result_34436->Sup.len-1], copyString(A_34454));
} LA1: ;
framePtr = framePtr->prev;
return Result_34436;
}
static N_INLINE(NI, chckRange)(NI I_4410, NI A_4411, NI B_4412) {
NI Result_5316;
NIM_BOOL LOC2;
Result_5316 = 0;
LOC2 = (A_4411 <= I_4410);
if (!(LOC2)) goto LA3;
LOC2 = (I_4410 <= B_4412);
LA3: ;
if (!LOC2) goto LA4;
Result_5316 = I_4410;
goto BeforeRet;
goto LA1;
LA4: ;
raiseRangeError(((NI64) (I_4410)));
LA1: ;
BeforeRet: ;
return Result_5316;
}
N_NIMCALL(void, nossleep)(NI Milsecs_36206) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "sleep";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 1216;F.filename = "os.nim";
Dl_26666(((NI32)chckRange(Milsecs_36206, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))));
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, HEX2F_32318)(NimStringDesc* Head_32320, NimStringDesc* Tail_32321) {
NimStringDesc* Result_32322;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "/";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32322 = 0;
F.line = 347;F.filename = "os.nim";
F.line = 347;F.filename = "os.nim";
Result_32322 = nosJoinPath(Head_32320, Tail_32321);
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_32322;
}
N_NIMCALL(NimStringDesc*, nosaddFileExt)(NimStringDesc* Filename_32844, NimStringDesc* Ext_32845) {
NimStringDesc* Result_32846;
NI Extpos_32847;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "addFileExt";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32846 = 0;
Extpos_32847 = 0;
F.line = 545;F.filename = "os.nim";
Extpos_32847 = Searchextpos_32478(Filename_32844);
F.line = 546;F.filename = "os.nim";
if (!(Extpos_32847 < 0)) goto LA2;
F.line = 546;F.filename = "os.nim";
LOC4 = 0;
LOC5 = 0;
LOC5 = Normext_32468(Ext_32845);
LOC4 = rawNewString(Filename_32844->Sup.len + LOC5->Sup.len + 0);
appendString(LOC4, Filename_32844);
appendString(LOC4, LOC5);
Result_32846 = LOC4;
goto LA1;
LA2: ;
F.line = 547;F.filename = "os.nim";
Result_32846 = copyString(Filename_32844);
LA1: ;
framePtr = framePtr->prev;
return Result_32846;
}
N_NIMCALL(NimStringDesc*, nosUnixToNativePath)(NimStringDesc* Path_30256) {
NimStringDesc* Result_30257;
NI Start_30258;
NIM_BOOL LOC4;
NI I_30407;
NIM_BOOL LOC10;
NIM_BOOL LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "UnixToNativePath";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_30257 = 0;
Start_30258 = 0;
F.line = 185;F.filename = "os.nim";
if ((NU)(0) > (NU)(Path_30256->Sup.len)) raiseIndexError();
if (!((NU8)(Path_30256->data[0]) == (NU8)(47))) goto LA2;
F.line = 188;F.filename = "os.nim";
Result_30257 = copyString(((NimStringDesc*) &TMP67416));
F.line = 193;F.filename = "os.nim";
Start_30258 = 1;
goto LA1;
LA2: ;
if ((NU)(0) > (NU)(Path_30256->Sup.len)) raiseIndexError();
LOC4 = ((NU8)(Path_30256->data[0]) == (NU8)(46));
if (!(LOC4)) goto LA5;
if ((NU)(1) > (NU)(Path_30256->Sup.len)) raiseIndexError();
LOC4 = ((NU8)(Path_30256->data[1]) == (NU8)(47));
LA5: ;
if (!LOC4) goto LA6;
F.line = 196;F.filename = "os.nim";
Result_30257 = copyString(((NimStringDesc*) &TMP67417));
F.line = 197;F.filename = "os.nim";
Start_30258 = 2;
goto LA1;
LA6: ;
F.line = 199;F.filename = "os.nim";
Result_30257 = copyString(((NimStringDesc*) &TMP39351));
F.line = 200;F.filename = "os.nim";
Start_30258 = 0;
LA1: ;
I_30407 = 0;
F.line = 202;F.filename = "os.nim";
I_30407 = Start_30258;
F.line = 203;F.filename = "os.nim";
while (1) {
if (!(I_30407 < Path_30256->Sup.len)) goto LA8;
F.line = 204;F.filename = "os.nim";
if ((NU)(I_30407) > (NU)(Path_30256->Sup.len)) raiseIndexError();
LOC11 = ((NU8)(Path_30256->data[I_30407]) == (NU8)(46));
if (!(LOC11)) goto LA12;
if ((NU)(addInt(I_30407, 1)) > (NU)(Path_30256->Sup.len)) raiseIndexError();
LOC11 = ((NU8)(Path_30256->data[addInt(I_30407, 1)]) == (NU8)(46));
LA12: ;
LOC10 = LOC11;
if (!(LOC10)) goto LA13;
if ((NU)(addInt(I_30407, 2)) > (NU)(Path_30256->Sup.len)) raiseIndexError();
LOC10 = ((NU8)(Path_30256->data[addInt(I_30407, 2)]) == (NU8)(47));
LA13: ;
if (!LOC10) goto LA14;
F.line = 212;F.filename = "os.nim";
Result_30257 = resizeString(Result_30257, 3);
appendString(Result_30257, ((NimStringDesc*) &TMP67418));
F.line = 213;F.filename = "os.nim";
I_30407 = addInt(I_30407, 3);
goto LA9;
LA14: ;
if ((NU)(I_30407) > (NU)(Path_30256->Sup.len)) raiseIndexError();
if (!((NU8)(Path_30256->data[I_30407]) == (NU8)(47))) goto LA16;
F.line = 215;F.filename = "os.nim";
Result_30257 = addChar(Result_30257, 92);
F.line = 216;F.filename = "os.nim";
I_30407 = addInt(I_30407, 1);
goto LA9;
LA16: ;
F.line = 218;F.filename = "os.nim";
if ((NU)(I_30407) > (NU)(Path_30256->Sup.len)) raiseIndexError();
Result_30257 = addChar(Result_30257, Path_30256->data[I_30407]);
F.line = 219;F.filename = "os.nim";
I_30407 = addInt(I_30407, 1);
LA9: ;
} LA8: ;
framePtr = framePtr->prev;
return Result_30257;
}
N_NIMCALL(void, Putenv_33439)(NimStringDesc* Key_33441, NimStringDesc* Val_33442) {
NI Indx_33443;
NimStringDesc* LOC4;
NimStringDesc* LOC5;
NI32 LOC7;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "putEnv";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Indx_33443 = 0;
F.line = 754;F.filename = "os.nim";
Indx_33443 = Findenvvar_33402(Key_33441);
F.line = 755;F.filename = "os.nim";
if (!(0 <= Indx_33443)) goto LA2;
F.line = 756;F.filename = "os.nim";
if ((NU)(Indx_33443) >= (NU)(Environment_33238->Sup.len)) raiseIndexError();
LOC4 = 0;
LOC4 = rawNewString(Key_33441->Sup.len + Val_33442->Sup.len + 1);
appendString(LOC4, Key_33441);
appendChar(LOC4, 61);
appendString(LOC4, Val_33442);
asgnRefNoCycle((void**) &Environment_33238->data[Indx_33443], LOC4);
goto LA1;
LA2: ;
F.line = 758;F.filename = "os.nim";
LOC5 = 0;
LOC5 = rawNewString(Key_33441->Sup.len + Val_33442->Sup.len + 1);
appendString(LOC5, Key_33441);
appendChar(LOC5, 61);
appendString(LOC5, Val_33442);
Environment_33238 = (TY4177*) incrSeq(&(Environment_33238)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &Environment_33238->data[Environment_33238->Sup.len-1], copyString(LOC5));
F.line = 759;F.filename = "os.nim";
Indx_33443 = (Environment_33238->Sup.len-1);
LA1: ;
F.line = 764;F.filename = "os.nim";
LOC7 = Dl_26578(Key_33441->data, Val_33442->data);
if (!(LOC7 == ((NI32) 0))) goto LA8;
F.line = 765;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP39351));
LA8: ;
framePtr = framePtr->prev;
}
N_NIMCALL(NimStringDesc*, nosgetConfigDir)(void) {
NimStringDesc* Result_35203;
NimStringDesc* LOC1;
NimStringDesc* LOC2;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getConfigDir";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_35203 = 0;
F.line = 1116;F.filename = "os.nim";
F.line = 1116;F.filename = "os.nim";
LOC1 = 0;
LOC2 = 0;
LOC2 = Getenv_33425(((NimStringDesc*) &TMP74535));
LOC1 = rawNewString(LOC2->Sup.len + 1);
appendString(LOC1, LOC2);
appendString(LOC1, ((NimStringDesc*) &TMP74536));
Result_35203 = LOC1;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_35203;
}
static N_INLINE(NIM_BOOL, eqStrings)(NimStringDesc* A_17047, NimStringDesc* B_17048) {
NIM_BOOL Result_17049;
NIM_BOOL LOC5;
NIM_BOOL LOC9;
NI32 LOC11;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "eqStrings";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/system/sysstr.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_17049 = 0;
F.line = 32;F.filename = "sysstr.nim";
if (!(A_17047 == B_17048)) goto LA2;
F.line = 32;F.filename = "sysstr.nim";
F.line = 32;F.filename = "sysstr.nim";
Result_17049 = NIM_TRUE;
goto BeforeRet;
LA2: ;
F.line = 33;F.filename = "sysstr.nim";
LOC5 = (A_17047 == NIM_NIL);
if (LOC5) goto LA6;
LOC5 = (B_17048 == NIM_NIL);
LA6: ;
if (!LOC5) goto LA7;
F.line = 33;F.filename = "sysstr.nim";
F.line = 33;F.filename = "sysstr.nim";
Result_17049 = NIM_FALSE;
goto BeforeRet;
LA7: ;
F.line = 34;F.filename = "sysstr.nim";
F.line = 34;F.filename = "sysstr.nim";
LOC9 = ((*A_17047).Sup.len == (*B_17048).Sup.len);
if (!(LOC9)) goto LA10;
LOC11 = memcmp(((NCSTRING) ((*A_17047).data)), ((NCSTRING) ((*B_17048).data)), ((NI32) ((NI64)((*A_17047).Sup.len * 1))));
LOC9 = (LOC11 == ((NI32) 0));
LA10: ;
Result_17049 = LOC9;
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_17049;
}
N_NIMCALL(NI, noscmpPaths)(NimStringDesc* Patha_32865, NimStringDesc* Pathb_32866) {
NI Result_32867;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "cmpPaths";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32867 = 0;
F.line = 564;F.filename = "os.nim";
if (!NIM_FALSE) goto LA2;
F.line = 565;F.filename = "os.nim";
Result_32867 = Cmp_1321(Patha_32865, Pathb_32866);
goto LA1;
LA2: ;
F.line = 567;F.filename = "os.nim";
Result_32867 = nsuCmpIgnoreCase(Patha_32865, Pathb_32866);
LA1: ;
framePtr = framePtr->prev;
return Result_32867;
}
N_NIMCALL(NIM_BOOL, nossameFile)(NimStringDesc* Path1_32870, NimStringDesc* Path2_32871) {
NIM_BOOL Result_32872;
TY26598 A_32873;
TY26598 B_32874;
NI Resa_32876;
NI Resb_32878;
NIM_BOOL LOC2;
NimStringDesc* LOC6;
NimStringDesc* LOC7;
NI LOC8;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "sameFile";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_32872 = 0;
memset((void*)&A_32873, 0, sizeof(A_32873));
memset((void*)&B_32874, 0, sizeof(B_32874));
Resa_32876 = 0;
F.line = 576;F.filename = "os.nim";
Resa_32876 = Dl_26615(Path1_32870->data, &A_32873);
Resb_32878 = 0;
F.line = 577;F.filename = "os.nim";
Resb_32878 = Dl_26615(Path2_32871->data, &B_32874);
F.line = 578;F.filename = "os.nim";
LOC2 = !((Resa_32876 == -1));
if (!(LOC2)) goto LA3;
LOC2 = !((Resb_32878 == -1));
LA3: ;
if (!LOC2) goto LA4;
F.line = 579;F.filename = "os.nim";
LOC6 = 0;
LOC6 = cstrToNimstr(((NCSTRING) (A_32873.Cfilename)));
LOC7 = 0;
LOC7 = cstrToNimstr(((NCSTRING) (B_32874.Cfilename)));
Result_32872 = eqStrings(LOC6, LOC7);
goto LA1;
LA4: ;
F.line = 582;F.filename = "os.nim";
LOC8 = noscmpPaths(Path1_32870, Path2_32871);
Result_32872 = (LOC8 == 0);
LA1: ;
F.line = 583;F.filename = "os.nim";
if (!!((Resa_32876 == -1))) goto LA10;
F.line = 583;F.filename = "os.nim";
Dl_26625(Resa_32876);
LA10: ;
F.line = 584;F.filename = "os.nim";
if (!!((Resb_32878 == -1))) goto LA13;
F.line = 584;F.filename = "os.nim";
Dl_26625(Resb_32878);
LA13: ;
framePtr = framePtr->prev;
return Result_32872;
}
N_NIMCALL(NI32, nosgetLastModificationTime)(NimStringDesc* File_31203) {
NI32 Result_31204;
TY26598 F_31205;
NI H_31207;
NI64 LOC4;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "getLastModificationTime";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_31204 = 0;
memset((void*)&F_31205, 0, sizeof(F_31205));
H_31207 = 0;
F.line = 250;F.filename = "os.nim";
H_31207 = Dl_26615(File_31203->data, &F_31205);
F.line = 251;F.filename = "os.nim";
if (!(H_31207 == -1)) goto LA2;
F.line = 251;F.filename = "os.nim";
nosOSError(((NimStringDesc*) &TMP39351));
LA2: ;
F.line = 252;F.filename = "os.nim";
LOC4 = Rdfiletime_26654(F_31205.Ftlastwritetime);
Result_31204 = Wintimetounixtime_28261(LOC4);
F.line = 253;F.filename = "os.nim";
Dl_26625(H_31207);
framePtr = framePtr->prev;
return Result_31204;
}
N_NIMCALL(NIM_BOOL, nosfileNewer)(NimStringDesc* A_31803, NimStringDesc* B_31804) {
NIM_BOOL Result_31805;
NI32 LOC1;
NI32 LOC2;
NI64 LOC3;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "fileNewer";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_31805 = 0;
F.line = 284;F.filename = "os.nim";
LOC1 = nosgetLastModificationTime(A_31803);
LOC2 = nosgetLastModificationTime(B_31804);
LOC3 = ntDiffTime(LOC1, LOC2);
Result_31805 = (0 < LOC3);
framePtr = framePtr->prev;
return Result_31805;
}
N_NIMCALL(NI, nosparamCount)(void) {
NI Result_35405;
NCSTRING LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "paramCount";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_35405 = 0;
F.line = 1131;F.filename = "os.nim";
if (!Ownargv_35402 == 0) goto LA2;
F.line = 1131;F.filename = "os.nim";
LOC4 = Dl_26652();
LOC5 = 0;
LOC5 = cstrToNimstr(LOC4);
asgnRefNoCycle((void**) &Ownargv_35402, nosparseCmdLine(LOC5));
LA2: ;
F.line = 1132;F.filename = "os.nim";
Result_35405 = subInt(Ownargv_35402->Sup.len, 1);
framePtr = framePtr->prev;
return Result_35405;
}
N_NIMCALL(NimStringDesc*, nosparamStr)(NI I_35426) {
NimStringDesc* Result_35427;
NCSTRING LOC4;
NimStringDesc* LOC5;
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "paramStr";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
Result_35427 = 0;
F.line = 1140;F.filename = "os.nim";
if (!Ownargv_35402 == 0) goto LA2;
F.line = 1140;F.filename = "os.nim";
LOC4 = Dl_26652();
LOC5 = 0;
LOC5 = cstrToNimstr(LOC4);
asgnRefNoCycle((void**) &Ownargv_35402, nosparseCmdLine(LOC5));
LA2: ;
F.line = 1141;F.filename = "os.nim";
F.line = 1141;F.filename = "os.nim";
if ((NU)(I_35426) >= (NU)(Ownargv_35402->Sup.len)) raiseIndexError();
Result_35427 = copyString(Ownargv_35402->data[I_35426]);
goto BeforeRet;
BeforeRet: ;
framePtr = framePtr->prev;
return Result_35427;
}
N_NOINLINE(void, osInit)(void) {
volatile struct {TFrame* prev;NCSTRING procname;NI line;NCSTRING filename;NI len;
} F;
F.procname = "os";
F.prev = framePtr;
F.filename = "/home/andreas/projects/nimrod/lib/pure/os.nim";
F.line = 0;
framePtr = (TFrame*)&F;
F.len = 0;
F.line = 682;F.filename = "os.nim";
Envcomputed_33220 = NIM_FALSE;
F.line = 683;F.filename = "os.nim";
asgnRefNoCycle((void**) &Environment_33238, (TY4177*) newSeq(NTI4177, 0));
framePtr = framePtr->prev;
}

