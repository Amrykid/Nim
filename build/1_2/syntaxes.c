/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY50526 TY50526;
typedef struct TY88028 TY88028;
typedef struct TY77011 TY77011;
typedef struct TY73267 TY73267;
typedef struct TY73263 TY73263;
typedef struct TY71204 TY71204;
typedef struct TY50552 TY50552;
typedef struct TY42538 TY42538;
typedef struct TY50548 TY50548;
typedef struct TY49011 TY49011;
typedef struct TY50520 TY50520;
typedef struct TY49005 TY49005;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY72015 TY72015;
typedef struct TY73281 TY73281;
typedef struct TY50550 TY50550;
typedef struct TY50540 TY50540;
typedef struct TY47008 TY47008;
typedef struct TY50530 TY50530;
typedef struct TY50528 TY50528;
typedef struct TY50544 TY50544;
typedef struct TY38013 TY38013;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
typedef NimStringDesc* TY88013[3];
typedef NimStringDesc* TY88017[4];
struct TY77011 {
TY73267* Lex;
TY73263* Tok;
};
struct TY88028 {
NU8 Skin;
TY77011 Parser;
};
struct TY42538 {
NI16 Line;
NI16 Col;
NI32 Fileindex;
};
struct TY50526 {
TY50552* Typ;
NimStringDesc* Comment;
TY42538 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {TY50548* Sym;
} S4;
struct {TY49011* Ident;
} S5;
struct {TY50520* Sons;
} S6;
} KindU;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY49005 {
  TNimObject Sup;
NI Id;
};
struct TY49011 {
  TY49005 Sup;
NimStringDesc* S;
TY49011* Next;
NI H;
};
typedef NimStringDesc* TY41331[1];
struct TY71204 {
  TNimObject Sup;
NU8 Kind;
FILE* F;
NimStringDesc* S;
NI Rd;
NI Wr;
NI Lineoffset;
};
struct TY72015 {
  TNimObject Sup;
NI Bufpos;
NCSTRING Buf;
NI Buflen;
TY71204* Stream;
NI Linenumber;
NI Sentinel;
NI Linestart;
};
struct TY73267 {
  TY72015 Sup;
NimStringDesc* Filename;
TY73281* Indentstack;
NI Dedent;
NI Indentahead;
};
struct TY73263 {
TNimType* m_type;
NU8 Toktype;
NI Indent;
TY49011* Ident;
NI64 Inumber;
NF64 Fnumber;
NU8 Base;
NimStringDesc* Literal;
TY73263* Next;
};
struct TY50540 {
NU8 K;
NU8 S;
NU8 Flags;
TY50552* T;
TY47008* R;
NI A;
};
struct TY50552 {
  TY49005 Sup;
NU8 Kind;
TY50550* Sons;
TY50526* N;
NU8 Flags;
NU8 Callconv;
TY50548* Owner;
TY50548* Sym;
NI64 Size;
NI Align;
NI Containerid;
TY50540 Loc;
};
struct TY50530 {
TNimType* m_type;
NI Counter;
TY50528* Data;
};
struct TY50548 {
  TY49005 Sup;
NU8 Kind;
NU8 Magic;
TY50552* Typ;
TY49011* Name;
TY42538 Info;
TY50548* Owner;
NU32 Flags;
TY50530 Tab;
TY50526* Ast;
NU32 Options;
NI Position;
NI Offset;
TY50540 Loc;
TY50544* Annex;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY47008 {
  TNimObject Sup;
TY47008* Left;
TY47008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY38013 {
  TNimObject Sup;
TY38013* Prev;
TY38013* Next;
};
struct TY50544 {
  TY38013 Sup;
NU8 Kind;
NIM_BOOL Generated;
TY47008* Name;
TY50526* Path;
};
struct TY50520 {
  TGenericSeq Sup;
  TY50526* data[SEQ_DECL_SIZE];
};
struct TY73281 {
  TGenericSeq Sup;
  NI data[SEQ_DECL_SIZE];
};
struct TY50550 {
  TGenericSeq Sup;
  TY50552* data[SEQ_DECL_SIZE];
};
struct TY50528 {
  TGenericSeq Sup;
  TY50548* data[SEQ_DECL_SIZE];
};
N_NIMCALL(NIM_BOOL, Open_3817)(FILE** F_3820, NimStringDesc* Filename_3821, NU8 Mode_3822, NI Bufsize_3823);
N_NIMCALL(void, Rawmessage_43045)(NU8 Msg_43047, NimStringDesc* Arg_43048);
N_NIMCALL(void, Openparsers_88034)(TY88028* P_88037, NimStringDesc* Filename_88038, TY71204* Inputstream_88039);
N_NIMCALL(TY50526*, Parsepipe_88122)(NimStringDesc* Filename_88124, TY71204* Inputstream_88125);
N_NIMCALL(TY71204*, Llstreamopen_71224)(NimStringDesc* Filename_71226, NU8 Mode_71227);
N_NIMCALL(NimStringDesc*, Llstreamreadline_71240)(TY71204* S_71242);
N_NIMCALL(NI, Utf8bom_88077)(NimStringDesc* S_88079);
N_NIMCALL(NIM_BOOL, Containsshebang_88087)(NimStringDesc* S_88089, NI I_88090);
N_NIMCALL(void, Openparser_77018)(TY77011* P_77021, NimStringDesc* Filename_77022, TY71204* Inputstream_77023);
N_NIMCALL(TY71204*, Llstreamopen_71217)(NimStringDesc* Data_71219);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* S_2324, NI First_2325);
N_NIMCALL(TY50526*, Parseall_77014)(TY77011* P_77017);
N_NIMCALL(void, Closeparser_77024)(TY77011* P_77027);
N_NIMCALL(void, Llstreamclose_71232)(TY71204* S_71234);
N_NIMCALL(TY71204*, Evalpipe_88374)(TY88028* P_88377, TY50526* N_88378, NimStringDesc* Filename_88379, TY71204* Start_88380);
N_NIMCALL(NIM_BOOL, Identeq_49028)(TY49011* Id_49030, NimStringDesc* Name_49031);
N_NIMCALL(TY71204*, Applyfilter_88337)(TY88028* P_88340, TY50526* N_88341, NimStringDesc* Filename_88342, TY71204* Stdin_88343);
N_NIMCALL(TY49011*, Getcallee_88258)(TY50526* N_88260);
N_NIMCALL(NimStringDesc*, Rendertree_81042)(TY50526* N_81044, NU8 Renderflags_81047);
N_NIMCALL(NU8, Getfilter_88184)(TY49011* Ident_88186);
N_NIMCALL(NU8, Getparser_88221)(TY49011* Ident_88223);
N_NIMCALL(TY71204*, Filtertmpl_87001)(TY71204* Stdin_87003, NimStringDesc* Filename_87004, TY50526* Call_87005);
N_NIMCALL(TY71204*, Filterstrip_86009)(TY71204* Stdin_86011, NimStringDesc* Filename_86012, TY50526* Call_86013);
N_NIMCALL(TY71204*, Filterreplace_86004)(TY71204* Stdin_86006, NimStringDesc* Filename_86007, TY50526* Call_86008);
N_NIMCALL(void, Rawmessage_42971)(NU8 Msg_42973, NimStringDesc** Args_42975, NI Args_42975Len0);
N_NIMCALL(void, Messageout_42775)(NimStringDesc* S_42777);
N_NIMCALL(TY71204*, Llstreamopen_71220)(FILE** F_71223);
N_NIMCALL(TY50526*, Parseall_88044)(TY88028* P_88047);
N_NIMCALL(TY50526*, Parseall_79004)(TY77011* P_79007);
N_NIMCALL(void, Internalerror_43163)(NimStringDesc* Errmsg_43165);
N_NIMCALL(void, Closeparsers_88040)(TY88028* P_88043);
N_NIMCALL(TY50526*, Parsetoplevelstmt_77028)(TY77011* P_77031);
N_NIMCALL(TY50526*, Parsetoplevelstmt_79008)(TY77011* P_79011);
STRING_LITERAL(TMP88020, "standard", 8);
STRING_LITERAL(TMP88021, "braces", 6);
STRING_LITERAL(TMP88022, "endx", 4);
NIM_CONST TY88013 Parsernames_88012 = {((NimStringDesc*) &TMP88020),
((NimStringDesc*) &TMP88021),
((NimStringDesc*) &TMP88022)}
;
STRING_LITERAL(TMP88023, "none", 4);
STRING_LITERAL(TMP88024, "stdtmpl", 7);
STRING_LITERAL(TMP88025, "replace", 7);
STRING_LITERAL(TMP88026, "strip", 5);
NIM_CONST TY88017 Filternames_88016 = {((NimStringDesc*) &TMP88023),
((NimStringDesc*) &TMP88024),
((NimStringDesc*) &TMP88025),
((NimStringDesc*) &TMP88026)}
;
STRING_LITERAL(TMP191745, "|", 1);
STRING_LITERAL(TMP191868, "parser to implement", 19);
extern TY50526* Emptynode_50858;
extern NI Gverbosity_41085;
N_NIMCALL(NI, Utf8bom_88077)(NimStringDesc* S_88079) {
NI Result_88080;
NIM_BOOL LOC2;
NIM_BOOL LOC3;
Result_88080 = 0;
LOC3 = ((NU8)(S_88079->data[0]) == (NU8)(239));
if (!(LOC3)) goto LA4;
LOC3 = ((NU8)(S_88079->data[1]) == (NU8)(187));
LA4: ;
LOC2 = LOC3;
if (!(LOC2)) goto LA5;
LOC2 = ((NU8)(S_88079->data[2]) == (NU8)(191));
LA5: ;
if (!LOC2) goto LA6;
Result_88080 = 3;
goto LA1;
LA6: ;
Result_88080 = 0;
LA1: ;
return Result_88080;
}
N_NIMCALL(NIM_BOOL, Containsshebang_88087)(NimStringDesc* S_88089, NI I_88090) {
NIM_BOOL Result_88091;
NIM_BOOL LOC2;
NI J_88096;
Result_88091 = 0;
LOC2 = ((NU8)(S_88089->data[I_88090]) == (NU8)(35));
if (!(LOC2)) goto LA3;
LOC2 = ((NU8)(S_88089->data[(NI64)(I_88090 + 1)]) == (NU8)(33));
LA3: ;
if (!LOC2) goto LA4;
J_88096 = 0;
J_88096 = (NI64)(I_88090 + 2);
while (1) {
if (!(((NU8)(S_88089->data[J_88096])) == ((NU8)(32)) || ((NU8)(S_88089->data[J_88096])) == ((NU8)(9)) || ((NU8)(S_88089->data[J_88096])) == ((NU8)(11)) || ((NU8)(S_88089->data[J_88096])) == ((NU8)(13)) || ((NU8)(S_88089->data[J_88096])) == ((NU8)(10)) || ((NU8)(S_88089->data[J_88096])) == ((NU8)(12)))) goto LA6;
J_88096 += 1;
} LA6: ;
Result_88091 = ((NU8)(S_88089->data[J_88096]) == (NU8)(47));
LA4: ;
return Result_88091;
}
N_NIMCALL(TY50526*, Parsepipe_88122)(NimStringDesc* Filename_88124, TY71204* Inputstream_88125) {
TY50526* Result_88126;
TY71204* S_88127;
NimStringDesc* Line_88139;
NI I_88140;
NIM_BOOL LOC5;
NIM_BOOL LOC9;
TY77011 Q_88180;
NimStringDesc* LOC14;
TY71204* LOC15;
Result_88126 = 0;
Result_88126 = Emptynode_50858;
S_88127 = 0;
S_88127 = Llstreamopen_71224(Filename_88124, ((NU8) 0));
if (!!((S_88127 == NIM_NIL))) goto LA2;
Line_88139 = 0;
Line_88139 = Llstreamreadline_71240(S_88127);
I_88140 = 0;
I_88140 = Utf8bom_88077(Line_88139);
LOC5 = Containsshebang_88087(Line_88139, I_88140);
if (!LOC5) goto LA6;
Line_88139 = Llstreamreadline_71240(S_88127);
I_88140 = 0;
LA6: ;
LOC9 = ((NU8)(Line_88139->data[I_88140]) == (NU8)(35));
if (!(LOC9)) goto LA10;
LOC9 = ((NU8)(Line_88139->data[(NI64)(I_88140 + 1)]) == (NU8)(33));
LA10: ;
if (!LOC9) goto LA11;
I_88140 += 2;
while (1) {
if (!(((NU8)(Line_88139->data[I_88140])) == ((NU8)(32)) || ((NU8)(Line_88139->data[I_88140])) == ((NU8)(9)) || ((NU8)(Line_88139->data[I_88140])) == ((NU8)(11)) || ((NU8)(Line_88139->data[I_88140])) == ((NU8)(13)) || ((NU8)(Line_88139->data[I_88140])) == ((NU8)(10)) || ((NU8)(Line_88139->data[I_88140])) == ((NU8)(12)))) goto LA13;
I_88140 += 1;
} LA13: ;
memset((void*)&Q_88180, 0, sizeof(Q_88180));
LOC14 = 0;
LOC14 = copyStr(Line_88139, I_88140);
LOC15 = 0;
LOC15 = Llstreamopen_71217(LOC14);
Openparser_77018(&Q_88180, Filename_88124, LOC15);
Result_88126 = Parseall_77014(&Q_88180);
Closeparser_77024(&Q_88180);
LA11: ;
Llstreamclose_71232(S_88127);
LA2: ;
return Result_88126;
}
N_NIMCALL(TY49011*, Getcallee_88258)(TY50526* N_88260) {
TY49011* Result_88261;
NIM_BOOL LOC2;
NimStringDesc* LOC8;
Result_88261 = 0;
LOC2 = ((*N_88260).Kind == ((NU8) 21));
if (!(LOC2)) goto LA3;
LOC2 = ((*(*N_88260).KindU.S6.Sons->data[0]).Kind == ((NU8) 2));
LA3: ;
if (!LOC2) goto LA4;
Result_88261 = (*(*N_88260).KindU.S6.Sons->data[0]).KindU.S5.Ident;
goto LA1;
LA4: ;
if (!((*N_88260).Kind == ((NU8) 2))) goto LA6;
Result_88261 = (*N_88260).KindU.S5.Ident;
goto LA1;
LA6: ;
LOC8 = 0;
LOC8 = Rendertree_81042(N_88260, 0);
Rawmessage_43045(((NU8) 159), LOC8);
LA1: ;
return Result_88261;
}
N_NIMCALL(NU8, Getfilter_88184)(TY49011* Ident_88186) {
NU8 Result_88187;
NU8 I_88218;
NU8 Res_88220;
NIM_BOOL LOC3;
Result_88187 = 0;
I_88218 = 0;
Res_88220 = 0;
Res_88220 = ((NU8) 0);
while (1) {
if (!(Res_88220 <= ((NU8) 3))) goto LA1;
I_88218 = Res_88220;
LOC3 = Identeq_49028(Ident_88186, Filternames_88016[(I_88218)-0]);
if (!LOC3) goto LA4;
Result_88187 = I_88218;
goto BeforeRet;
LA4: ;
Res_88220 += 1;
} LA1: ;
Result_88187 = ((NU8) 0);
BeforeRet: ;
return Result_88187;
}
N_NIMCALL(NU8, Getparser_88221)(TY49011* Ident_88223) {
NU8 Result_88224;
NU8 I_88255;
NU8 Res_88257;
NIM_BOOL LOC3;
Result_88224 = 0;
I_88255 = 0;
Res_88257 = 0;
Res_88257 = ((NU8) 0);
while (1) {
if (!(Res_88257 <= ((NU8) 2))) goto LA1;
I_88255 = Res_88257;
LOC3 = Identeq_49028(Ident_88223, Parsernames_88012[(I_88255)-0]);
if (!LOC3) goto LA4;
Result_88224 = I_88255;
goto BeforeRet;
LA4: ;
Res_88257 += 1;
} LA1: ;
Rawmessage_43045(((NU8) 28), (*Ident_88223).S);
BeforeRet: ;
return Result_88224;
}
N_NIMCALL(TY71204*, Applyfilter_88337)(TY88028* P_88340, TY50526* N_88341, NimStringDesc* Filename_88342, TY71204* Stdin_88343) {
TY71204* Result_88344;
TY49011* Ident_88345;
NU8 F_88346;
TY41331 LOC7;
TY41331 LOC8;
Result_88344 = 0;
Ident_88345 = 0;
Ident_88345 = Getcallee_88258(N_88341);
F_88346 = 0;
F_88346 = Getfilter_88184(Ident_88345);
switch (F_88346) {
case ((NU8) 0):
(*P_88340).Skin = Getparser_88221(Ident_88345);
Result_88344 = Stdin_88343;
break;
case ((NU8) 1):
Result_88344 = Filtertmpl_87001(Stdin_88343, Filename_88342, N_88341);
break;
case ((NU8) 3):
Result_88344 = Filterstrip_86009(Stdin_88343, Filename_88342, N_88341);
break;
case ((NU8) 2):
Result_88344 = Filterreplace_86004(Stdin_88343, Filename_88342, N_88341);
break;
}
if (!!((F_88346 == ((NU8) 0)))) goto LA2;
if (!(2 <= Gverbosity_41085)) goto LA5;
memset((void*)&LOC7, 0, sizeof(LOC7));
Rawmessage_42971(((NU8) 232), LOC7, 0);
Messageout_42775((*Result_88344).S);
memset((void*)&LOC8, 0, sizeof(LOC8));
Rawmessage_42971(((NU8) 233), LOC8, 0);
LA5: ;
LA2: ;
return Result_88344;
}
N_NIMCALL(TY71204*, Evalpipe_88374)(TY88028* P_88377, TY50526* N_88378, NimStringDesc* Filename_88379, TY71204* Start_88380) {
TY71204* Result_88381;
NIM_BOOL LOC5;
NIM_BOOL LOC6;
NI I_88468;
NI Res_88536;
Result_88381 = 0;
Result_88381 = Start_88380;
if (!((*N_88378).Kind == ((NU8) 1))) goto LA2;
goto BeforeRet;
LA2: ;
LOC6 = ((*N_88378).Kind == ((NU8) 27));
if (!(LOC6)) goto LA7;
LOC6 = ((*(*N_88378).KindU.S6.Sons->data[0]).Kind == ((NU8) 2));
LA7: ;
LOC5 = LOC6;
if (!(LOC5)) goto LA8;
LOC5 = Identeq_49028((*(*N_88378).KindU.S6.Sons->data[0]).KindU.S5.Ident, ((NimStringDesc*) &TMP191745));
LA8: ;
if (!LOC5) goto LA9;
I_88468 = 0;
Res_88536 = 0;
Res_88536 = 1;
while (1) {
if (!(Res_88536 <= 2)) goto LA11;
I_88468 = Res_88536;
if (!((*(*N_88378).KindU.S6.Sons->data[I_88468]).Kind == ((NU8) 27))) goto LA13;
Result_88381 = Evalpipe_88374(P_88377, (*N_88378).KindU.S6.Sons->data[I_88468], Filename_88379, Result_88381);
goto LA12;
LA13: ;
Result_88381 = Applyfilter_88337(P_88377, (*N_88378).KindU.S6.Sons->data[I_88468], Filename_88379, Result_88381);
LA12: ;
Res_88536 += 1;
} LA11: ;
goto LA4;
LA9: ;
if (!((*N_88378).Kind == ((NU8) 101))) goto LA15;
Result_88381 = Evalpipe_88374(P_88377, (*N_88378).KindU.S6.Sons->data[0], Filename_88379, Result_88381);
goto LA4;
LA15: ;
Result_88381 = Applyfilter_88337(P_88377, N_88378, Filename_88379, Result_88381);
LA4: ;
BeforeRet: ;
return Result_88381;
}
N_NIMCALL(void, Openparsers_88034)(TY88028* P_88037, NimStringDesc* Filename_88038, TY71204* Inputstream_88039) {
TY71204* S_88543;
TY50526* Pipe_88544;
S_88543 = 0;
(*P_88037).Skin = ((NU8) 0);
Pipe_88544 = 0;
Pipe_88544 = Parsepipe_88122(Filename_88038, Inputstream_88039);
if (!!((Pipe_88544 == NIM_NIL))) goto LA2;
S_88543 = Evalpipe_88374(P_88037, Pipe_88544, Filename_88038, Inputstream_88039);
goto LA1;
LA2: ;
S_88543 = Inputstream_88039;
LA1: ;
switch ((*P_88037).Skin) {
case ((NU8) 0):
case ((NU8) 1):
case ((NU8) 2):
Openparser_77018(&(*P_88037).Parser, Filename_88038, S_88543);
break;
}
}
N_NIMCALL(TY50526*, Parseall_88044)(TY88028* P_88047) {
TY50526* Result_88067;
Result_88067 = 0;
switch ((*P_88047).Skin) {
case ((NU8) 0):
Result_88067 = Parseall_77014(&(*P_88047).Parser);
break;
case ((NU8) 1):
Result_88067 = Parseall_79004(&(*P_88047).Parser);
break;
case ((NU8) 2):
Internalerror_43163(((NimStringDesc*) &TMP191868));
Result_88067 = Emptynode_50858;
break;
}
return Result_88067;
}
N_NIMCALL(void, Closeparsers_88040)(TY88028* P_88043) {
Closeparser_77024(&(*P_88043).Parser);
}
N_NIMCALL(TY50526*, Parsefile_88031)(NimStringDesc* Filename_88033) {
TY50526* Result_88055;
TY88028 P_88056;
FILE* F_88057;
NIM_BOOL LOC2;
TY71204* LOC5;
Result_88055 = 0;
memset((void*)&P_88056, 0, sizeof(P_88056));
F_88057 = 0;
LOC2 = Open_3817(&F_88057, Filename_88033, ((NU8) 0), -1);
if (!!(LOC2)) goto LA3;
Rawmessage_43045(((NU8) 2), Filename_88033);
goto BeforeRet;
LA3: ;
LOC5 = 0;
LOC5 = Llstreamopen_71220(&F_88057);
Openparsers_88034(&P_88056, Filename_88033, LOC5);
Result_88055 = Parseall_88044(&P_88056);
Closeparsers_88040(&P_88056);
BeforeRet: ;
return Result_88055;
}
N_NIMCALL(TY50526*, Parsetoplevelstmt_88048)(TY88028* P_88051) {
TY50526* Result_88074;
Result_88074 = 0;
switch ((*P_88051).Skin) {
case ((NU8) 0):
Result_88074 = Parsetoplevelstmt_77028(&(*P_88051).Parser);
break;
case ((NU8) 1):
Result_88074 = Parsetoplevelstmt_79008(&(*P_88051).Parser);
break;
case ((NU8) 2):
Internalerror_43163(((NimStringDesc*) &TMP191868));
Result_88074 = Emptynode_50858;
break;
}
return Result_88074;
}
N_NOINLINE(void, syntaxesInit)(void) {
}

