/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY50525 TY50525;
typedef struct TY87028 TY87028;
typedef struct TY76011 TY76011;
typedef struct TY72267 TY72267;
typedef struct TY72263 TY72263;
typedef struct TY70013 TY70013;
typedef struct TY50551 TY50551;
typedef struct TY42536 TY42536;
typedef struct TY50547 TY50547;
typedef struct TY49011 TY49011;
typedef struct TY50519 TY50519;
typedef struct TY49005 TY49005;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY71015 TY71015;
typedef struct TY72281 TY72281;
typedef struct TY50549 TY50549;
typedef struct TY50539 TY50539;
typedef struct TY47008 TY47008;
typedef struct TY50529 TY50529;
typedef struct TY50527 TY50527;
typedef struct TY50543 TY50543;
typedef struct TY38013 TY38013;
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY239[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY239 data;
};
typedef NimStringDesc* TY87013[3];
typedef NimStringDesc* TY87017[4];
struct TY76011 {
TY72267* Lex;
TY72263* Tok;
};
struct TY87028 {
NU8 Skin;
TY76011 Parser;
};
struct TY42536 {
NI16 Line;
NI16 Col;
NI32 Fileindex;
};
struct TY50525 {
TY50551* Typ;
NimStringDesc* Comment;
TY42536 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {TY50547* Sym;
} S4;
struct {TY49011* Ident;
} S5;
struct {TY50519* Sons;
} S6;
} KindU;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY49005 {
  TNimObject Sup;
NI Id;
};
struct TY49011 {
  TY49005 Sup;
NimStringDesc* S;
TY49011* Next;
NI H;
};
typedef NimStringDesc* TY41320[1];
struct TY70013 {
  TNimObject Sup;
NU8 Kind;
FILE* F;
NimStringDesc* S;
NI Rd;
NI Wr;
};
struct TY71015 {
  TNimObject Sup;
NI Bufpos;
NCSTRING Buf;
NI Buflen;
TY70013* Stream;
NI Linenumber;
NI Sentinel;
NI Linestart;
};
struct TY72267 {
  TY71015 Sup;
NimStringDesc* Filename;
TY72281* Indentstack;
NI Dedent;
NI Indentahead;
};
struct TY72263 {
TNimType* m_type;
NU8 Toktype;
NI Indent;
TY49011* Ident;
NI64 Inumber;
NF64 Fnumber;
NU8 Base;
NimStringDesc* Literal;
TY72263* Next;
};
struct TY50539 {
NU8 K;
NU8 S;
NU8 Flags;
TY50551* T;
TY47008* R;
NI A;
};
struct TY50551 {
  TY49005 Sup;
NU8 Kind;
TY50549* Sons;
TY50525* N;
NU8 Flags;
NU8 Callconv;
TY50547* Owner;
TY50547* Sym;
NI64 Size;
NI Align;
NI Containerid;
TY50539 Loc;
};
struct TY50529 {
TNimType* m_type;
NI Counter;
TY50527* Data;
};
struct TY50547 {
  TY49005 Sup;
NU8 Kind;
NU8 Magic;
TY50551* Typ;
TY49011* Name;
TY42536 Info;
TY50547* Owner;
NU32 Flags;
TY50529 Tab;
TY50525* Ast;
NU32 Options;
NI Position;
NI Offset;
TY50539 Loc;
TY50543* Annex;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY47008 {
  TNimObject Sup;
TY47008* Left;
TY47008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY38013 {
  TNimObject Sup;
TY38013* Prev;
TY38013* Next;
};
struct TY50543 {
  TY38013 Sup;
NU8 Kind;
NIM_BOOL Generated;
TY47008* Name;
TY50525* Path;
};
struct TY50519 {
  TGenericSeq Sup;
  TY50525* data[SEQ_DECL_SIZE];
};
struct TY72281 {
  TGenericSeq Sup;
  NI data[SEQ_DECL_SIZE];
};
struct TY50549 {
  TGenericSeq Sup;
  TY50551* data[SEQ_DECL_SIZE];
};
struct TY50527 {
  TGenericSeq Sup;
  TY50547* data[SEQ_DECL_SIZE];
};
N_NIMCALL(NIM_BOOL, Open_3617)(FILE** F_3620, NimStringDesc* Filename_3621, NU8 Mode_3622, NI Bufsize_3623);
N_NIMCALL(void, Rawmessage_42557)(NU8 Msg_42559, NimStringDesc* Arg_42560);
N_NIMCALL(void, Openparsers_87034)(TY87028* P_87037, NimStringDesc* Filename_87038, TY70013* Inputstream_87039);
N_NIMCALL(TY50525*, Parsepipe_87122)(NimStringDesc* Filename_87124, TY70013* Inputstream_87125);
N_NIMCALL(TY70013*, Llstreamopen_70032)(NimStringDesc* Filename_70034, NU8 Mode_70035);
N_NIMCALL(NimStringDesc*, Llstreamreadline_70048)(TY70013* S_70050);
N_NIMCALL(NI, Utf8bom_87077)(NimStringDesc* S_87079);
N_NIMCALL(NIM_BOOL, Containsshebang_87087)(NimStringDesc* S_87089, NI I_87090);
N_NIMCALL(void, Openparser_76018)(TY76011* P_76021, NimStringDesc* Filename_76022, TY70013* Inputstream_76023);
N_NIMCALL(TY70013*, Llstreamopen_70025)(NimStringDesc* Data_70027);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* S_1924, NI First_1925);
N_NIMCALL(TY50525*, Parseall_76014)(TY76011* P_76017);
N_NIMCALL(void, Closeparser_76024)(TY76011* P_76027);
N_NIMCALL(void, Llstreamclose_70040)(TY70013* S_70042);
N_NIMCALL(TY70013*, Evalpipe_87372)(TY87028* P_87375, TY50525* N_87376, NimStringDesc* Filename_87377, TY70013* Start_87378);
N_NIMCALL(NIM_BOOL, Identeq_49028)(TY49011* Id_49030, NimStringDesc* Name_49031);
N_NIMCALL(TY70013*, Applyfilter_87335)(TY87028* P_87338, TY50525* N_87339, NimStringDesc* Filename_87340, TY70013* Stdin_87341);
N_NIMCALL(TY49011*, Getcallee_87256)(TY50525* N_87258);
N_NIMCALL(NimStringDesc*, Rendertree_80042)(TY50525* N_80044, NU8 Renderflags_80047);
N_NIMCALL(NU8, Getfilter_87184)(TY49011* Ident_87186);
N_NIMCALL(NU8, Getparser_87220)(TY49011* Ident_87222);
N_NIMCALL(TY70013*, Filtertmpl_86001)(TY70013* Stdin_86003, NimStringDesc* Filename_86004, TY50525* Call_86005);
N_NIMCALL(TY70013*, Filterstrip_85009)(TY70013* Stdin_85011, NimStringDesc* Filename_85012, TY50525* Call_85013);
N_NIMCALL(TY70013*, Filterreplace_85004)(TY70013* Stdin_85006, NimStringDesc* Filename_85007, TY50525* Call_85008);
N_NIMCALL(void, Rawmessage_42561)(NU8 Msg_42563, NimStringDesc** Args_42565, NI Args_42565Len0);
N_NIMCALL(void, Messageout_42554)(NimStringDesc* S_42556);
N_NIMCALL(TY70013*, Llstreamopen_70028)(FILE** F_70031);
N_NIMCALL(TY50525*, Parseall_87044)(TY87028* P_87047);
N_NIMCALL(TY50525*, Parseall_78004)(TY76011* P_78007);
N_NIMCALL(void, Internalerror_42575)(NimStringDesc* Errmsg_42577);
N_NIMCALL(void, Closeparsers_87040)(TY87028* P_87043);
N_NIMCALL(TY50525*, Parsetoplevelstmt_76028)(TY76011* P_76031);
N_NIMCALL(TY50525*, Parsetoplevelstmt_78008)(TY76011* P_78011);
STRING_LITERAL(TMP87020, "standard", 8);
STRING_LITERAL(TMP87021, "braces", 6);
STRING_LITERAL(TMP87022, "endx", 4);
NIM_CONST TY87013 Parsernames_87012 = {((NimStringDesc*) &TMP87020),
((NimStringDesc*) &TMP87021),
((NimStringDesc*) &TMP87022)}
;
STRING_LITERAL(TMP87023, "none", 4);
STRING_LITERAL(TMP87024, "stdtmpl", 7);
STRING_LITERAL(TMP87025, "replace", 7);
STRING_LITERAL(TMP87026, "strip", 5);
NIM_CONST TY87017 Filternames_87016 = {((NimStringDesc*) &TMP87023),
((NimStringDesc*) &TMP87024),
((NimStringDesc*) &TMP87025),
((NimStringDesc*) &TMP87026)}
;
STRING_LITERAL(TMP189739, "|", 1);
STRING_LITERAL(TMP189862, "parser to implement", 19);
extern NI Gverbosity_41084;
N_NIMCALL(NI, Utf8bom_87077)(NimStringDesc* S_87079) {
NI Result_87080;
NIM_BOOL LOC2;
NIM_BOOL LOC3;
Result_87080 = 0;
LOC3 = ((NU8)(S_87079->data[0]) == (NU8)(239));
if (!(LOC3)) goto LA4;
LOC3 = ((NU8)(S_87079->data[1]) == (NU8)(187));
LA4: ;
LOC2 = LOC3;
if (!(LOC2)) goto LA5;
LOC2 = ((NU8)(S_87079->data[2]) == (NU8)(191));
LA5: ;
if (!LOC2) goto LA6;
Result_87080 = 3;
goto LA1;
LA6: ;
Result_87080 = 0;
LA1: ;
return Result_87080;
}
N_NIMCALL(NIM_BOOL, Containsshebang_87087)(NimStringDesc* S_87089, NI I_87090) {
NIM_BOOL Result_87091;
NIM_BOOL LOC2;
NI J_87096;
Result_87091 = 0;
LOC2 = ((NU8)(S_87089->data[I_87090]) == (NU8)(35));
if (!(LOC2)) goto LA3;
LOC2 = ((NU8)(S_87089->data[(NI64)(I_87090 + 1)]) == (NU8)(33));
LA3: ;
if (!LOC2) goto LA4;
J_87096 = 0;
J_87096 = (NI64)(I_87090 + 2);
while (1) {
if (!(((NU8)(S_87089->data[J_87096])) == ((NU8)(32)) || ((NU8)(S_87089->data[J_87096])) == ((NU8)(9)) || ((NU8)(S_87089->data[J_87096])) == ((NU8)(11)) || ((NU8)(S_87089->data[J_87096])) == ((NU8)(13)) || ((NU8)(S_87089->data[J_87096])) == ((NU8)(10)) || ((NU8)(S_87089->data[J_87096])) == ((NU8)(12)))) goto LA6;
J_87096 += 1;
} LA6: ;
Result_87091 = ((NU8)(S_87089->data[J_87096]) == (NU8)(47));
LA4: ;
return Result_87091;
}
N_NIMCALL(TY50525*, Parsepipe_87122)(NimStringDesc* Filename_87124, TY70013* Inputstream_87125) {
TY50525* Result_87126;
TY70013* S_87127;
NimStringDesc* Line_87139;
NI I_87140;
NIM_BOOL LOC5;
NIM_BOOL LOC9;
TY76011 Q_87180;
NimStringDesc* LOC14;
TY70013* LOC15;
Result_87126 = 0;
S_87127 = 0;
S_87127 = Llstreamopen_70032(Filename_87124, ((NU8) 0));
if (!!((S_87127 == NIM_NIL))) goto LA2;
Line_87139 = 0;
Line_87139 = Llstreamreadline_70048(S_87127);
I_87140 = 0;
I_87140 = Utf8bom_87077(Line_87139);
LOC5 = Containsshebang_87087(Line_87139, I_87140);
if (!LOC5) goto LA6;
Line_87139 = Llstreamreadline_70048(S_87127);
I_87140 = 0;
LA6: ;
LOC9 = ((NU8)(Line_87139->data[I_87140]) == (NU8)(35));
if (!(LOC9)) goto LA10;
LOC9 = ((NU8)(Line_87139->data[(NI64)(I_87140 + 1)]) == (NU8)(33));
LA10: ;
if (!LOC9) goto LA11;
I_87140 += 2;
while (1) {
if (!(((NU8)(Line_87139->data[I_87140])) == ((NU8)(32)) || ((NU8)(Line_87139->data[I_87140])) == ((NU8)(9)) || ((NU8)(Line_87139->data[I_87140])) == ((NU8)(11)) || ((NU8)(Line_87139->data[I_87140])) == ((NU8)(13)) || ((NU8)(Line_87139->data[I_87140])) == ((NU8)(10)) || ((NU8)(Line_87139->data[I_87140])) == ((NU8)(12)))) goto LA13;
I_87140 += 1;
} LA13: ;
memset((void*)&Q_87180, 0, sizeof(Q_87180));
LOC14 = 0;
LOC14 = copyStr(Line_87139, I_87140);
LOC15 = 0;
LOC15 = Llstreamopen_70025(LOC14);
Openparser_76018(&Q_87180, Filename_87124, LOC15);
Result_87126 = Parseall_76014(&Q_87180);
Closeparser_76024(&Q_87180);
LA11: ;
Llstreamclose_70040(S_87127);
LA2: ;
return Result_87126;
}
N_NIMCALL(TY49011*, Getcallee_87256)(TY50525* N_87258) {
TY49011* Result_87259;
NIM_BOOL LOC2;
NimStringDesc* LOC8;
Result_87259 = 0;
LOC2 = ((*N_87258).Kind == ((NU8) 21));
if (!(LOC2)) goto LA3;
LOC2 = ((*(*N_87258).KindU.S6.Sons->data[0]).Kind == ((NU8) 2));
LA3: ;
if (!LOC2) goto LA4;
Result_87259 = (*(*N_87258).KindU.S6.Sons->data[0]).KindU.S5.Ident;
goto LA1;
LA4: ;
if (!((*N_87258).Kind == ((NU8) 2))) goto LA6;
Result_87259 = (*N_87258).KindU.S5.Ident;
goto LA1;
LA6: ;
LOC8 = 0;
LOC8 = Rendertree_80042(N_87258, 0);
Rawmessage_42557(((NU8) 160), LOC8);
LA1: ;
return Result_87259;
}
N_NIMCALL(NU8, Getfilter_87184)(TY49011* Ident_87186) {
NU8 Result_87187;
NU8 I_87217;
NU8 Res_87219;
NIM_BOOL LOC3;
Result_87187 = 0;
I_87217 = 0;
Res_87219 = 0;
Res_87219 = ((NU8) 0);
while (1) {
if (!(Res_87219 <= ((NU8) 3))) goto LA1;
I_87217 = Res_87219;
LOC3 = Identeq_49028(Ident_87186, Filternames_87016[(I_87217)-0]);
if (!LOC3) goto LA4;
Result_87187 = I_87217;
goto BeforeRet;
LA4: ;
Res_87219 += 1;
} LA1: ;
Result_87187 = ((NU8) 0);
BeforeRet: ;
return Result_87187;
}
N_NIMCALL(NU8, Getparser_87220)(TY49011* Ident_87222) {
NU8 Result_87223;
NU8 I_87253;
NU8 Res_87255;
NIM_BOOL LOC3;
Result_87223 = 0;
I_87253 = 0;
Res_87255 = 0;
Res_87255 = ((NU8) 0);
while (1) {
if (!(Res_87255 <= ((NU8) 2))) goto LA1;
I_87253 = Res_87255;
LOC3 = Identeq_49028(Ident_87222, Parsernames_87012[(I_87253)-0]);
if (!LOC3) goto LA4;
Result_87223 = I_87253;
goto BeforeRet;
LA4: ;
Res_87255 += 1;
} LA1: ;
Rawmessage_42557(((NU8) 28), (*Ident_87222).S);
BeforeRet: ;
return Result_87223;
}
N_NIMCALL(TY70013*, Applyfilter_87335)(TY87028* P_87338, TY50525* N_87339, NimStringDesc* Filename_87340, TY70013* Stdin_87341) {
TY70013* Result_87342;
TY49011* Ident_87343;
NU8 F_87344;
TY41320 LOC7;
TY41320 LOC8;
Result_87342 = 0;
Ident_87343 = 0;
Ident_87343 = Getcallee_87256(N_87339);
F_87344 = 0;
F_87344 = Getfilter_87184(Ident_87343);
switch (F_87344) {
case ((NU8) 0):
(*P_87338).Skin = Getparser_87220(Ident_87343);
Result_87342 = Stdin_87341;
break;
case ((NU8) 1):
Result_87342 = Filtertmpl_86001(Stdin_87341, Filename_87340, N_87339);
break;
case ((NU8) 3):
Result_87342 = Filterstrip_85009(Stdin_87341, Filename_87340, N_87339);
break;
case ((NU8) 2):
Result_87342 = Filterreplace_85004(Stdin_87341, Filename_87340, N_87339);
break;
}
if (!!((F_87344 == ((NU8) 0)))) goto LA2;
if (!(2 <= Gverbosity_41084)) goto LA5;
memset((void*)&LOC7, 0, sizeof(LOC7));
Rawmessage_42561(((NU8) 233), LOC7, 0);
Messageout_42554((*Result_87342).S);
memset((void*)&LOC8, 0, sizeof(LOC8));
Rawmessage_42561(((NU8) 234), LOC8, 0);
LA5: ;
LA2: ;
return Result_87342;
}
N_NIMCALL(TY70013*, Evalpipe_87372)(TY87028* P_87375, TY50525* N_87376, NimStringDesc* Filename_87377, TY70013* Start_87378) {
TY70013* Result_87379;
NIM_BOOL LOC5;
NIM_BOOL LOC6;
NI I_87467;
NI Res_87535;
Result_87379 = 0;
Result_87379 = Start_87378;
if (!(N_87376 == NIM_NIL)) goto LA2;
goto BeforeRet;
LA2: ;
LOC6 = ((*N_87376).Kind == ((NU8) 27));
if (!(LOC6)) goto LA7;
LOC6 = ((*(*N_87376).KindU.S6.Sons->data[0]).Kind == ((NU8) 2));
LA7: ;
LOC5 = LOC6;
if (!(LOC5)) goto LA8;
LOC5 = Identeq_49028((*(*N_87376).KindU.S6.Sons->data[0]).KindU.S5.Ident, ((NimStringDesc*) &TMP189739));
LA8: ;
if (!LOC5) goto LA9;
I_87467 = 0;
Res_87535 = 0;
Res_87535 = 1;
while (1) {
if (!(Res_87535 <= 2)) goto LA11;
I_87467 = Res_87535;
if (!((*(*N_87376).KindU.S6.Sons->data[I_87467]).Kind == ((NU8) 27))) goto LA13;
Result_87379 = Evalpipe_87372(P_87375, (*N_87376).KindU.S6.Sons->data[I_87467], Filename_87377, Result_87379);
goto LA12;
LA13: ;
Result_87379 = Applyfilter_87335(P_87375, (*N_87376).KindU.S6.Sons->data[I_87467], Filename_87377, Result_87379);
LA12: ;
Res_87535 += 1;
} LA11: ;
goto LA4;
LA9: ;
if (!((*N_87376).Kind == ((NU8) 101))) goto LA15;
Result_87379 = Evalpipe_87372(P_87375, (*N_87376).KindU.S6.Sons->data[0], Filename_87377, Result_87379);
goto LA4;
LA15: ;
Result_87379 = Applyfilter_87335(P_87375, N_87376, Filename_87377, Result_87379);
LA4: ;
BeforeRet: ;
return Result_87379;
}
N_NIMCALL(void, Openparsers_87034)(TY87028* P_87037, NimStringDesc* Filename_87038, TY70013* Inputstream_87039) {
TY70013* S_87542;
TY50525* Pipe_87543;
S_87542 = 0;
(*P_87037).Skin = ((NU8) 0);
Pipe_87543 = 0;
Pipe_87543 = Parsepipe_87122(Filename_87038, Inputstream_87039);
if (!!((Pipe_87543 == NIM_NIL))) goto LA2;
S_87542 = Evalpipe_87372(P_87037, Pipe_87543, Filename_87038, Inputstream_87039);
goto LA1;
LA2: ;
S_87542 = Inputstream_87039;
LA1: ;
switch ((*P_87037).Skin) {
case ((NU8) 0):
case ((NU8) 1):
case ((NU8) 2):
Openparser_76018(&(*P_87037).Parser, Filename_87038, S_87542);
break;
}
}
N_NIMCALL(TY50525*, Parseall_87044)(TY87028* P_87047) {
TY50525* Result_87067;
Result_87067 = 0;
switch ((*P_87047).Skin) {
case ((NU8) 0):
Result_87067 = Parseall_76014(&(*P_87047).Parser);
break;
case ((NU8) 1):
Result_87067 = Parseall_78004(&(*P_87047).Parser);
break;
case ((NU8) 2):
Internalerror_42575(((NimStringDesc*) &TMP189862));
break;
}
return Result_87067;
}
N_NIMCALL(void, Closeparsers_87040)(TY87028* P_87043) {
Closeparser_76024(&(*P_87043).Parser);
}
N_NIMCALL(TY50525*, Parsefile_87031)(NimStringDesc* Filename_87033) {
TY50525* Result_87055;
TY87028 P_87056;
FILE* F_87057;
NIM_BOOL LOC2;
TY70013* LOC5;
Result_87055 = 0;
memset((void*)&P_87056, 0, sizeof(P_87056));
F_87057 = 0;
LOC2 = Open_3617(&F_87057, Filename_87033, ((NU8) 0), -1);
if (!!(LOC2)) goto LA3;
Rawmessage_42557(((NU8) 2), Filename_87033);
goto BeforeRet;
LA3: ;
LOC5 = 0;
LOC5 = Llstreamopen_70028(&F_87057);
Openparsers_87034(&P_87056, Filename_87033, LOC5);
Result_87055 = Parseall_87044(&P_87056);
Closeparsers_87040(&P_87056);
BeforeRet: ;
return Result_87055;
}
N_NIMCALL(TY50525*, Parsetoplevelstmt_87048)(TY87028* P_87051) {
TY50525* Result_87074;
Result_87074 = 0;
switch ((*P_87051).Skin) {
case ((NU8) 0):
Result_87074 = Parsetoplevelstmt_76028(&(*P_87051).Parser);
break;
case ((NU8) 1):
Result_87074 = Parsetoplevelstmt_78008(&(*P_87051).Parser);
break;
case ((NU8) 2):
Internalerror_42575(((NimStringDesc*) &TMP189862));
break;
}
return Result_87074;
}
N_NOINLINE(void, syntaxesInit)(void) {
}

