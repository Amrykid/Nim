/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long int NI;
typedef unsigned long int NU;
#include "nimbase.h"

typedef struct TY55011 TY55011;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY55005 TY55005;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY10802 TY10802;
typedef struct TY10818 TY10818;
typedef struct TY11196 TY11196;
typedef struct TY10814 TY10814;
typedef struct TY10810 TY10810;
typedef struct TY11194 TY11194;
typedef TY55011* TY55039[8192];
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY245[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY245 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY55005 {
  TNimObject Sup;
NI Id;
};
struct TY55011 {
  TY55005 Sup;
NimStringDesc* S;
TY55011* Next;
NI H;
};
struct TY10802 {
NI Refcount;
TNimType* Typ;
};
struct TY10818 {
NI Len;
NI Cap;
TY10802** D;
};
struct TY10814 {
NI Counter;
NI Max;
TY10810* Head;
TY10810** Data;
};
struct TY11194 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY11196 {
TY10818 Zct;
TY10818 Decstack;
TY10814 Cycleroots;
TY10818 Tempstack;
TY11194 Stat;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
typedef NI TY8814[16];
struct TY10810 {
TY10810* Next;
NI Key;
TY8814 Bits;
};
N_NIMCALL(TY55011*, Getident_55023)(NCSTRING Identifier_55025, NI Length_55026, NI H_55027);
N_NIMCALL(NI, Cmpexact_55164)(NCSTRING A_55166, NCSTRING B_55167, NI Blen_55168);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13218, void* Src_13219);
static N_INLINE(TY10802*, Usrtocell_11612)(void* Usr_11614);
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225);
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230);
static N_INLINE(void, Rtladdzct_12601)(TY10802* C_12603);
N_NOINLINE(void, Addzct_11601)(TY10818* S_11604, TY10802* C_11605);
N_NIMCALL(NI, Cmpignorestyle_55042)(NCSTRING A_55044, NCSTRING B_55045, NI Blen_55046);
N_NIMCALL(void*, newObj)(TNimType* Typ_13910, NI Size_13911);
N_NIMCALL(NimStringDesc*, mnewString)(NI Len_1353);
N_NIMCALL(NI, Getnormalizedhash_45037)(NimStringDesc* S_45039);
N_NIMCALL(TY55011*, Getident_55016)(NimStringDesc* Identifier_55018);
TY55039 Buckets_55041;
NI Wordcounter_55233;
extern TY11196 Gch_11214;
extern TNimType* NTI55009; /* PIdent */
extern TNimType* NTI55011; /* TIdent */
N_NIMCALL(NI, Cmpexact_55164)(NCSTRING A_55166, NCSTRING B_55167, NI Blen_55168) {
NI Result_55169;
NIM_CHAR Aa_55170;
NIM_CHAR Bb_55171;
NI I_55172;
NI J_55173;
NIM_BOOL LOC3;
Result_55169 = 0;
Aa_55170 = 0;
Bb_55171 = 0;
I_55172 = 0;
J_55173 = 0;
I_55172 = 0;
J_55173 = 0;
Result_55169 = 1;
while (1) {
if (!(J_55173 < Blen_55168)) goto LA1;
Aa_55170 = A_55166[I_55172];
Bb_55171 = B_55167[J_55173];
Result_55169 = (NI32)(((NU8)(Aa_55170)) - ((NU8)(Bb_55171)));
LOC3 = !((Result_55169 == 0));
if (LOC3) goto LA4;
LOC3 = ((NU8)(Aa_55170) == (NU8)(0));
LA4: ;
if (!LOC3) goto LA5;
goto LA1;
LA5: ;
I_55172 += 1;
J_55173 += 1;
} LA1: ;
if (!(Result_55169 == 0)) goto LA8;
if (!!(((NU8)(A_55166[I_55172]) == (NU8)(0)))) goto LA11;
Result_55169 = 1;
LA11: ;
LA8: ;
return Result_55169;
}
static N_INLINE(TY10802*, Usrtocell_11612)(void* Usr_11614) {
TY10802* Result_11615;
Result_11615 = 0;
Result_11615 = ((TY10802*) ((NI32)((NU32)(((NI) (Usr_11614))) - (NU32)(((NI) (((NI)sizeof(TY10802))))))));
return Result_11615;
}
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225) {
NI Result_7807;
Result_7807 = 0;
(*Memloc_3224) += X_3225;
Result_7807 = (*Memloc_3224);
return Result_7807;
}
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230) {
NI Result_8006;
Result_8006 = 0;
(*Memloc_3229) -= X_3230;
Result_8006 = (*Memloc_3229);
return Result_8006;
}
static N_INLINE(void, Rtladdzct_12601)(TY10802* C_12603) {
Addzct_11601(&Gch_11214.Zct, C_12603);
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13218, void* Src_13219) {
TY10802* C_13220;
NI LOC4;
TY10802* C_13222;
NI LOC9;
if (!!((Src_13219 == NIM_NIL))) goto LA2;
C_13220 = 0;
C_13220 = Usrtocell_11612(Src_13219);
LOC4 = Atomicinc_3221(&(*C_13220).Refcount, 8);
LA2: ;
if (!!(((*Dest_13218) == NIM_NIL))) goto LA6;
C_13222 = 0;
C_13222 = Usrtocell_11612((*Dest_13218));
LOC9 = Atomicdec_3226(&(*C_13222).Refcount, 8);
if (!((NU32)(LOC9) < (NU32)(8))) goto LA10;
Rtladdzct_12601(C_13222);
LA10: ;
LA6: ;
(*Dest_13218) = Src_13219;
}
N_NIMCALL(NI, Cmpignorestyle_55042)(NCSTRING A_55044, NCSTRING B_55045, NI Blen_55046) {
NI Result_55047;
NIM_CHAR Aa_55048;
NIM_CHAR Bb_55049;
NI I_55050;
NI J_55051;
NIM_BOOL LOC5;
NIM_BOOL LOC10;
NIM_BOOL LOC15;
Result_55047 = 0;
Aa_55048 = 0;
Bb_55049 = 0;
I_55050 = 0;
J_55051 = 0;
I_55050 = 0;
J_55051 = 0;
Result_55047 = 1;
while (1) {
if (!(J_55051 < Blen_55046)) goto LA1;
while (1) {
if (!((NU8)(A_55044[I_55050]) == (NU8)(95))) goto LA2;
I_55050 += 1;
} LA2: ;
while (1) {
if (!((NU8)(B_55045[J_55051]) == (NU8)(95))) goto LA3;
J_55051 += 1;
} LA3: ;
Aa_55048 = A_55044[I_55050];
Bb_55049 = B_55045[J_55051];
LOC5 = ((NU8)(65) <= (NU8)(Aa_55048));
if (!(LOC5)) goto LA6;
LOC5 = ((NU8)(Aa_55048) <= (NU8)(90));
LA6: ;
if (!LOC5) goto LA7;
Aa_55048 = ((NIM_CHAR) (((NI) ((NI32)(((NU8)(Aa_55048)) + 32)))));
LA7: ;
LOC10 = ((NU8)(65) <= (NU8)(Bb_55049));
if (!(LOC10)) goto LA11;
LOC10 = ((NU8)(Bb_55049) <= (NU8)(90));
LA11: ;
if (!LOC10) goto LA12;
Bb_55049 = ((NIM_CHAR) (((NI) ((NI32)(((NU8)(Bb_55049)) + 32)))));
LA12: ;
Result_55047 = (NI32)(((NU8)(Aa_55048)) - ((NU8)(Bb_55049)));
LOC15 = !((Result_55047 == 0));
if (LOC15) goto LA16;
LOC15 = ((NU8)(Aa_55048) == (NU8)(0));
LA16: ;
if (!LOC15) goto LA17;
goto LA1;
LA17: ;
I_55050 += 1;
J_55051 += 1;
} LA1: ;
if (!(Result_55047 == 0)) goto LA20;
if (!!(((NU8)(A_55044[I_55050]) == (NU8)(0)))) goto LA23;
Result_55047 = 1;
LA23: ;
LA20: ;
return Result_55047;
}
N_NIMCALL(TY55011*, Getident_55023)(NCSTRING Identifier_55025, NI Length_55026, NI H_55027) {
TY55011* Result_55239;
NI Idx_55240;
NI Id_55241;
TY55011* Last_55242;
NI LOC3;
NI LOC9;
NI I_55311;
NI HEX3Atmp_55326;
NI Res_55328;
Result_55239 = 0;
Last_55242 = 0;
Result_55239 = NIM_NIL;
Idx_55240 = 0;
Id_55241 = 0;
Last_55242 = NIM_NIL;
Idx_55240 = (NI32)(H_55027 & 8191);
Result_55239 = Buckets_55041[(Idx_55240)-0];
Last_55242 = NIM_NIL;
Id_55241 = 0;
while (1) {
if (!!((Result_55239 == NIM_NIL))) goto LA1;
LOC3 = Cmpexact_55164((*Result_55239).S->data, Identifier_55025, Length_55026);
if (!(LOC3 == 0)) goto LA4;
if (!!((Last_55242 == NIM_NIL))) goto LA7;
asgnRefNoCycle((void**) &(*Last_55242).Next, (*Result_55239).Next);
asgnRefNoCycle((void**) &(*Result_55239).Next, Buckets_55041[(Idx_55240)-0]);
asgnRefNoCycle((void**) &Buckets_55041[(Idx_55240)-0], Result_55239);
LA7: ;
goto BeforeRet;
goto LA2;
LA4: ;
LOC9 = Cmpignorestyle_55042((*Result_55239).S->data, Identifier_55025, Length_55026);
if (!(LOC9 == 0)) goto LA10;
Id_55241 = (*Result_55239).Sup.Id;
goto LA2;
LA10: ;
LA2: ;
Last_55242 = Result_55239;
Result_55239 = (*Result_55239).Next;
} LA1: ;
Result_55239 = (TY55011*) newObj(NTI55009, sizeof(TY55011));
(*Result_55239).Sup.Sup.m_type = NTI55011;
(*Result_55239).H = H_55027;
asgnRefNoCycle((void**) &(*Result_55239).S, mnewString(Length_55026));
I_55311 = 0;
HEX3Atmp_55326 = 0;
HEX3Atmp_55326 = (NI32)((NI32)(Length_55026 + 0) - 1);
Res_55328 = 0;
Res_55328 = 0;
while (1) {
if (!(Res_55328 <= HEX3Atmp_55326)) goto LA12;
I_55311 = Res_55328;
(*Result_55239).S->data[I_55311] = Identifier_55025[(NI32)(I_55311 - 0)];
Res_55328 += 1;
} LA12: ;
asgnRefNoCycle((void**) &(*Result_55239).Next, Buckets_55041[(Idx_55240)-0]);
asgnRefNoCycle((void**) &Buckets_55041[(Idx_55240)-0], Result_55239);
if (!(Id_55241 == 0)) goto LA14;
Wordcounter_55233 += 1;
(*Result_55239).Sup.Id = ((NI32)-(Wordcounter_55233));
goto LA13;
LA14: ;
(*Result_55239).Sup.Id = Id_55241;
LA13: ;
BeforeRet: ;
return Result_55239;
}
N_NIMCALL(TY55011*, Getident_55019)(NimStringDesc* Identifier_55021, NI H_55022) {
TY55011* Result_55230;
Result_55230 = 0;
Result_55230 = NIM_NIL;
Result_55230 = Getident_55023(Identifier_55021->data, Identifier_55021->Sup.len, H_55022);
return Result_55230;
}
N_NIMCALL(TY55011*, Getident_55016)(NimStringDesc* Identifier_55018) {
TY55011* Result_55223;
NI LOC1;
Result_55223 = 0;
Result_55223 = NIM_NIL;
LOC1 = Getnormalizedhash_45037(Identifier_55018);
Result_55223 = Getident_55023(Identifier_55018->data, Identifier_55018->Sup.len, LOC1);
return Result_55223;
}
N_NIMCALL(NIM_BOOL, Identeq_55028)(TY55011* Id_55030, NimStringDesc* Name_55031) {
NIM_BOOL Result_55036;
TY55011* LOC1;
Result_55036 = 0;
LOC1 = 0;
LOC1 = Getident_55016(Name_55031);
Result_55036 = ((*Id_55030).Sup.Id == (*LOC1).Sup.Id);
return Result_55036;
}
N_NOINLINE(void, identsInit)(void) {
Wordcounter_55233 = 1;
}

