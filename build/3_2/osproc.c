/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

#include <sys/sysctl.h>
#include <unistd.h>
#include <string.h>
#include <errno.h>
#include <sys/wait.h>
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY69699 TY69699;
typedef struct TY69202 TY69202;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY39221 TY39221;
typedef struct TY10802 TY10802;
typedef struct TY10818 TY10818;
typedef struct TY11196 TY11196;
typedef struct TY10814 TY10814;
typedef struct TY10810 TY10810;
typedef struct TY11194 TY11194;
typedef struct TY67408 TY67408;
typedef struct TNimObject TNimObject;
typedef struct TY46006 TY46006;
typedef struct TY46004 TY46004;
typedef int TY69404[4];
struct TGenericSeq {
NI len;
NI space;
};
typedef NIM_CHAR TY245[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY245 data;
};
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct TY10802 {
NI Refcount;
TNimType* Typ;
};
struct TY10818 {
NI Len;
NI Cap;
TY10802** D;
};
struct TY10814 {
NI Counter;
NI Max;
TY10810* Head;
TY10810** Data;
};
struct TY11194 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY11196 {
TY10818 Zct;
TY10818 Decstack;
TY10814 Cycleroots;
TY10818 Tempstack;
TY11194 Stat;
};
typedef int TY70331[2];
struct TNimObject {
TNimType* m_type;
};
struct TY69202 {
  TNimObject Sup;
int Inputhandle;
int Outputhandle;
int Errorhandle;
int Id;
int Exitcode;
};
typedef NimStringDesc* TY48843[1];
struct TY46004 {
NimStringDesc* Key;
NimStringDesc* Val;
};
struct TY67408 {
  TNimObject Sup;
NI Counter;
TY46006* Data;
NU8 Mode;
};
typedef NimStringDesc* TY118997[2];
typedef NI TY8814[8];
struct TY10810 {
TY10810* Next;
NI Key;
TY8814 Bits;
};
struct TY69699 {
  TGenericSeq Sup;
  TY69202* data[SEQ_DECL_SIZE];
};
struct TY39221 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
struct TY46006 {
  TGenericSeq Sup;
  TY46004 data[SEQ_DECL_SIZE];
};
N_NIMCALL(void*, newSeq)(TNimType* Typ_14404, NI Len_14405);
N_NIMCALL(TY69202*, Startprocessaux_69603)(NimStringDesc* Cmd_69605, NU8 Options_69607);
N_NIMCALL(TY39221*, nosparseCmdLine)(NimStringDesc* C_40832);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* Seq_18842, NI Elemsize_18843);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13218, void* Src_13219);
static N_INLINE(TY10802*, Usrtocell_11612)(void* Usr_11614);
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225);
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230);
static N_INLINE(void, Rtladdzct_12601)(TY10802* C_12603);
N_NOINLINE(void, Addzct_11601)(TY10818* S_11604, TY10802* C_11605);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* Src_18712);
N_NIMCALL(TY69202*, nospstartProcess)(NimStringDesc* Command_69238, NimStringDesc* Workingdir_69239, NimStringDesc** Args_69244, NI Args_69244Len0, TY67408* Env_69245, NU8 Options_69248);
N_NIMCALL(void*, newObj)(TNimType* Typ_13910, NI Size_13911);
N_NOINLINE(void, nosOSError)(NimStringDesc* Msg_36604);
static N_INLINE(void, Setcurrentdir_38201)(NimStringDesc* Newdir_38203);
N_NIMCALL(NCSTRING*, Tocstringarray_70218)(NimStringDesc** B_70221, NI B_70221Len0, NimStringDesc** A_70222, NI A_70222Len0);
N_NOCONV(void*, Alloc0_2353)(NI Size_2355);
N_NOCONV(void*, Alloc_2350)(NI Size_2352);
N_NIMCALL(NimStringDesc*, nosextractFilename)(NimStringDesc* Path_38730);
N_NIMCALL(NCSTRING*, Tocstringarray_70290)(TY67408* T_70292);
N_NIMCALL(NI, nstlen)(TY67408* T_67421);
static N_INLINE(void, appendString)(NimStringDesc* Dest_18799, NimStringDesc* Src_18800);
N_NIMCALL(NimStringDesc*, rawNewString)(NI Space_18689);
N_NIMCALL(NimStringDesc*, Addcmdargs_70203)(NimStringDesc* Command_70205, NimStringDesc** Args_70207, NI Args_70207Len0);
N_NIMCALL(NimStringDesc*, Quoteifcontainswhite_26268)(NimStringDesc* S_26270);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* Dest_18789, NI Addlen_18790);
N_NIMCALL(void, Quit_21352)(NimStringDesc* Errormsg_21354);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING Str_18708);
N_NIMCALL(NimStringDesc*, nsuJoinSep)(NimStringDesc** A_26004, NI A_26004Len0, NimStringDesc* Sep_26005);
static N_INLINE(void, rawEcho)(NimStringDesc* X_4502);
N_NIMCALL(void, Write_3866)(FILE* F_3868, NimStringDesc* S_3869);
static N_INLINE(void, rawEchoNL)(void);
N_NIMCALL(void, nossleep)(NI Milsecs_42612);
N_NIMCALL(NIM_BOOL, nosprunning)(TY69202* P_69260);
N_NIMCALL(NI, nospwaitForExit)(TY69202* P_69267);
STRING_LITERAL(TMP198907, "failed to create a pipe", 23);
STRING_LITERAL(TMP198908, "failed to fork process", 22);
STRING_LITERAL(TMP198909, "", 0);
STRING_LITERAL(TMP198910, "=", 1);
STRING_LITERAL(TMP198911, " ", 1);
STRING_LITERAL(TMP198913, "sh", 2);
STRING_LITERAL(TMP198914, "-c", 2);
NIM_CONST TY118997 TMP198912 = {((NimStringDesc*) &TMP198913),
((NimStringDesc*) &TMP198914)}
;
STRING_LITERAL(TMP198915, "execve call failed: ", 20);
STRING_LITERAL(TMP198916, "\012", 1);
extern TNimType* NTI69699; /* seq[PProcess] */
extern TNimType* NTI39221; /* seq[string] */
extern TY11196 Gch_11214;
extern TNimType* NTI69204; /* PProcess */
extern TNimType* NTI69202; /* TProcess */
N_NIMCALL(NI, nospcountProcessors)(void) {
NI Result_69403;
TY69404 Mib_69406;
NI Len_69407;
NI Numcpu_69408;
int LOC1;
int LOC5;
Result_69403 = 0;
memset((void*)&Mib_69406, 0, sizeof(Mib_69406));
Len_69407 = 0;
Numcpu_69408 = 0;
Mib_69406[(0)-0] = ((NI32) 6);
Mib_69406[(1)-0] = ((NI32) 25);
Len_69407 = 8;
LOC1 = sysctl(Mib_69406, ((NI32) 2), ((void*) (&Numcpu_69408)), &Len_69407, NIM_NIL, 0);
if (!(Numcpu_69408 < 1)) goto LA3;
Mib_69406[(1)-0] = ((NI32) 3);
LOC5 = sysctl(Mib_69406, ((NI32) 2), ((void*) (&Numcpu_69408)), &Len_69407, NIM_NIL, 0);
LA3: ;
Result_69403 = Numcpu_69408;
if (!(Result_69403 <= 0)) goto LA7;
Result_69403 = 1;
LA7: ;
return Result_69403;
}
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* Command_69231) {
NI Result_70519;
int LOC1;
Result_70519 = 0;
LOC1 = system(Command_69231->data);
Result_70519 = ((NI) (LOC1));
return Result_70519;
}
static N_INLINE(TY10802*, Usrtocell_11612)(void* Usr_11614) {
TY10802* Result_11615;
Result_11615 = 0;
Result_11615 = ((TY10802*) ((NI64)((NU64)(((NI) (Usr_11614))) - (NU64)(((NI) (((NI)sizeof(TY10802))))))));
return Result_11615;
}
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225) {
NI Result_7807;
Result_7807 = 0;
(*Memloc_3224) += X_3225;
Result_7807 = (*Memloc_3224);
return Result_7807;
}
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230) {
NI Result_8006;
Result_8006 = 0;
(*Memloc_3229) -= X_3230;
Result_8006 = (*Memloc_3229);
return Result_8006;
}
static N_INLINE(void, Rtladdzct_12601)(TY10802* C_12603) {
Addzct_11601(&Gch_11214.Zct, C_12603);
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13218, void* Src_13219) {
TY10802* C_13220;
NI LOC4;
TY10802* C_13222;
NI LOC9;
if (!!((Src_13219 == NIM_NIL))) goto LA2;
C_13220 = 0;
C_13220 = Usrtocell_11612(Src_13219);
LOC4 = Atomicinc_3221(&(*C_13220).Refcount, 8);
LA2: ;
if (!!(((*Dest_13218) == NIM_NIL))) goto LA6;
C_13222 = 0;
C_13222 = Usrtocell_11612((*Dest_13218));
LOC9 = Atomicdec_3226(&(*C_13222).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
Rtladdzct_12601(C_13222);
LA10: ;
LA6: ;
(*Dest_13218) = Src_13219;
}
static N_INLINE(void, Setcurrentdir_38201)(NimStringDesc* Newdir_38203) {
int LOC2;
LOC2 = chdir(Newdir_38203->data);
if (!!((LOC2 == ((NI32) 0)))) goto LA3;
nosOSError(((NimStringDesc*) &TMP198909));
LA3: ;
}
N_NIMCALL(NCSTRING*, Tocstringarray_70218)(NimStringDesc** B_70221, NI B_70221Len0, NimStringDesc** A_70222, NI A_70222Len0) {
NCSTRING* Result_70223;
void* LOC1;
NI I_70252;
NI HEX3Atmp_70604;
NI Res_70606;
void* LOC3;
NI I_70265;
NI HEX3Atmp_70607;
NI Res_70609;
void* LOC5;
Result_70223 = 0;
LOC1 = Alloc0_2353((NI64)((NI64)((NI64)(A_70222Len0 + B_70221Len0) + 1) * 8));
Result_70223 = ((NCSTRING*) (LOC1));
I_70252 = 0;
HEX3Atmp_70604 = 0;
HEX3Atmp_70604 = (B_70221Len0-1);
Res_70606 = 0;
Res_70606 = 0;
while (1) {
if (!(Res_70606 <= HEX3Atmp_70604)) goto LA2;
I_70252 = Res_70606;
LOC3 = Alloc_2350((NI64)(B_70221[I_70252]->Sup.len + 1));
Result_70223[(I_70252)-0] = ((NCSTRING) (LOC3));
memcpy(((void*) (Result_70223[(I_70252)-0])), ((void*) (B_70221[I_70252]->data)), (NI64)(B_70221[I_70252]->Sup.len + 1));
Res_70606 += 1;
} LA2: ;
I_70265 = 0;
HEX3Atmp_70607 = 0;
HEX3Atmp_70607 = (A_70222Len0-1);
Res_70609 = 0;
Res_70609 = 0;
while (1) {
if (!(Res_70609 <= HEX3Atmp_70607)) goto LA4;
I_70265 = Res_70609;
LOC5 = Alloc_2350((NI64)(A_70222[I_70265]->Sup.len + 1));
Result_70223[((NI64)(I_70265 + B_70221Len0))-0] = ((NCSTRING) (LOC5));
memcpy(((void*) (Result_70223[((NI64)(I_70265 + B_70221Len0))-0])), ((void*) (A_70222[I_70265]->data)), (NI64)(A_70222[I_70265]->Sup.len + 1));
Res_70609 += 1;
} LA4: ;
return Result_70223;
}
static N_INLINE(void, appendString)(NimStringDesc* Dest_18799, NimStringDesc* Src_18800) {
memcpy(((NCSTRING) (&(*Dest_18799).data[((*Dest_18799).Sup.len)-0])), ((NCSTRING) ((*Src_18800).data)), ((int) ((NI64)((NI64)((*Src_18800).Sup.len + 1) * 1))));
(*Dest_18799).Sup.len += (*Src_18800).Sup.len;
}
N_NIMCALL(NCSTRING*, Tocstringarray_70290)(TY67408* T_70292) {
NCSTRING* Result_70293;
NI LOC1;
void* LOC2;
NI I_70296;
NimStringDesc* Key_70297;
NimStringDesc* Val_70298;
NI H_70611;
NI HEX3Atmp_70613;
NI Res_70615;
NimStringDesc* X_70299;
NimStringDesc* LOC7;
void* LOC8;
Key_70297 = 0;
Val_70298 = 0;
X_70299 = 0;
Result_70293 = 0;
LOC1 = nstlen(T_70292);
LOC2 = Alloc0_2353((NI64)((NI64)(LOC1 + 1) * 8));
Result_70293 = ((NCSTRING*) (LOC2));
I_70296 = 0;
I_70296 = 0;
Key_70297 = NIM_NIL;
Val_70298 = NIM_NIL;
H_70611 = 0;
HEX3Atmp_70613 = 0;
HEX3Atmp_70613 = ((*T_70292).Data->Sup.len-1);
Res_70615 = 0;
Res_70615 = 0;
while (1) {
if (!(Res_70615 <= HEX3Atmp_70613)) goto LA3;
H_70611 = Res_70615;
if (!!((*T_70292).Data->data[H_70611].Key == 0)) goto LA5;
Key_70297 = (*T_70292).Data->data[H_70611].Key;
Val_70298 = (*T_70292).Data->data[H_70611].Val;
X_70299 = NIM_NIL;
LOC7 = 0;
LOC7 = rawNewString(Key_70297->Sup.len + Val_70298->Sup.len + 1);
appendString(LOC7, Key_70297);
appendString(LOC7, ((NimStringDesc*) &TMP198910));
appendString(LOC7, Val_70298);
X_70299 = LOC7;
LOC8 = Alloc_2350((NI64)(X_70299->Sup.len + 1));
Result_70293[(I_70296)-0] = ((NCSTRING) (LOC8));
memcpy(((void*) (Result_70293[(I_70296)-0])), ((void*) (&X_70299->data[0])), (NI64)(X_70299->Sup.len + 1));
I_70296 += 1;
LA5: ;
Res_70615 += 1;
} LA3: ;
return Result_70293;
}
N_NIMCALL(NimStringDesc*, Addcmdargs_70203)(NimStringDesc* Command_70205, NimStringDesc** Args_70207, NI Args_70207Len0) {
NimStringDesc* Result_70208;
NI I_70217;
NI HEX3Atmp_70601;
NI Res_70603;
NimStringDesc* LOC2;
Result_70208 = 0;
Result_70208 = NIM_NIL;
Result_70208 = Quoteifcontainswhite_26268(Command_70205);
I_70217 = 0;
HEX3Atmp_70601 = 0;
HEX3Atmp_70601 = (Args_70207Len0-1);
Res_70603 = 0;
Res_70603 = 0;
while (1) {
if (!(Res_70603 <= HEX3Atmp_70601)) goto LA1;
I_70217 = Res_70603;
Result_70208 = resizeString(Result_70208, 1);
appendString(Result_70208, ((NimStringDesc*) &TMP198911));
LOC2 = 0;
LOC2 = Quoteifcontainswhite_26268(Args_70207[I_70217]);
Result_70208 = resizeString(Result_70208, LOC2->Sup.len + 0);
appendString(Result_70208, LOC2);
Res_70603 += 1;
} LA1: ;
return Result_70208;
}
static N_INLINE(void, rawEcho)(NimStringDesc* X_4502) {
Write_3866(stdout, X_4502);
}
static N_INLINE(void, rawEchoNL)(void) {
Write_3866(stdout, ((NimStringDesc*) &TMP198916));
}
N_NIMCALL(TY69202*, nospstartProcess)(NimStringDesc* Command_69238, NimStringDesc* Workingdir_69239, NimStringDesc** Args_69244, NI Args_69244Len0, TY67408* Env_69245, NU8 Options_69248) {
TY69202* Result_70330;
TY70331 Pstdin_70333;
TY70331 Pstdout_70334;
TY70331 Pstderr_70335;
NIM_BOOL LOC2;
int LOC3;
int LOC5;
NI Pid_70355;
int LOC14;
int LOC16;
int LOC19;
int LOC21;
int LOC28;
int LOC32;
int LOC35;
int LOC37;
NCSTRING* A_70412;
TY48843 LOC46;
int LOC50;
NCSTRING* LOC51;
int LOC52;
NimStringDesc* X_70424;
NCSTRING* A_70433;
TY48843 LOC53;
int LOC57;
NCSTRING* LOC58;
int LOC59;
NimStringDesc* LOC60;
NCSTRING LOC61;
NimStringDesc* LOC62;
NimStringDesc* LOC66;
NimStringDesc* LOC67;
int LOC71;
int LOC72;
int LOC73;
Result_70330 = 0;
X_70424 = 0;
Result_70330 = NIM_NIL;
memset((void*)&Pstdin_70333, 0, sizeof(Pstdin_70333));
memset((void*)&Pstdout_70334, 0, sizeof(Pstdout_70334));
memset((void*)&Pstderr_70335, 0, sizeof(Pstderr_70335));
Result_70330 = (TY69202*) newObj(NTI69204, sizeof(TY69202));
(*Result_70330).Sup.m_type = NTI69202;
(*Result_70330).Exitcode = ((NI32) 3);
LOC3 = pipe(Pstdin_70333);
LOC2 = !((LOC3 == ((NI32) 0)));
if (LOC2) goto LA4;
LOC5 = pipe(Pstdout_70334);
LOC2 = !((LOC5 == ((NI32) 0)));
LA4: ;
if (!LOC2) goto LA6;
nosOSError(((NimStringDesc*) &TMP198907));
LA6: ;
Pid_70355 = 0;
Pid_70355 = fork();
if (!(Pid_70355 < 0)) goto LA9;
nosOSError(((NimStringDesc*) &TMP198908));
LA9: ;
if (!(Pid_70355 == 0)) goto LA12;
LOC14 = close(Pstdin_70333[(1)-0]);
LOC16 = dup2(Pstdin_70333[(0)-0], ((NI32) 0));
if (!(((NI) (LOC16)) < 0)) goto LA17;
nosOSError(((NimStringDesc*) &TMP198909));
LA17: ;
LOC19 = close(Pstdout_70334[(0)-0]);
LOC21 = dup2(Pstdout_70334[(1)-0], ((NI32) 1));
if (!(((NI) (LOC21)) < 0)) goto LA22;
nosOSError(((NimStringDesc*) &TMP198909));
LA22: ;
if (!((Options_69248 &(1<<((((NU8) 2))&7)))!=0)) goto LA25;
LOC28 = dup2(Pstdout_70334[(1)-0], ((NI32) 2));
if (!(((NI) (LOC28)) < 0)) goto LA29;
nosOSError(((NimStringDesc*) &TMP198909));
LA29: ;
goto LA24;
LA25: ;
LOC32 = pipe(Pstderr_70335);
if (!!((LOC32 == ((NI32) 0)))) goto LA33;
nosOSError(((NimStringDesc*) &TMP198907));
LA33: ;
LOC35 = close(Pstderr_70335[(0)-0]);
LOC37 = dup2(Pstderr_70335[(1)-0], ((NI32) 2));
if (!(((NI) (LOC37)) < 0)) goto LA38;
nosOSError(((NimStringDesc*) &TMP198909));
LA38: ;
LA24: ;
if (!(0 < Workingdir_69239->Sup.len)) goto LA41;
Setcurrentdir_38201(Workingdir_69239);
LA41: ;
if (!!(((Options_69248 &(1<<((((NU8) 1))&7)))!=0))) goto LA44;
A_70412 = 0;
memset((void*)&LOC46, 0, sizeof(LOC46));
LOC46[0] = nosextractFilename(Command_69238);
A_70412 = Tocstringarray_70218(LOC46, 1, Args_69244, Args_69244Len0);
if (!(Env_69245 == NIM_NIL)) goto LA48;
LOC50 = execv(Command_69238->data, A_70412);
goto LA47;
LA48: ;
LOC51 = Tocstringarray_70290(Env_69245);
LOC52 = execve(Command_69238->data, A_70412, LOC51);
LA47: ;
goto LA43;
LA44: ;
X_70424 = NIM_NIL;
X_70424 = Addcmdargs_70203(Command_69238, Args_69244, Args_69244Len0);
A_70433 = 0;
memset((void*)&LOC53, 0, sizeof(LOC53));
LOC53[0] = copyString(X_70424);
A_70433 = Tocstringarray_70218(TMP198912, 2, LOC53, 1);
if (!(Env_69245 == NIM_NIL)) goto LA55;
LOC57 = execv("/bin/sh", A_70433);
goto LA54;
LA55: ;
LOC58 = Tocstringarray_70290(Env_69245);
LOC59 = execve("/bin/sh", A_70433, LOC58);
LA54: ;
LA43: ;
LOC60 = 0;
LOC61 = strerror(errno);
LOC62 = 0;
LOC62 = cstrToNimstr(LOC61);
LOC60 = rawNewString(LOC62->Sup.len + 20);
appendString(LOC60, ((NimStringDesc*) &TMP198915));
appendString(LOC60, LOC62);
Quit_21352(LOC60);
LA12: ;
if (!((Options_69248 &(1<<((((NU8) 0))&7)))!=0)) goto LA64;
LOC66 = 0;
LOC67 = 0;
LOC67 = nsuJoinSep(Args_69244, Args_69244Len0, ((NimStringDesc*) &TMP198911));
LOC66 = rawNewString(Command_69238->Sup.len + LOC67->Sup.len + 1);
appendString(LOC66, Command_69238);
appendString(LOC66, ((NimStringDesc*) &TMP198911));
appendString(LOC66, LOC67);
rawEcho(LOC66);
rawEchoNL();
LA64: ;
(*Result_70330).Id = ((int) (Pid_70355));
(*Result_70330).Inputhandle = Pstdin_70333[(1)-0];
(*Result_70330).Outputhandle = Pstdout_70334[(0)-0];
if (!((Options_69248 &(1<<((((NU8) 2))&7)))!=0)) goto LA69;
(*Result_70330).Errorhandle = (*Result_70330).Outputhandle;
goto LA68;
LA69: ;
(*Result_70330).Errorhandle = Pstderr_70335[(0)-0];
LOC71 = close(Pstderr_70335[(1)-0]);
LA68: ;
LOC72 = close(Pstdin_70333[(0)-0]);
LOC73 = close(Pstdout_70334[(1)-0]);
return Result_70330;
}
N_NIMCALL(TY69202*, Startprocessaux_69603)(NimStringDesc* Cmd_69605, NU8 Options_69607) {
TY69202* Result_69608;
TY39221* C_69609;
TY39221* A_69627;
NI I_69661;
NI HEX3Atmp_69680;
NI Res_69682;
Result_69608 = 0;
C_69609 = 0;
A_69627 = 0;
Result_69608 = NIM_NIL;
C_69609 = NIM_NIL;
C_69609 = nosparseCmdLine(Cmd_69605);
A_69627 = NIM_NIL;
A_69627 = (TY39221*) newSeq(NTI39221, 0);
I_69661 = 0;
HEX3Atmp_69680 = 0;
HEX3Atmp_69680 = (NI64)(C_69609->Sup.len - 1);
Res_69682 = 0;
Res_69682 = 1;
while (1) {
if (!(Res_69682 <= HEX3Atmp_69680)) goto LA1;
I_69661 = Res_69682;
A_69627 = (TY39221*) incrSeq(&(A_69627)->Sup, sizeof(NimStringDesc*));
asgnRefNoCycle((void**) &A_69627->data[A_69627->Sup.len-1], copyString(C_69609->data[I_69661]));
Res_69682 += 1;
} LA1: ;
Result_69608 = nospstartProcess(C_69609->data[0], ((NimStringDesc*) &TMP198909), A_69627->data, A_69627->Sup.len, NIM_NIL, Options_69607);
return Result_69608;
}
N_NIMCALL(NIM_BOOL, nosprunning)(TY69202* P_69260) {
NIM_BOOL Result_70476;
NI LOC1;
Result_70476 = 0;
LOC1 = waitpid(((NI) ((*P_69260).Id)), &(*P_69260).Exitcode, WNOHANG);
Result_70476 = (LOC1 == ((NI) ((*P_69260).Id)));
return Result_70476;
}
N_NIMCALL(NI, nospwaitForExit)(TY69202* P_69267) {
NI Result_70488;
int Oldexitcode_70489;
NI LOC2;
Result_70488 = 0;
Oldexitcode_70489 = 0;
Oldexitcode_70489 = (*P_69267).Exitcode;
LOC2 = waitpid(((NI) ((*P_69267).Id)), &(*P_69267).Exitcode, ((NI32) 0));
if (!(LOC2 < 0)) goto LA3;
(*P_69267).Exitcode = Oldexitcode_70489;
LA3: ;
Result_70488 = ((NI) ((*P_69267).Exitcode));
return Result_70488;
}
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** Cmds_69686, NI Cmds_69686Len0, NU8 Options_69688, NI N_69689) {
NI Result_69690;
TY69699* Q_69700;
NI M_69725;
NI I_69734;
NI HEX3Atmp_69824;
NI Res_69826;
NI I_69735;
NI R_69746;
NI HEX3Atmp_69827;
NI Res_69829;
NIM_BOOL LOC8;
NI LOC11;
NI I_69809;
NI HEX3Atmp_69830;
NI Res_69832;
NI LOC16;
NI I_69820;
NI HEX3Atmp_69833;
NI Res_69835;
TY69202* P_69821;
NI LOC18;
Q_69700 = 0;
P_69821 = 0;
Result_69690 = 0;
if (!(1 < N_69689)) goto LA2;
Q_69700 = NIM_NIL;
Q_69700 = (TY69699*) newSeq(NTI69699, N_69689);
M_69725 = 0;
M_69725 = ((N_69689 <= Cmds_69686Len0) ? N_69689 : Cmds_69686Len0);
I_69734 = 0;
HEX3Atmp_69824 = 0;
HEX3Atmp_69824 = (NI64)(M_69725 - 1);
Res_69826 = 0;
Res_69826 = 0;
while (1) {
if (!(Res_69826 <= HEX3Atmp_69824)) goto LA4;
I_69734 = Res_69826;
asgnRefNoCycle((void**) &Q_69700->data[I_69734], Startprocessaux_69603(Cmds_69686[I_69734], Options_69688));
Res_69826 += 1;
} LA4: ;
I_69735 = 0;
I_69735 = M_69725;
while (1) {
if (!(I_69735 <= (Cmds_69686Len0-1))) goto LA5;
nossleep(50);
R_69746 = 0;
HEX3Atmp_69827 = 0;
HEX3Atmp_69827 = (NI64)(N_69689 - 1);
Res_69829 = 0;
Res_69829 = 0;
while (1) {
if (!(Res_69829 <= HEX3Atmp_69827)) goto LA6;
R_69746 = Res_69829;
LOC8 = nosprunning(Q_69700->data[R_69746]);
if (!!(LOC8)) goto LA9;
LOC11 = nospwaitForExit(Q_69700->data[R_69746]);
Result_69690 = ((LOC11 >= Result_69690) ? LOC11 : Result_69690);
asgnRefNoCycle((void**) &Q_69700->data[R_69746], Startprocessaux_69603(Cmds_69686[I_69735], Options_69688));
I_69735 += 1;
if (!((Cmds_69686Len0-1) < I_69735)) goto LA13;
goto LA6;
LA13: ;
LA9: ;
Res_69829 += 1;
} LA6: ;
} LA5: ;
I_69809 = 0;
HEX3Atmp_69830 = 0;
HEX3Atmp_69830 = (NI64)(M_69725 - 1);
Res_69832 = 0;
Res_69832 = 0;
while (1) {
if (!(Res_69832 <= HEX3Atmp_69830)) goto LA15;
I_69809 = Res_69832;
LOC16 = nospwaitForExit(Q_69700->data[I_69809]);
Result_69690 = ((LOC16 >= Result_69690) ? LOC16 : Result_69690);
Res_69832 += 1;
} LA15: ;
goto LA1;
LA2: ;
I_69820 = 0;
HEX3Atmp_69833 = 0;
HEX3Atmp_69833 = (Cmds_69686Len0-1);
Res_69835 = 0;
Res_69835 = 0;
while (1) {
if (!(Res_69835 <= HEX3Atmp_69833)) goto LA17;
I_69820 = Res_69835;
P_69821 = NIM_NIL;
P_69821 = Startprocessaux_69603(Cmds_69686[I_69820], Options_69688);
LOC18 = nospwaitForExit(P_69821);
Result_69690 = ((LOC18 >= Result_69690) ? LOC18 : Result_69690);
Res_69835 += 1;
} LA17: ;
LA1: ;
return Result_69690;
}
N_NOINLINE(void, osprocInit)(void) {
}

