/* Generated by Nimrod Compiler v0.8.11 */
/*   (c) 2011 Andreas Rumpf */

typedef long long int NI;
typedef unsigned long long int NU;
#include "nimbase.h"

typedef struct TY56552 TY56552;
typedef struct TNimObject TNimObject;
typedef struct TY55005 TY55005;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY56550 TY56550;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY56526 TY56526;
typedef struct TY56548 TY56548;
typedef struct TY56540 TY56540;
typedef struct TY53008 TY53008;
typedef struct TY108012 TY108012;
typedef struct TY56564 TY56564;
typedef struct TY56562 TY56562;
typedef struct TY56560 TY56560;
typedef struct TY126145 TY126145;
typedef struct TY48538 TY48538;
typedef struct NimStringDesc NimStringDesc;
typedef struct TY55011 TY55011;
typedef struct TY56520 TY56520;
typedef struct TY56530 TY56530;
typedef struct TY56528 TY56528;
typedef struct TY56544 TY56544;
typedef struct TY10802 TY10802;
typedef struct TY10814 TY10814;
typedef struct TY11196 TY11196;
typedef struct TY10818 TY10818;
typedef struct TY10810 TY10810;
typedef struct TY11194 TY11194;
typedef struct TY106002 TY106002;
typedef struct TY108006 TY108006;
typedef struct TY61099 TY61099;
typedef struct TY61101 TY61101;
typedef struct TY56895 TY56895;
typedef struct TY56891 TY56891;
typedef struct TY56893 TY56893;
typedef struct TY44019 TY44019;
typedef struct TY44013 TY44013;
typedef N_NIMCALL_PTR(NIM_BOOL, TY98025) (TY56552* T_98030, TNimObject* Closure_98031);
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
};
struct TNimObject {
TNimType* m_type;
};
struct TY55005 {
  TNimObject Sup;
NI Id;
};
struct TGenericSeq {
NI len;
NI space;
};
struct TY56540 {
NU8 K;
NU8 S;
NU8 Flags;
TY56552* T;
TY53008* R;
NI A;
};
struct TY56552 {
  TY55005 Sup;
NU8 Kind;
TY56550* Sons;
TY56526* N;
NU8 Flags;
NU8 Callconv;
TY56548* Owner;
TY56548* Sym;
NI64 Size;
NI Align;
NI Containerid;
TY56540 Loc;
};
struct TY56560 {
TY55005* Key;
TNimObject* Val;
};
struct TY56564 {
NI Counter;
TY56562* Data;
};
struct TY48538 {
NI16 Line;
NI16 Col;
int Fileindex;
};
struct TY126145 {
TY108012* C;
TY56564 Typemap;
TY56564 Symmap;
TY48538 Info;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
typedef NIM_CHAR TY245[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY245 data;
};
struct TY56526 {
TY56552* Typ;
NimStringDesc* Comment;
TY48538 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {TY56548* Sym;
} S4;
struct {TY55011* Ident;
} S5;
struct {TY56520* Sons;
} S6;
} KindU;
};
struct TY56530 {
TNimType* m_type;
NI Counter;
TY56528* Data;
};
struct TY56548 {
  TY55005 Sup;
NU8 Kind;
NU8 Magic;
TY56552* Typ;
TY55011* Name;
TY48538 Info;
TY56548* Owner;
NU32 Flags;
TY56530 Tab;
TY56526* Ast;
NU32 Options;
NI Position;
NI Offset;
TY56540 Loc;
TY56544* Annex;
};
struct TY10802 {
NI Refcount;
TNimType* Typ;
};
struct TY10818 {
NI Len;
NI Cap;
TY10802** D;
};
struct TY10814 {
NI Counter;
NI Max;
TY10810* Head;
TY10810** Data;
};
struct TY11194 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
};
struct TY11196 {
TY10818 Zct;
TY10818 Decstack;
TY10814 Cycleroots;
TY10818 Tempstack;
TY11194 Stat;
};
struct TY53008 {
  TNimObject Sup;
TY53008* Left;
TY53008* Right;
NI Length;
NimStringDesc* Data;
};
struct TY106002 {
  TNimObject Sup;
};
struct TY61099 {
NI Tos;
TY61101* Stack;
};
struct TY56895 {
NI Counter;
NI Max;
TY56891* Head;
TY56893* Data;
};
struct TY44019 {
TNimType* m_type;
TY44013* Head;
TY44013* Tail;
NI Counter;
};
typedef N_NIMCALL_PTR(TY56526*, TY108032) (TY108012* C_108033, TY56526* N_108034);
typedef N_NIMCALL_PTR(TY56526*, TY108037) (TY108012* C_108038, TY56526* N_108039);
struct TY108012 {
  TY106002 Sup;
TY56548* Module;
TY108006* P;
NI Instcounter;
TY56526* Generics;
NI Lastgenericidx;
TY61099 Tab;
TY56895 Ambiguoussymbols;
TY56528* Converters;
TY44019 Optionstack;
TY44019 Libs;
NIM_BOOL Fromcache;
TY108032 Semconstexpr;
TY108037 Semexpr;
TY56895 Includedfiles;
NimStringDesc* Filename;
TY56530 Userpragmas;
};
struct TY55011 {
  TY55005 Sup;
NimStringDesc* S;
TY55011* Next;
NI H;
};
struct TY44013 {
  TNimObject Sup;
TY44013* Prev;
TY44013* Next;
};
struct TY56544 {
  TY44013 Sup;
NU8 Kind;
NIM_BOOL Generated;
TY53008* Name;
TY56526* Path;
};
typedef NI TY8814[8];
struct TY10810 {
TY10810* Next;
NI Key;
TY8814 Bits;
};
struct TY108006 {
TY56548* Owner;
TY56548* Resultsym;
NI Nestedloopcounter;
NI Nestedblockcounter;
};
struct TY56891 {
TY56891* Next;
NI Key;
TY8814 Bits;
};
struct TY56550 {
  TGenericSeq Sup;
  TY56552* data[SEQ_DECL_SIZE];
};
struct TY56562 {
  TGenericSeq Sup;
  TY56560 data[SEQ_DECL_SIZE];
};
struct TY56520 {
  TGenericSeq Sup;
  TY56526* data[SEQ_DECL_SIZE];
};
struct TY56528 {
  TGenericSeq Sup;
  TY56548* data[SEQ_DECL_SIZE];
};
struct TY61101 {
  TGenericSeq Sup;
  TY56530 data[SEQ_DECL_SIZE];
};
struct TY56893 {
  TGenericSeq Sup;
  TY56891* data[SEQ_DECL_SIZE];
};
N_NIMCALL(NIM_BOOL, Iterovertype_98038)(TY56552* T_98040, TY98025 Iter_98041, TNimObject* Closure_98042);
N_NIMCALL(NIM_BOOL, Containsgenerictypeiter_126050)(TY56552* T_126052, TNimObject* Closure_126053);
N_NIMCALL(void, genericReset)(void* Dest_19728, TNimType* Mt_19729);
N_NIMCALL(void, Initidtable_56755)(TY56564* X_56758);
N_NIMCALL(void, Copyidtable_56799)(TY56564* Dest_56802, TY56564 Src_56803);
N_NIMCALL(void, Pushinfocontext_48615)(TY48538 Info_48617);
N_NIMCALL(TY56552*, Replacetypevarst_126150)(TY126145* Cl_126153, TY56552* T_126154);
N_NIMCALL(TY56552*, Lookuptypevar_126301)(TY126145* Cl_126303, TY56552* T_126304);
N_NIMCALL(TNimObject*, Idtableget_61158)(TY56564 T_61160, TY55005* Key_61161);
N_NIMCALL(void, Globalerror_49188)(TY48538 Info_49190, NU8 Msg_49191, NimStringDesc* Arg_49192);
N_NIMCALL(NimStringDesc*, Typetostring_98014)(TY56552* Typ_98016, NU8 Prefer_98017);
N_NIMCALL(void, Internalerror_49208)(TY48538 Info_49210, NimStringDesc* Errmsg_49211);
static N_INLINE(NI, Sonslen_56807)(TY56552* N_56809);
N_NIMCALL(TY56552*, Copytype_56771)(TY56552* T_56773, TY56548* Owner_56774, NIM_BOOL Keepid_56775);
static N_INLINE(void, asgnRef)(void** Dest_13214, void* Src_13215);
static N_INLINE(void, Incref_13202)(TY10802* C_13204);
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225);
static N_INLINE(NIM_BOOL, Canbecycleroot_11616)(TY10802* C_11618);
static N_INLINE(void, Rtladdcycleroot_12252)(TY10802* C_12254);
N_NOINLINE(void, Incl_11080)(TY10814* S_11083, TY10802* Cell_11084);
static N_INLINE(TY10802*, Usrtocell_11612)(void* Usr_11614);
static N_INLINE(void, Decref_13001)(TY10802* C_13003);
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230);
static N_INLINE(void, Rtladdzct_12601)(TY10802* C_12603);
N_NOINLINE(void, Addzct_11601)(TY10818* S_11604, TY10802* C_11605);
N_NIMCALL(void, Idtableput_61166)(TY56564* T_61169, TY55005* Key_61170, TNimObject* Val_61171);
N_NIMCALL(TY56552*, Searchinsttypes_126070)(TY56564 Tab_126072, TY56552* Key_126073);
N_NIMCALL(NIM_BOOL, Sametype_98048)(TY56552* X_98050, TY56552* Y_98051);
N_NIMCALL(TY56552*, Newtype_56707)(NU8 Kind_56709, TY56548* Owner_56710);
N_NIMCALL(void, Addson_56828)(TY56552* Father_56830, TY56552* Son_56831);
static N_INLINE(TY56552*, Lastson_56813)(TY56552* N_56815);
N_NIMCALL(TY56526*, Replacetypevarsn_126160)(TY126145* Cl_126163, TY56526* N_126164);
N_NIMCALL(TY56526*, Copynode_56849)(TY56526* Src_56851);
N_NIMCALL(TY56548*, Replacetypevarss_126155)(TY126145* Cl_126158, TY56548* S_126159);
N_NIMCALL(TY56548*, Copysym_56776)(TY56548* S_56778, NIM_BOOL Keepid_56779);
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13218, void* Src_13219);
static N_INLINE(NI, Sonslen_56804)(TY56526* N_56806);
N_NIMCALL(void, Newsons_56816)(TY56526* Father_56818, NI Length_56819);
N_NIMCALL(void, Checkconstructedtype_126004)(TY48538 Info_126006, TY56552* T_126007);
N_NIMCALL(TY56552*, Skiptypes_98087)(TY56552* T_98089, NU64 Kinds_98090);
N_NIMCALL(void, Localerror_49193)(TY48538 Info_49195, NU8 Msg_49196, NimStringDesc* Arg_49197);
N_NIMCALL(NI64, Computesize_98112)(TY56552* Typ_98114);
N_NIMCALL(NIM_BOOL, Containsgenerictype_126066)(TY56552* T_126068);
N_NIMCALL(void, Popinfocontext_48636)(void);
STRING_LITERAL(TMP198036, "substitution with generic parameter", 35);
STRING_LITERAL(TMP198037, "no generic body", 15);
STRING_LITERAL(TMP198040, "acyclic", 7);
STRING_LITERAL(TMP198043, "", 0);
STRING_LITERAL(TMP198044, "ReplaceTypeVarsT: tyGenericBody", 31);
extern TNimType* NTI126145; /* TReplTypeVars */
extern TY11196 Gch_11214;
extern TY56564 Ginsttypes_108045;
N_NIMCALL(NIM_BOOL, Containsgenerictypeiter_126050)(TY56552* T_126052, TNimObject* Closure_126053) {
NIM_BOOL Result_126054;
Result_126054 = 0;
Result_126054 = ((5632 &(IL64(1)<<(((*T_126052).Kind)&IL64(63))))!=0);
return Result_126054;
}
N_NIMCALL(NIM_BOOL, Containsgenerictype_126066)(TY56552* T_126068) {
NIM_BOOL Result_126069;
Result_126069 = 0;
Result_126069 = Iterovertype_98038(T_126068, Containsgenerictypeiter_126050, NIM_NIL);
return Result_126069;
}
N_NIMCALL(TY56552*, Lookuptypevar_126301)(TY126145* Cl_126303, TY56552* T_126304) {
TY56552* Result_126305;
TNimObject* LOC1;
NimStringDesc* LOC5;
Result_126305 = 0;
Result_126305 = NIM_NIL;
LOC1 = 0;
LOC1 = Idtableget_61158((*Cl_126303).Typemap, &T_126304->Sup);
Result_126305 = ((TY56552*) (LOC1));
if (!(Result_126305 == NIM_NIL)) goto LA3;
LOC5 = 0;
LOC5 = Typetostring_98014(T_126304, ((NU8) 0));
Globalerror_49188((*(*T_126304).Sym).Info, ((NU8) 121), LOC5);
goto LA2;
LA3: ;
if (!((*Result_126305).Kind == ((NU8) 12))) goto LA6;
Internalerror_49208((*Cl_126303).Info, ((NimStringDesc*) &TMP198036));
goto LA2;
LA6: ;
LA2: ;
return Result_126305;
}
static N_INLINE(NI, Sonslen_56807)(TY56552* N_56809) {
NI Result_57761;
Result_57761 = 0;
if (!(*N_56809).Sons == 0) goto LA2;
Result_57761 = 0;
goto LA1;
LA2: ;
Result_57761 = (*N_56809).Sons->Sup.len;
LA1: ;
return Result_57761;
}
static N_INLINE(NI, Atomicinc_3221)(NI* Memloc_3224, NI X_3225) {
NI Result_7807;
Result_7807 = 0;
(*Memloc_3224) += X_3225;
Result_7807 = (*Memloc_3224);
return Result_7807;
}
static N_INLINE(NIM_BOOL, Canbecycleroot_11616)(TY10802* C_11618) {
NIM_BOOL Result_11619;
Result_11619 = 0;
Result_11619 = !((((*(*C_11618).Typ).flags &(1<<((((NU8) 1))&7)))!=0));
return Result_11619;
}
static N_INLINE(void, Rtladdcycleroot_12252)(TY10802* C_12254) {
Incl_11080(&Gch_11214.Cycleroots, C_12254);
}
static N_INLINE(void, Incref_13202)(TY10802* C_13204) {
NI LOC1;
NIM_BOOL LOC3;
LOC1 = Atomicinc_3221(&(*C_13204).Refcount, 8);
LOC3 = Canbecycleroot_11616(C_13204);
if (!LOC3) goto LA4;
Rtladdcycleroot_12252(C_13204);
LA4: ;
}
static N_INLINE(TY10802*, Usrtocell_11612)(void* Usr_11614) {
TY10802* Result_11615;
Result_11615 = 0;
Result_11615 = ((TY10802*) ((NI64)((NU64)(((NI) (Usr_11614))) - (NU64)(((NI) (((NI)sizeof(TY10802))))))));
return Result_11615;
}
static N_INLINE(NI, Atomicdec_3226)(NI* Memloc_3229, NI X_3230) {
NI Result_8006;
Result_8006 = 0;
(*Memloc_3229) -= X_3230;
Result_8006 = (*Memloc_3229);
return Result_8006;
}
static N_INLINE(void, Rtladdzct_12601)(TY10802* C_12603) {
Addzct_11601(&Gch_11214.Zct, C_12603);
}
static N_INLINE(void, Decref_13001)(TY10802* C_13003) {
NI LOC2;
NIM_BOOL LOC5;
LOC2 = Atomicdec_3226(&(*C_13003).Refcount, 8);
if (!((NU64)(LOC2) < (NU64)(8))) goto LA3;
Rtladdzct_12601(C_13003);
goto LA1;
LA3: ;
LOC5 = Canbecycleroot_11616(C_13003);
if (!LOC5) goto LA6;
Rtladdcycleroot_12252(C_13003);
goto LA1;
LA6: ;
LA1: ;
}
static N_INLINE(void, asgnRef)(void** Dest_13214, void* Src_13215) {
TY10802* LOC4;
TY10802* LOC8;
if (!!((Src_13215 == NIM_NIL))) goto LA2;
LOC4 = Usrtocell_11612(Src_13215);
Incref_13202(LOC4);
LA2: ;
if (!!(((*Dest_13214) == NIM_NIL))) goto LA6;
LOC8 = Usrtocell_11612((*Dest_13214));
Decref_13001(LOC8);
LA6: ;
(*Dest_13214) = Src_13215;
}
N_NIMCALL(TY56552*, Searchinsttypes_126070)(TY56564 Tab_126072, TY56552* Key_126073) {
TY56552* Result_126074;
TNimObject* LOC1;
NIM_BOOL LOC3;
NI H_126113;
NI HEX3Atmp_126141;
NI Res_126143;
TY56552* T_126114;
NIM_BOOL Match_126128;
NI J_126137;
NI HEX3Atmp_126138;
NI LOC14;
NI Res_126140;
NIM_BOOL LOC17;
Result_126074 = 0;
T_126114 = 0;
Result_126074 = NIM_NIL;
LOC1 = 0;
LOC1 = Idtableget_61158(Tab_126072, &Key_126073->Sup);
Result_126074 = ((TY56552*) (LOC1));
LOC3 = (Result_126074 == NIM_NIL);
if (!(LOC3)) goto LA4;
LOC3 = (0 < Tab_126072.Counter);
LA4: ;
if (!LOC3) goto LA5;
H_126113 = 0;
HEX3Atmp_126141 = 0;
HEX3Atmp_126141 = (Tab_126072.Data->Sup.len-1);
Res_126143 = 0;
Res_126143 = 0;
while (1) {
if (!(Res_126143 <= HEX3Atmp_126141)) goto LA7;
H_126113 = Res_126143;
T_126114 = NIM_NIL;
T_126114 = ((TY56552*) (Tab_126072.Data->data[H_126113].Key));
if (!!((T_126114 == NIM_NIL))) goto LA9;
if (!((*Key_126073).Containerid == (*T_126114).Containerid)) goto LA12;
Match_126128 = 0;
Match_126128 = NIM_TRUE;
J_126137 = 0;
HEX3Atmp_126138 = 0;
LOC14 = Sonslen_56807(T_126114);
HEX3Atmp_126138 = (NI64)(LOC14 - 1);
Res_126140 = 0;
Res_126140 = 0;
while (1) {
if (!(Res_126140 <= HEX3Atmp_126138)) goto LA15;
J_126137 = Res_126140;
LOC17 = Sametype_98048((*T_126114).Sons->data[J_126137], (*Key_126073).Sons->data[J_126137]);
if (!!(LOC17)) goto LA18;
Match_126128 = NIM_FALSE;
goto LA15;
LA18: ;
Res_126140 += 1;
} LA15: ;
if (!Match_126128) goto LA21;
Result_126074 = ((TY56552*) (Tab_126072.Data->data[H_126113].Val));
goto BeforeRet;
LA21: ;
LA12: ;
LA9: ;
Res_126143 += 1;
} LA7: ;
LA5: ;
BeforeRet: ;
return Result_126074;
}
static N_INLINE(TY56552*, Lastson_56813)(TY56552* N_56815) {
TY56552* Result_58932;
NI LOC1;
Result_58932 = 0;
Result_58932 = NIM_NIL;
LOC1 = Sonslen_56807(N_56815);
Result_58932 = (*N_56815).Sons->data[(NI64)(LOC1 - 1)];
return Result_58932;
}
static N_INLINE(void, asgnRefNoCycle)(void** Dest_13218, void* Src_13219) {
TY10802* C_13220;
NI LOC4;
TY10802* C_13222;
NI LOC9;
if (!!((Src_13219 == NIM_NIL))) goto LA2;
C_13220 = 0;
C_13220 = Usrtocell_11612(Src_13219);
LOC4 = Atomicinc_3221(&(*C_13220).Refcount, 8);
LA2: ;
if (!!(((*Dest_13218) == NIM_NIL))) goto LA6;
C_13222 = 0;
C_13222 = Usrtocell_11612((*Dest_13218));
LOC9 = Atomicdec_3226(&(*C_13222).Refcount, 8);
if (!((NU64)(LOC9) < (NU64)(8))) goto LA10;
Rtladdzct_12601(C_13222);
LA10: ;
LA6: ;
(*Dest_13218) = Src_13219;
}
N_NIMCALL(TY56548*, Replacetypevarss_126155)(TY126145* Cl_126158, TY56548* S_126159) {
TY56548* Result_126265;
TNimObject* LOC4;
Result_126265 = 0;
Result_126265 = NIM_NIL;
if (!(S_126159 == NIM_NIL)) goto LA2;
Result_126265 = NIM_NIL;
goto BeforeRet;
LA2: ;
LOC4 = 0;
LOC4 = Idtableget_61158((*Cl_126158).Symmap, &S_126159->Sup);
Result_126265 = ((TY56548*) (LOC4));
if (!(Result_126265 == NIM_NIL)) goto LA6;
Result_126265 = Copysym_56776(S_126159, NIM_FALSE);
(*Result_126265).Flags |=(1<<((NI32)(((NU8) 4))%(sizeof(NI32)*8)));
Idtableput_61166(&(*Cl_126158).Symmap, &S_126159->Sup, &Result_126265->Sup.Sup);
asgnRef((void**) &(*Result_126265).Typ, Replacetypevarst_126150(Cl_126158, (*S_126159).Typ));
asgnRef((void**) &(*Result_126265).Owner, (*S_126159).Owner);
asgnRefNoCycle((void**) &(*Result_126265).Ast, Replacetypevarsn_126160(Cl_126158, (*S_126159).Ast));
LA6: ;
BeforeRet: ;
return Result_126265;
}
static N_INLINE(NI, Sonslen_56804)(TY56526* N_56806) {
NI Result_57897;
Result_57897 = 0;
if (!(*N_56806).KindU.S6.Sons == 0) goto LA2;
Result_57897 = 0;
goto LA1;
LA2: ;
Result_57897 = (*N_56806).KindU.S6.Sons->Sup.len;
LA1: ;
return Result_57897;
}
N_NIMCALL(TY56526*, Replacetypevarsn_126160)(TY126145* Cl_126163, TY56526* N_126164) {
TY56526* Result_126165;
NI Length_126219;
NI I_126232;
NI HEX3Atmp_126257;
NI Res_126259;
Result_126165 = 0;
Result_126165 = NIM_NIL;
if (!!((N_126164 == NIM_NIL))) goto LA2;
Result_126165 = Copynode_56849(N_126164);
asgnRef((void**) &(*Result_126165).Typ, Replacetypevarst_126150(Cl_126163, (*N_126164).Typ));
switch ((*N_126164).Kind) {
case ((NU8) 0) ... ((NU8) 2):
case ((NU8) 4) ... ((NU8) 18):
break;
case ((NU8) 3):
asgnRef((void**) &(*Result_126165).KindU.S4.Sym, Replacetypevarss_126155(Cl_126163, (*N_126164).KindU.S4.Sym));
break;
default:
Length_126219 = 0;
Length_126219 = Sonslen_56804(N_126164);
if (!(0 < Length_126219)) goto LA5;
Newsons_56816(Result_126165, Length_126219);
I_126232 = 0;
HEX3Atmp_126257 = 0;
HEX3Atmp_126257 = (NI64)(Length_126219 - 1);
Res_126259 = 0;
Res_126259 = 0;
while (1) {
if (!(Res_126259 <= HEX3Atmp_126257)) goto LA7;
I_126232 = Res_126259;
asgnRefNoCycle((void**) &(*Result_126165).KindU.S6.Sons->data[I_126232], Replacetypevarsn_126160(Cl_126163, (*N_126164).KindU.S6.Sons->data[I_126232]));
Res_126259 += 1;
} LA7: ;
LA5: ;
break;
}
LA2: ;
return Result_126165;
}
N_NIMCALL(void, Checkconstructedtype_126004)(TY48538 Info_126006, TY56552* T_126007) {
NIM_BOOL LOC2;
TY56552* LOC4;
NI64 LOC7;
NimStringDesc* LOC10;
NIM_BOOL LOC11;
LOC2 = (((*T_126007).Flags &(1<<((((NU8) 3))&7)))!=0);
if (!(LOC2)) goto LA3;
LOC4 = 0;
LOC4 = Skiptypes_98087(T_126007, 43008);
LOC2 = !(((*LOC4).Kind == ((NU8) 17)));
LA3: ;
if (!LOC2) goto LA5;
Localerror_49193(Info_126006, ((NU8) 158), ((NimStringDesc*) &TMP198040));
goto LA1;
LA5: ;
LOC7 = Computesize_98112(T_126007);
if (!(LOC7 < 0)) goto LA8;
LOC10 = 0;
LOC10 = Typetostring_98014(T_126007, ((NU8) 0));
Localerror_49193(Info_126006, ((NU8) 120), LOC10);
goto LA1;
LA8: ;
LOC11 = ((*T_126007).Kind == ((NU8) 23));
if (!(LOC11)) goto LA12;
LOC11 = ((*(*T_126007).Sons->data[0]).Kind == ((NU8) 23));
LA12: ;
if (!LOC11) goto LA13;
Localerror_49193(Info_126006, ((NU8) 191), ((NimStringDesc*) &TMP198043));
goto LA1;
LA13: ;
LA1: ;
}
N_NIMCALL(TY56552*, Replacetypevarst_126150)(TY126145* Cl_126153, TY56552* T_126154) {
TY56552* Result_126331;
TY56552* Body_126332;
TY56552* Newbody_126333;
TY56552* X_126334;
TY56552* Header_126335;
NI I_126364;
NI HEX3Atmp_126438;
NI LOC7;
NI Res_126440;
NI I_126416;
NI HEX3Atmp_126441;
NI LOC21;
NI Res_126443;
TY56552* LOC23;
TY56552* LOC24;
TY56552* LOC25;
NIM_BOOL LOC27;
NI I_126426;
NI HEX3Atmp_126444;
NI LOC30;
NI Res_126446;
NimStringDesc* LOC35;
Result_126331 = 0;
Body_126332 = 0;
Newbody_126333 = 0;
X_126334 = 0;
Header_126335 = 0;
Result_126331 = NIM_NIL;
Body_126332 = NIM_NIL;
Newbody_126333 = NIM_NIL;
X_126334 = NIM_NIL;
Header_126335 = NIM_NIL;
Result_126331 = T_126154;
if (!(T_126154 == NIM_NIL)) goto LA2;
goto BeforeRet;
LA2: ;
switch ((*T_126154).Kind) {
case ((NU8) 12):
Result_126331 = Lookuptypevar_126301(&(*Cl_126153), T_126154);
break;
case ((NU8) 9):
Body_126332 = (*T_126154).Sons->data[0];
if (!!(((*Body_126332).Kind == ((NU8) 10)))) goto LA5;
Internalerror_49208((*Cl_126153).Info, ((NimStringDesc*) &TMP198037));
LA5: ;
Header_126335 = NIM_NIL;
I_126364 = 0;
HEX3Atmp_126438 = 0;
LOC7 = Sonslen_56807(T_126154);
HEX3Atmp_126438 = (NI64)(LOC7 - 1);
Res_126440 = 0;
Res_126440 = 1;
while (1) {
if (!(Res_126440 <= HEX3Atmp_126438)) goto LA8;
I_126364 = Res_126440;
if (!((*(*T_126154).Sons->data[I_126364]).Kind == ((NU8) 12))) goto LA10;
X_126334 = Lookuptypevar_126301(&(*Cl_126153), (*T_126154).Sons->data[I_126364]);
if (!(Header_126335 == NIM_NIL)) goto LA13;
Header_126335 = Copytype_56771(T_126154, (*T_126154).Owner, NIM_FALSE);
LA13: ;
asgnRef((void**) &(*Header_126335).Sons->data[I_126364], X_126334);
goto LA9;
LA10: ;
X_126334 = (*T_126154).Sons->data[I_126364];
LA9: ;
Idtableput_61166(&(*Cl_126153).Typemap, &(*Body_126332).Sons->data[(NI64)(I_126364 - 1)]->Sup, &X_126334->Sup.Sup);
Res_126440 += 1;
} LA8: ;
if (!(Header_126335 == NIM_NIL)) goto LA16;
Header_126335 = T_126154;
LA16: ;
Result_126331 = Searchinsttypes_126070(Ginsttypes_108045, Header_126335);
if (!!((Result_126331 == NIM_NIL))) goto LA19;
goto BeforeRet;
LA19: ;
Result_126331 = Newtype_56707(((NU8) 11), (*(*T_126154).Sons->data[0]).Owner);
I_126416 = 0;
HEX3Atmp_126441 = 0;
LOC21 = Sonslen_56807(T_126154);
HEX3Atmp_126441 = (NI64)(LOC21 - 1);
Res_126443 = 0;
Res_126443 = 0;
while (1) {
if (!(Res_126443 <= HEX3Atmp_126441)) goto LA22;
I_126416 = Res_126443;
Addson_56828(Result_126331, (*Header_126335).Sons->data[I_126416]);
Res_126443 += 1;
} LA22: ;
Idtableput_61166(&Ginsttypes_108045, &Header_126335->Sup, &Result_126331->Sup.Sup);
LOC23 = 0;
LOC23 = Lastson_56813(Body_126332);
Newbody_126333 = Replacetypevarst_126150(Cl_126153, LOC23);
LOC24 = 0;
LOC24 = Lastson_56813(Body_126332);
asgnRefNoCycle((void**) &(*Newbody_126333).N, Replacetypevarsn_126160(Cl_126153, (*LOC24).N));
Addson_56828(Result_126331, Newbody_126333);
Checkconstructedtype_126004((*Cl_126153).Info, Newbody_126333);
break;
case ((NU8) 10):
Internalerror_49208((*Cl_126153).Info, ((NimStringDesc*) &TMP198044));
LOC25 = 0;
LOC25 = Lastson_56813(T_126154);
Result_126331 = Replacetypevarst_126150(Cl_126153, LOC25);
break;
default:
LOC27 = Containsgenerictype_126066(T_126154);
if (!LOC27) goto LA28;
Result_126331 = Copytype_56771(T_126154, (*T_126154).Owner, NIM_FALSE);
I_126426 = 0;
HEX3Atmp_126444 = 0;
LOC30 = Sonslen_56807(Result_126331);
HEX3Atmp_126444 = (NI64)(LOC30 - 1);
Res_126446 = 0;
Res_126446 = 0;
while (1) {
if (!(Res_126446 <= HEX3Atmp_126444)) goto LA31;
I_126426 = Res_126446;
asgnRef((void**) &(*Result_126331).Sons->data[I_126426], Replacetypevarst_126150(Cl_126153, (*Result_126331).Sons->data[I_126426]));
Res_126446 += 1;
} LA31: ;
asgnRefNoCycle((void**) &(*Result_126331).N, Replacetypevarsn_126160(Cl_126153, (*Result_126331).N));
if (!((5632 &(IL64(1)<<(((*Result_126331).Kind)&IL64(63))))!=0)) goto LA33;
LOC35 = 0;
LOC35 = Typetostring_98014(T_126154, ((NU8) 0));
Localerror_49193((*Cl_126153).Info, ((NU8) 121), LOC35);
LA33: ;
LA28: ;
break;
}
BeforeRet: ;
return Result_126331;
}
N_NIMCALL(TY56552*, Generatetypeinstance_126447)(TY108012* P_126449, TY56564 Pt_126450, TY56526* Arg_126451, TY56552* T_126452) {
TY56552* Result_126453;
TY126145 Cl_126454;
Result_126453 = 0;
memset((void*)&Cl_126454, 0, sizeof(Cl_126454));
Result_126453 = NIM_NIL;
genericReset((void*)&Cl_126454, NTI126145);
Initidtable_56755(&Cl_126454.Symmap);
Copyidtable_56799(&Cl_126454.Typemap, Pt_126450);
Cl_126454.Info = (*Arg_126451).Info;
Cl_126454.C = P_126449;
Pushinfocontext_48615((*Arg_126451).Info);
Result_126453 = Replacetypevarst_126150(&Cl_126454, T_126452);
Popinfocontext_48636();
return Result_126453;
}
N_NOINLINE(void, semtypinstInit)(void) {
}

